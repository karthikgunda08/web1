import{u as b,j as e,R as f,_ as N,r as p,a as k,L as j}from"./index-e439054e.js";import{u as y,i as C,r as L}from"./projectService-1550175d.js";import{D as M}from"./DakshinVaarahiLogo-2a42c54f.js";const c=({title:t,isActive:n,onClick:a,disabled:m,children:l,id:i,className:d})=>e.jsxs("div",{className:"relative group",id:i,children:[e.jsx("button",{onClick:a,disabled:m,"aria-label":t,className:`p-3 rounded-lg transition-all duration-200 ${n?"bg-sky-500 text-white":"bg-slate-700/50 text-slate-300 hover:bg-slate-600/50"} disabled:bg-slate-800 disabled:text-slate-500 disabled:cursor-not-allowed ${d}`,children:l}),e.jsx("div",{role:"tooltip",className:"absolute bottom-full mb-2 px-2 py-1 bg-slate-900 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50 whitespace-nowrap",children:t})]}),E=({onPhoenixClick:t,onLayersClick:n,onSaveClick:a,onProjectHubClick:m,onPropertiesClick:l,onShareClick:i,cinematicTourReady:d,onPlayTour:o,canUndo:g,canRedo:x,onUndo:h,onRedo:u,onChatClick:v})=>{const{isCompanionActive:w}=b(r=>({isCompanionActive:r.isCompanionActive})),s=()=>{b.setState(r=>({isCompanionActive:!r.isCompanionActive}))};return e.jsxs("div",{className:"aura-bottom-dock",children:[t&&e.jsx(c,{title:"Phoenix AI Engine",onClick:t,id:"tutorial-target-phoenix",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),n&&e.jsx(c,{title:"Layers",onClick:n,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M3 14h18M3 6h18"})})}),l&&e.jsx(c,{title:"Properties",onClick:l,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066 2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),v&&e.jsx(c,{title:"Chat / Command History",onClick:v,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),e.jsx(c,{title:"Integrations",onClick:()=>b.getState().togglePanelVisibility("integrationsPanel"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 002.25-2.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v2.25A2.25 2.25 0 006 10.5zm0 9.75h2.25A2.25 2.25 0 0010.5 18v-2.25a2.25 2.25 0 00-2.25-2.25H6a2.25 2.25 0 00-2.25 2.25V18A2.25 2.25 0 006 20.25z"})})}),e.jsx("div",{className:"mx-1 h-8 w-px bg-slate-700"}),e.jsx(c,{title:"Undo",onClick:h,disabled:!g,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 15l-3-3m0 0l3-3m-3 3h8M3 12a9 9 0 1118 0 9 9 0 01-18 0z"})})}),e.jsx(c,{title:"Redo",onClick:u,disabled:!x,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("div",{className:"mx-1 h-8 w-px bg-slate-700"}),e.jsx(c,{title:"AI Companion",onClick:s,isActive:w,className:"w-16 h-12 bg-purple-600/50 hover:bg-purple-500 text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),e.jsx("div",{className:"mx-1 h-8 w-px bg-slate-700"}),e.jsx(c,{title:"Play Cinematic Tour",onClick:o,disabled:!d,className:d?"text-amber-300 premium-glow":"",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),e.jsx(c,{title:"Save Version",id:"tutorial-target-save",onClick:a,className:"bg-sky-600/50 hover:bg-sky-500 text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})}),e.jsx(c,{title:"Share & Collaborate",onClick:i,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})})})]})},S=f.lazy(()=>N(()=>import("./PresenceAvatars-58e6fd96.js"),["assets/PresenceAvatars-58e6fd96.js","assets/index-e439054e.js","assets/index-6a1ae680.css"])),z=()=>{const t=b(m=>m.saveStatus);if(t==="idle")return null;const a={saving:{text:"Saving...",icon:e.jsx(j,{size:"h-4 w-4"})},saved:{text:"All changes saved",icon:"✓"},error:{text:"Save failed",icon:"✗"}}[t];return e.jsxs("div",{className:"text-xs text-slate-400 flex items-center gap-1",children:[a.icon,e.jsx("span",{children:a.text})]})},W=()=>{var w;const{currentProject:t,collaborators:n,currentUser:a,setView:m,updateCurrentProject:l,setExportModalOpen:i}=b(s=>({currentProject:s.currentProject,collaborators:s.collaborators,currentUser:s.currentUser,setView:s.setView,updateCurrentProject:s.updateCurrentProject,setExportModalOpen:s.setExportModalOpen})),[d,o]=p.useState(!1),[g,x]=p.useState((t==null?void 0:t.name)||""),{addNotification:h}=k();p.useEffect(()=>{x((t==null?void 0:t.name)||"")},[t==null?void 0:t.name]);const u=async()=>{if(o(!1),!(!t||g===t.name))try{const s=await y(t.id,g);l({...t,name:s.name}),h("Project name updated.","success")}catch(s){h(`Error updating name: ${s.message}`,"error"),x(t.name)}},v=typeof(t==null?void 0:t.userId)=="string"?t.userId:(w=t==null?void 0:t.userId)==null?void 0:w.id;return e.jsxs("header",{className:"absolute top-0 left-0 right-0 p-3 bg-background/30 backdrop-blur-sm z-50 flex justify-between items-center border-b border-border h-16 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m("userDashboard"),className:"p-2 rounded-lg bg-card/50 hover:bg-card transition-colors text-slate-300",title:"Back to Dashboard",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-auto h-8"}),e.jsxs("div",{children:[d?e.jsx("input",{type:"text",value:g,onChange:s=>x(s.target.value),onBlur:u,onKeyDown:s=>s.key==="Enter"&&u(),autoFocus:!0,className:"text-lg font-bold bg-input text-white rounded-md px-2 py-0.5 outline-none ring-2 ring-primary"}):e.jsx("h1",{className:"text-lg font-bold text-white truncate cursor-pointer",title:(t==null?void 0:t.name)||"Untitled Project",onDoubleClick:()=>o(!0),children:(t==null?void 0:t.name)||"Untitled Project"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-slate-400",children:["Version ",(t==null?void 0:t.version)||1]}),e.jsx(z,{})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>i(!0),className:"px-3 py-2 text-sm rounded-lg flex items-center gap-2 bg-card/50 hover:bg-card transition-colors text-slate-200",title:"Export Project",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export"]}),t&&v&&e.jsx(p.Suspense,{fallback:e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-700 animate-pulse"}),children:e.jsx(S,{collaborators:n,ownerId:v,currentUser:a})})]})]})},D=({onClose:t,onSave:n})=>{const[a,m]=p.useState(""),[l,i]=p.useState(!1),d=async o=>{if(o.preventDefault(),!a.trim()){alert("Please enter a short description of your changes.");return}i(!0),await n(a),i(!1),t()};return e.jsx("div",{className:"fixed inset-0 bg-slate-900/75 backdrop-blur-sm z-[200] flex items-center justify-center",onClick:t,children:e.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl shadow-2xl w-full max-w-md m-4 border border-slate-700",onClick:o=>o.stopPropagation(),children:[e.jsx("h2",{className:"text-lg font-bold text-sky-300 mb-4",children:"Save New Version"}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Describe the changes you made. This will help you identify this version later."}),e.jsxs("form",{onSubmit:d,children:[e.jsx("textarea",{value:a,onChange:o=>m(o.target.value),rows:3,className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white placeholder-slate-500",placeholder:"e.g., Finalized kitchen layout and window placements.",required:!0,autoFocus:!0,disabled:l}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:t,disabled:l,className:"px-4 py-2 text-sm rounded-md bg-slate-600 hover:bg-slate-500 text-white",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:l||!a.trim(),className:"px-4 py-2 text-sm rounded-md bg-emerald-600 hover:bg-emerald-500 text-white font-semibold disabled:opacity-50 flex items-center",children:[l&&e.jsx(j,{size:"h-4 w-4 mr-2"}),"Save Version"]})]})]})]})})},I=({isOpen:t,onClose:n,projectId:a,initialCollaborators:m,onCollaboratorsUpdate:l})=>{const[i,d]=p.useState(m),[o,g]=p.useState(""),[x,h]=p.useState(!1),{addNotification:u}=k(),v=async s=>{if(s.preventDefault(),!!o.trim()){h(!0);try{const r=await C(a,o);u(r.message,"success"),d(r.collaborators),l(r.collaborators),g("")}catch(r){u(r.message,"error")}finally{h(!1)}}},w=async s=>{if(window.confirm("Are you sure you want to remove this collaborator?")){h(!0);try{const r=await L(a,s);u(r.message,"success"),d(r.collaborators),l(r.collaborators)}catch(r){u(r.message,"error")}finally{h(!1)}}};return t?e.jsx("div",{className:"fixed inset-0 bg-slate-900/75 z-[150] flex items-center justify-center",onClick:n,children:e.jsxs("div",{className:"bg-slate-800 p-6 rounded-lg w-full max-w-md shadow-2xl border border-slate-700",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{className:"text-xl font-bold text-sky-300 mb-4",children:"Share Project"}),e.jsxs("form",{onSubmit:v,className:"flex gap-2 mb-6",children:[e.jsx("input",{type:"email",value:o,onChange:s=>g(s.target.value),placeholder:"Invite by email...",className:"flex-grow p-2 bg-slate-700 border border-slate-600 rounded-md text-white placeholder-slate-400",disabled:x}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded-md font-semibold text-white disabled:opacity-50",disabled:x||!o.trim(),children:x?e.jsx(j,{size:"h-5 w-5"}):"Invite"})]}),e.jsx("h3",{className:"text-md font-semibold text-slate-300 mb-2",children:"Project Members"}),e.jsxs("ul",{className:"space-y-2 max-h-60 overflow-y-auto",children:[i.map(({userId:s})=>e.jsxs("li",{className:"flex items-center justify-between p-2 bg-slate-700/50 rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:s.profileImageUrl||`https://api.dicebear.com/8.x/initials/svg?seed=${s.name||s.email}`,alt:"avatar",className:"w-8 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-100",children:s.name||"Invited User"}),e.jsx("p",{className:"text-xs text-slate-400",children:s.email})]})]}),e.jsx("button",{onClick:()=>w(s.id),className:"text-xs text-red-400 hover:text-red-300",disabled:x,children:"Remove"})]},s.id)),i.length===0&&e.jsx("p",{className:"text-sm text-center text-slate-400 py-4",children:"You are the only member."})]})]})}):null};export{W as A,E as B,I as C,D as S};
