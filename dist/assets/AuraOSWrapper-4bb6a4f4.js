import{g as Nd,r as V,j as o,m as Ei,R as qn,_ as Ns,L as dt,a as pr,u as $e,A as ga,c as fo,G as wu}from"./index-e439054e.js";import{V as Nu,F as Nf}from"./ViewPanelCard-780dac58.js";import{B as jf}from"./Basic3dViewPanel-6892a15b.js";import{c as Nr,Q as Af,R as Sf,Y as Cr,X as Ls,ay as jd,a9 as Ps,f as js,az as ju,L as fr,aA as Lf,aB as Pf,z as qo,aC as kf,aD as _f,aE as Cf,s as ba,S as kc,U as If,aF as zo,u as zn,V as Ef,W as _c,ak as Io,aG as vs,_ as Cc,aH as Of,aI as ki,w as sc,K as Uo,aJ as Ad,aK as Sd,E as Vo,a0 as Ic,a1 as Ec,aL as Tf,a2 as ms,al as Ld,T as Df,N as Bn,I as Wo,aa as Pd,ab as kd,ac as Rf,af as _d,ad as Ff,ai as Cd,aM as Mf,aN as Bf,aO as Au,an as qf,aP as zf,$ as Id,am as cs,a3 as Oc,g as ks,aQ as Uf,aR as Ed,aS as Vf,aT as Wf,a4 as Od,a7 as Su,aU as Lu,aV as Hf,a5 as oi,a6 as li,P as Td,a8 as Gf,ao as Pu,aW as Pi,aX as $f,aY as Kf,aZ as Yf,aj as ku,a_ as Jf,ar as Dd,aq as Tc,ap as Xf,au as bn,as as ac,av as Rd,aw as Fd,ax as Md,at as oc}from"./CreditCostDisplay-278e24ac.js";import{c as Qf,d as Zf,e as ep,f as tp,h as rp,i as np,j as ip,k as sp,s as ap,l as op,p as lp,m as cp,n as up,o as dp,q as hp,t as fp,u as pp,v as mp,w as gp,x as vp,y as xp,z as yp,A as bp,B as wp,C as Np,r as jp,D as Ap,E as Sp,F as Lp,G as Pp,H as kp,I as _p,J as Cp,K as Ip,L as Ep,M as Op,N as Tp,O as Dp}from"./geminiService-f982c15c.js";import{I as Bd}from"./Input-605e6434.js";import{P as _u,b as Rp,B as Fp}from"./constants-81f60586.js";import{c as Mp,e as Bp,d as qp,s as zp,f as Up}from"./projectService-1550175d.js";import{V as As}from"./OrbitControls-945b1259.js";import{c as Vp}from"./geometryUtils-5d5cd992.js";import{c as _s,B as wn}from"./Button-fcf173b3.js";import{S as qd,a as zd,L as Wp}from"./ErrorBarContext-f85feee6.js";import{L as Hp}from"./Label-4a29d029.js";import{A as Gp,B as $p,S as Kp,C as Yp}from"./CollaborationModal-7cfc9c99.js";import{ExportModal as Jp}from"./ExportModal-0b83a680.js";var Cs=r=>null;Cs.displayName="Cell";function Cu(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Iu(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Cu(Object(t),!0).forEach(function(n){Xp(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Cu(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Xp(r,e,t){return(e=Qp(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Qp(r){var e=Zp(r,"string");return typeof e=="symbol"?e:e+""}function Zp(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var e0=(r,e)=>e,Dc=Nr([Af,e0],(r,e)=>r.filter(t=>t.type==="pie").find(t=>t.id===e)),t0=[],Rc=(r,e,t)=>(t==null?void 0:t.length)===0?t0:t,Ud=Nr([Sf,Dc,Rc],(r,e,t)=>{var{chartData:n}=r;if(e!=null){var i;if((e==null?void 0:e.data)!=null&&e.data.length>0?i=e.data:i=n,(!i||!i.length)&&t!=null&&(i=t.map(s=>Iu(Iu({},e.presentationProps),s.props))),i!=null)return i}}),r0=Nr([Ud,Dc,Rc],(r,e,t)=>{if(!(r==null||e==null))return r.map((n,i)=>{var s,l=Cr(n,e.nameKey,e.name),u;return t!=null&&(s=t[i])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?u=t[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?u=n.fill:u=e.fill,{value:Ls(l,e.dataKey),color:u,payload:n,type:e.legendType}})}),n0=Nr([Ud,Dc,Rc,jd],(r,e,t,n)=>{if(!(e==null||r==null))return O0({offset:n,pieSettings:e,displayedData:r,cells:t})}),Vd={};(function(r){Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});function e(t){var i;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const s=t[Symbol.toStringTag];return s==null||!((i=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&i.writable)?!1:t.toString()===`[object ${s}]`}let n=t;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(t)===n}r.isPlainObject=e})(Vd);var i0=Vd.isPlainObject;const s0=Nd(i0);function Eo(){return Eo=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Eo.apply(null,arguments)}var Eu=(r,e,t,n,i)=>{var s=t-n,l;return l="M ".concat(r,",").concat(e),l+="L ".concat(r+t,",").concat(e),l+="L ".concat(r+t-s/2,",").concat(e+i),l+="L ".concat(r+t-s/2-n,",").concat(e+i),l+="L ".concat(r,",").concat(e," Z"),l},a0={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},o0=r=>{var e=Ps(r,a0),t=V.useRef(),[n,i]=V.useState(-1);V.useEffect(()=>{if(t.current&&t.current.getTotalLength)try{var I=t.current.getTotalLength();I&&i(I)}catch{}},[]);var{x:s,y:l,upperWidth:u,lowerWidth:d,height:m,className:g}=e,{animationEasing:v,animationDuration:y,animationBegin:p,isUpdateAnimationActive:N}=e;if(s!==+s||l!==+l||u!==+u||d!==+d||m!==+m||u===0&&d===0||m===0)return null;var b=_s("recharts-trapezoid",g);return N?V.createElement(ju,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:m,x:s,y:l},to:{upperWidth:u,lowerWidth:d,height:m,x:s,y:l},duration:y,animationEasing:v,isActive:N},I=>{var{upperWidth:w,lowerWidth:S,height:T,x:W,y:G}=I;return V.createElement(ju,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:p,duration:y,easing:v},V.createElement("path",Eo({},js(e,!0),{className:b,d:Eu(W,G,w,S,T),ref:t})))}):V.createElement("g",null,V.createElement("path",Eo({},js(e,!0),{className:b,d:Eu(s,l,u,d,m)})))},l0=["option","shapeType","propTransformer","activeClassName","isActive"];function c0(r,e){if(r==null)return{};var t,n,i=u0(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function u0(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}function Ou(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Oo(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ou(Object(t),!0).forEach(function(n){d0(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Ou(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function d0(r,e,t){return(e=h0(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function h0(r){var e=f0(r,"string");return typeof e=="symbol"?e:e+""}function f0(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function p0(r,e){return Oo(Oo({},e),r)}function m0(r,e){return r==="symbols"}function Tu(r){var{shapeType:e,elementProps:t}=r;switch(e){case"rectangle":return V.createElement(Pf,t);case"trapezoid":return V.createElement(o0,t);case"sector":return V.createElement(Lf,t);case"symbols":if(m0(e))return V.createElement(qd,t);break;default:return null}}function g0(r){return V.isValidElement(r)?r.props:r}function To(r){var{option:e,shapeType:t,propTransformer:n=p0,activeClassName:i="recharts-active-shape",isActive:s}=r,l=c0(r,l0),u;if(V.isValidElement(e))u=V.cloneElement(e,Oo(Oo({},l),g0(e)));else if(typeof e=="function")u=e(l);else if(s0(e)&&typeof e!="boolean"){var d=n(e,l);u=V.createElement(Tu,{shapeType:t,elementProps:d})}else{var m=l;u=V.createElement(Tu,{shapeType:t,elementProps:m})}return s?V.createElement(fr,{className:i},u):u}var Ho=(r,e)=>{var t=qo();return(n,i)=>s=>{r==null||r(n,i,s),t(kf({activeIndex:String(i),activeDataKey:e,activeCoordinate:n.tooltipPosition}))}},Go=r=>{var e=qo();return(t,n)=>i=>{r==null||r(t,n,i),e(_f())}},$o=(r,e)=>{var t=qo();return(n,i)=>s=>{r==null||r(n,i,s),t(Cf({activeIndex:String(i),activeDataKey:e,activeCoordinate:n.tooltipPosition}))}},v0=["onMouseEnter","onClick","onMouseLeave"],x0=["id"],y0=["id"];function Fc(r,e){if(r==null)return{};var t,n,i=b0(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function b0(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}function Du(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Tt(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Du(Object(t),!0).forEach(function(n){w0(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Du(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function w0(r,e,t){return(e=N0(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function N0(r){var e=j0(r,"string");return typeof e=="symbol"?e:e+""}function j0(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Un(){return Un=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Un.apply(null,arguments)}function A0(r){var e=V.useMemo(()=>zo(r.children,Cs),[r.children]),t=zn(n=>r0(n,r.id,e));return t==null?null:V.createElement(Ef,{legendPayload:t})}function S0(r){var{dataKey:e,nameKey:t,sectors:n,stroke:i,strokeWidth:s,fill:l,name:u,hide:d,tooltipType:m}=r;return{dataDefinedOnItem:n==null?void 0:n.map(g=>g.tooltipPayload),positions:n==null?void 0:n.map(g=>g.tooltipPosition),settings:{stroke:i,strokeWidth:s,fill:l,dataKey:e,nameKey:t,name:Ls(u,e),hide:d,type:m,color:l,unit:""}}}var L0=(r,e)=>r>e?"start":r<e?"end":"middle",P0=(r,e,t)=>typeof e=="function"?e(r):ki(e,t,t*.8),k0=(r,e,t)=>{var{top:n,left:i,width:s,height:l}=e,u=Of(s,l),d=i+ki(r.cx,s,s/2),m=n+ki(r.cy,l,l/2),g=ki(r.innerRadius,u,0),v=P0(t,r.outerRadius,u),y=r.maxRadius||Math.sqrt(s*s+l*l)/2;return{cx:d,cy:m,innerRadius:g,outerRadius:v,maxRadius:y}},_0=(r,e)=>{var t=vs(e-r),n=Math.min(Math.abs(e-r),360);return t*n},C0=(r,e)=>{if(V.isValidElement(r))return V.cloneElement(r,e);if(typeof r=="function")return r(e);var t=_s("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return V.createElement(Ld,Un({},e,{type:"linear",className:t}))},I0=(r,e,t)=>{if(V.isValidElement(r))return V.cloneElement(r,e);var n=t;if(typeof r=="function"&&(n=r(e),V.isValidElement(n)))return n;var i=_s("recharts-pie-label-text",typeof r!="boolean"&&typeof r!="function"?r.className:"");return V.createElement(Df,Un({},e,{alignmentBaseline:"middle",className:i}),n)};function E0(r){var{sectors:e,props:t,showLabels:n}=r,{label:i,labelLine:s,dataKey:l}=t;if(!n||!i||!e)return null;var u=ba(t),d=js(i,!1),m=js(s,!1),g=typeof i=="object"&&"offsetRadius"in i&&i.offsetRadius||20,v=e.map((y,p)=>{var N=(y.startAngle+y.endAngle)/2,b=sc(y.cx,y.cy,y.outerRadius+g,N),I=Tt(Tt(Tt(Tt({},u),y),{},{stroke:"none"},d),{},{index:p,textAnchor:L0(b.x,y.cx)},b),w=Tt(Tt(Tt(Tt({},u),y),{},{fill:"none",stroke:y.fill},m),{},{index:p,points:[sc(y.cx,y.cy,y.outerRadius,N),b],key:"line"});return V.createElement(fr,{key:"label-".concat(y.startAngle,"-").concat(y.endAngle,"-").concat(y.midAngle,"-").concat(p)},s&&C0(s,w),I0(i,I,Cr(y,l)))});return V.createElement(fr,{className:"recharts-pie-labels"},v)}function Wd(r){var{sectors:e,activeShape:t,inactiveShape:n,allOtherPieProps:i,showLabels:s}=r,l=zn(Uo),{onMouseEnter:u,onClick:d,onMouseLeave:m}=i,g=Fc(i,v0),v=Ho(u,i.dataKey),y=Go(m),p=$o(d,i.dataKey);return e==null?null:V.createElement(V.Fragment,null,e.map((N,b)=>{if((N==null?void 0:N.startAngle)===0&&(N==null?void 0:N.endAngle)===0&&e.length!==1)return null;var I=t&&String(b)===l,w=l?n:null,S=I?t:w,T=Tt(Tt({},N),{},{stroke:N.stroke,tabIndex:-1,[Ad]:b,[Sd]:i.dataKey});return V.createElement(fr,Un({tabIndex:-1,className:"recharts-pie-sector"},Vo(g,N,b),{onMouseEnter:v(N,b),onMouseLeave:y(N,b),onClick:p(N,b),key:"sector-".concat(N==null?void 0:N.startAngle,"-").concat(N==null?void 0:N.endAngle,"-").concat(N.midAngle,"-").concat(b)}),V.createElement(To,Un({option:S,isActive:I,shapeType:"sector"},T)))}),V.createElement(E0,{sectors:e,props:i,showLabels:s}))}function O0(r){var e,{pieSettings:t,displayedData:n,cells:i,offset:s}=r,{cornerRadius:l,startAngle:u,endAngle:d,dataKey:m,nameKey:g,tooltipType:v}=t,y=Math.abs(t.minAngle),p=_0(u,d),N=Math.abs(p),b=n.length<=1?0:(e=t.paddingAngle)!==null&&e!==void 0?e:0,I=n.filter(te=>Cr(te,m,0)!==0).length,w=(N>=360?I:I-1)*b,S=N-I*y-w,T=n.reduce((te,H)=>{var M=Cr(H,m,0);return te+(Io(M)?M:0)},0),W;if(T>0){var G;W=n.map((te,H)=>{var M=Cr(te,m,0),Q=Cr(te,g,H),ce=k0(t,s,te),E=(Io(M)?M:0)/T,_,B=Tt(Tt({},te),i&&i[H]&&i[H].props);H?_=G.endAngle+vs(p)*b*(M!==0?1:0):_=u;var q=_+vs(p)*((M!==0?y:0)+E*S),ae=(_+q)/2,K=(ce.innerRadius+ce.outerRadius)/2,fe=[{name:Q,value:M,payload:B,dataKey:m,type:v}],se=sc(ce.cx,ce.cy,K,ae);return G=Tt(Tt(Tt(Tt({},t.presentationProps),{},{percent:E,cornerRadius:l,name:Q,tooltipPayload:fe,midAngle:ae,middleRadius:K,tooltipPosition:se},B),ce),{},{value:Cr(te,m),startAngle:_,endAngle:q,payload:B,paddingAngle:vs(p)*b}),G})}return W}function T0(r){var{props:e,previousSectorsRef:t}=r,{sectors:n,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:u,activeShape:d,inactiveShape:m,onAnimationStart:g,onAnimationEnd:v}=e,y=Ic(e,"recharts-pie-"),p=t.current,[N,b]=V.useState(!0),I=V.useCallback(()=>{typeof v=="function"&&v(),b(!1)},[v]),w=V.useCallback(()=>{typeof g=="function"&&g(),b(!0)},[g]);return V.createElement(Ec,{begin:s,duration:l,isActive:i,easing:u,onAnimationStart:w,onAnimationEnd:I,key:y},S=>{var T=[],W=n&&n[0],G=W.startAngle;return n.forEach((te,H)=>{var M=p&&p[H],Q=H>0?Tf(te,"paddingAngle",0):0;if(M){var ce=ms(M.endAngle-M.startAngle,te.endAngle-te.startAngle),E=Tt(Tt({},te),{},{startAngle:G+Q,endAngle:G+ce(S)+Q});T.push(E),G=E.endAngle}else{var{endAngle:_,startAngle:B}=te,q=ms(0,_-B),ae=q(S),K=Tt(Tt({},te),{},{startAngle:G+Q,endAngle:G+ae+Q});T.push(K),G=K.endAngle}}),t.current=T,V.createElement(fr,null,V.createElement(Wd,{sectors:T,activeShape:d,inactiveShape:m,allOtherPieProps:e,showLabels:!N}))})}function D0(r){var{sectors:e,isAnimationActive:t,activeShape:n,inactiveShape:i}=r,s=V.useRef(null),l=s.current;return t&&e&&e.length&&(!l||l!==e)?V.createElement(T0,{props:r,previousSectorsRef:s}):V.createElement(Wd,{sectors:e,activeShape:n,inactiveShape:i,allOtherPieProps:r,showLabels:!0})}function R0(r){var{hide:e,className:t,rootTabIndex:n}=r,i=_s("recharts-pie",t);return e?null:V.createElement(fr,{tabIndex:n,className:i},V.createElement(D0,r))}var F0={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Cc.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function M0(r){var{id:e}=r,t=Fc(r,x0),n=V.useMemo(()=>zo(r.children,Cs),[r.children]),i=zn(s=>n0(s,e,n));return V.createElement(V.Fragment,null,V.createElement(_c,{fn:S0,args:Tt(Tt({},r),{},{sectors:i})}),V.createElement(R0,Un({},t,{sectors:i})))}function Hd(r){var e=Ps(r,F0),{id:t}=e,n=Fc(e,y0),i=ba(n);return V.createElement(kc,{id:t,type:"pie"},s=>V.createElement(V.Fragment,null,V.createElement(If,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i}),V.createElement(A0,Un({},n,{id:s})),V.createElement(M0,Un({},n,{id:s})),n.children))}Hd.displayName="Pie";var B0=!0,zl="Invariant failed";function q0(r,e){if(!r){if(B0)throw new Error(zl);var t=typeof e=="function"?e():e,n=t?"".concat(zl,": ").concat(t):zl;throw new Error(n)}}var z0=["x","y"];function lc(){return lc=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},lc.apply(null,arguments)}function Ru(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function la(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ru(Object(t),!0).forEach(function(n){U0(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Ru(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function U0(r,e,t){return(e=V0(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function V0(r){var e=W0(r,"string");return typeof e=="symbol"?e:e+""}function W0(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function H0(r,e){if(r==null)return{};var t,n,i=G0(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function G0(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}function $0(r,e){var{x:t,y:n}=r,i=H0(r,z0),s="".concat(t),l=parseInt(s,10),u="".concat(n),d=parseInt(u,10),m="".concat(e.height||i.height),g=parseInt(m,10),v="".concat(e.width||i.width),y=parseInt(v,10);return la(la(la(la(la({},e),i),l?{x:l}:{}),d?{y:d}:{}),{},{height:g,width:y,name:e.name,radius:e.radius})}function Gd(r){return V.createElement(To,lc({shapeType:"rectangle",propTransformer:$0,activeClassName:"recharts-active-bar"},r))}var K0=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(Io(e))return e;var s=Io(n)||Bn(n);return s?e(n,i):(s||q0(!1),t)}},Y0=["onMouseEnter","onMouseLeave","onClick"],J0=["value","background","tooltipPosition"],X0=["id"],Q0=["onMouseEnter","onClick","onMouseLeave"];function Ss(){return Ss=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Ss.apply(null,arguments)}function Fu(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function lr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Fu(Object(t),!0).forEach(function(n){Z0(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Fu(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Z0(r,e,t){return(e=em(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function em(r){var e=tm(r,"string");return typeof e=="symbol"?e:e+""}function tm(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Do(r,e){if(r==null)return{};var t,n,i=rm(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function rm(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}var nm=r=>{var{dataKey:e,name:t,fill:n,legendType:i,hide:s}=r;return[{inactive:s,dataKey:e,type:i,color:n,value:Ls(t,e),payload:r}]};function im(r){var{dataKey:e,stroke:t,strokeWidth:n,fill:i,name:s,hide:l,unit:u}=r;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:t,strokeWidth:n,fill:i,dataKey:e,nameKey:void 0,name:Ls(s,e),hide:l,type:r.tooltipType,color:r.fill,unit:u}}}function sm(r){var e=zn(Uo),{data:t,dataKey:n,background:i,allOtherBarProps:s}=r,{onMouseEnter:l,onMouseLeave:u,onClick:d}=s,m=Do(s,Y0),g=Ho(l,n),v=Go(u),y=$o(d,n);if(!i||t==null)return null;var p=js(i,!1);return V.createElement(V.Fragment,null,t.map((N,b)=>{var{value:I,background:w,tooltipPosition:S}=N,T=Do(N,J0);if(!w)return null;var W=g(N,b),G=v(N,b),te=y(N,b),H=lr(lr(lr(lr(lr({option:i,isActive:String(b)===e},T),{},{fill:"#eee"},w),p),Vo(m,N,b)),{},{onMouseEnter:W,onMouseLeave:G,onClick:te,dataKey:n,index:b,className:"recharts-bar-background-rectangle"});return V.createElement(Gd,Ss({key:"background-bar-".concat(b)},H))}))}function $d(r){var{data:e,props:t,showLabels:n}=r,i=ba(t),s=Do(i,X0),{shape:l,dataKey:u,activeBar:d}=t,m=zn(Uo),g=zn(zf),{onMouseEnter:v,onClick:y,onMouseLeave:p}=t,N=Do(t,Q0),b=Ho(v,u),I=Go(p),w=$o(y,u);return e?V.createElement(V.Fragment,null,e.map((S,T)=>{var W=d&&String(T)===m&&(g==null||u===g),G=W?d:l,te=lr(lr(lr({},s),S),{},{isActive:W,option:G,index:T,dataKey:u});return V.createElement(fr,Ss({className:"recharts-bar-rectangle"},Vo(N,S,T),{onMouseEnter:b(S,T),onMouseLeave:I(S,T),onClick:w(S,T),key:"rectangle-".concat(S==null?void 0:S.x,"-").concat(S==null?void 0:S.y,"-").concat(S==null?void 0:S.value,"-").concat(T)}),V.createElement(Gd,te))}),n&&Id.renderCallByParent(t,e)):null}function am(r){var{props:e,previousRectanglesRef:t}=r,{data:n,layout:i,isAnimationActive:s,animationBegin:l,animationDuration:u,animationEasing:d,onAnimationEnd:m,onAnimationStart:g}=e,v=t.current,y=Ic(e,"recharts-bar-"),[p,N]=V.useState(!1),b=V.useCallback(()=>{typeof m=="function"&&m(),N(!1)},[m]),I=V.useCallback(()=>{typeof g=="function"&&g(),N(!0)},[g]);return V.createElement(Ec,{begin:l,duration:u,isActive:s,easing:d,onAnimationEnd:b,onAnimationStart:I,key:y},w=>{var S=w===1?n:n==null?void 0:n.map((T,W)=>{var G=v&&v[W];if(G)return lr(lr({},T),{},{x:cs(G.x,T.x,w),y:cs(G.y,T.y,w),width:cs(G.width,T.width,w),height:cs(G.height,T.height,w)});if(i==="horizontal"){var te=cs(0,T.height,w);return lr(lr({},T),{},{y:T.y+T.height-te,height:te})}var H=cs(0,T.width,w);return lr(lr({},T),{},{width:H})});return w>0&&(t.current=S??null),S==null?null:V.createElement(fr,null,V.createElement($d,{props:e,data:S,showLabels:!p}))})}function om(r){var{data:e,isAnimationActive:t}=r,n=V.useRef(null);return t&&e&&e.length&&(n.current==null||n.current!==e)?V.createElement(am,{previousRectanglesRef:n,props:r}):V.createElement($d,{props:r,data:e,showLabels:!0})}var Kd=0,lm=(r,e)=>{var t=Array.isArray(r.value)?r.value[1]:r.value;return{x:r.x,y:r.y,value:t,errorVal:Cr(r,e)}};class cm extends V.PureComponent{render(){var{hide:e,data:t,dataKey:n,className:i,xAxisId:s,yAxisId:l,needClip:u,background:d,id:m}=this.props;if(e)return null;var g=_s("recharts-bar",i),v=m;return V.createElement(fr,{className:g,id:m},u&&V.createElement("defs",null,V.createElement(Cd,{clipPathId:v,xAxisId:s,yAxisId:l})),V.createElement(fr,{className:"recharts-bar-rectangles",clipPath:u?"url(#clipPath-".concat(v,")"):void 0},V.createElement(sm,{data:t,dataKey:n,background:d,allOtherBarProps:this.props}),V.createElement(om,this.props)),this.props.children)}}var um={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Cc.isSsr,legendType:"rect",minPointSize:Kd,xAxisId:0,yAxisId:0};function dm(r){var{xAxisId:e,yAxisId:t,hide:n,legendType:i,minPointSize:s,activeBar:l,animationBegin:u,animationDuration:d,animationEasing:m,isAnimationActive:g}=r,{needClip:v}=_d(e,t),y=Ff(),p=Wo(),N=zo(r.children,Cs),b=zn(S=>Mm(S,e,t,p,r.id,N));if(y!=="vertical"&&y!=="horizontal")return null;var I,w=b==null?void 0:b[0];return w==null||w.height==null||w.width==null?I=0:I=y==="vertical"?w.height/2:w.width/2,V.createElement(zd,{xAxisId:e,yAxisId:t,data:b,dataPointFormatter:lm,errorBarOffset:I},V.createElement(cm,Ss({},r,{layout:y,needClip:v,data:b,xAxisId:e,yAxisId:t,hide:n,legendType:i,minPointSize:s,activeBar:l,animationBegin:u,animationDuration:d,animationEasing:m,isAnimationActive:g})))}function hm(r){var{layout:e,barSettings:{dataKey:t,minPointSize:n},pos:i,bandSize:s,xAxis:l,yAxis:u,xAxisTicks:d,yAxisTicks:m,stackedData:g,displayedData:v,offset:y,cells:p}=r,N=e==="horizontal"?u:l,b=g?N.scale.domain():null,I=Mf({numericAxis:N});return v.map((w,S)=>{var T,W,G,te,H,M;g?T=Bf(g[S],b):(T=Cr(w,t),Array.isArray(T)||(T=[I,T]));var Q=K0(n,Kd)(T[1],S);if(e==="horizontal"){var ce,[E,_]=[u.scale(T[0]),u.scale(T[1])];W=Au({axis:l,ticks:d,bandSize:s,offset:i.offset,entry:w,index:S}),G=(ce=_??E)!==null&&ce!==void 0?ce:void 0,te=i.size;var B=E-_;if(H=qf(B)?0:B,M={x:W,y:y.top,width:te,height:y.height},Math.abs(Q)>0&&Math.abs(H)<Math.abs(Q)){var q=vs(H||Q)*(Math.abs(Q)-Math.abs(H));G-=q,H+=q}}else{var[ae,K]=[l.scale(T[0]),l.scale(T[1])];if(W=ae,G=Au({axis:u,ticks:m,bandSize:s,offset:i.offset,entry:w,index:S}),te=K-ae,H=i.size,M={x:y.left,y:G,width:y.width,height:H},Math.abs(Q)>0&&Math.abs(te)<Math.abs(Q)){var fe=vs(te||Q)*(Math.abs(Q)-Math.abs(te));te+=fe}}if(W==null||G==null||te==null||H==null)return null;var se=lr(lr({},w),{},{x:W,y:G,width:te,height:H,value:g?T:T[1],payload:w,background:M,tooltipPosition:{x:W+te/2,y:G+H/2}},p&&p[S]&&p[S].props);return se}).filter(Boolean)}function Yd(r){var e=Ps(r,um),t=Wo();return V.createElement(kc,{id:e.id,type:"bar"},n=>V.createElement(V.Fragment,null,V.createElement(Pd,{legendPayload:nm(e)}),V.createElement(_c,{fn:im,args:e}),V.createElement(kd,{type:"bar",id:n,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:Rf(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:t}),V.createElement(dm,Ss({},e,{id:n}))))}Yd.displayName="Bar";function Mu(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function po(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Mu(Object(t),!0).forEach(function(n){fm(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Mu(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function fm(r,e,t){return(e=pm(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function pm(r){var e=mm(r,"string");return typeof e=="symbol"?e:e+""}function mm(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var gm=(r,e)=>e,vm=(r,e,t)=>t,xm=(r,e,t,n)=>n,ym=(r,e,t,n,i)=>i,wa=Nr([Oc,ym],(r,e)=>r.filter(t=>t.type==="bar").find(t=>t.id===e)),bm=Nr([wa],r=>r==null?void 0:r.maxBarSize),wm=(r,e,t,n,i,s)=>s,Bu=(r,e,t)=>{var n=t??r;if(!Bn(n))return ki(n,e,0)},Nm=Nr([ks,Oc,gm,vm,xm],(r,e,t,n,i)=>e.filter(s=>r==="horizontal"?s.xAxisId===t:s.yAxisId===n).filter(s=>s.isPanorama===i).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),jm=(r,e,t,n)=>{var i=ks(r);return i==="horizontal"?Su(r,"yAxis",t,n):Su(r,"xAxis",e,n)},Am=(r,e,t)=>{var n=ks(r);return n==="horizontal"?Lu(r,"xAxis",e):Lu(r,"yAxis",t)},Sm=(r,e,t)=>{var n={},i=r.filter(Hf),s=r.filter(m=>m.stackId==null),l=i.reduce((m,g)=>(m[g.stackId]||(m[g.stackId]=[]),m[g.stackId].push(g),m),n),u=Object.entries(l).map(m=>{var[g,v]=m,y=v.map(N=>N.dataKey),p=Bu(e,t,v[0].barSize);return{stackId:g,dataKeys:y,barSize:p}}),d=s.map(m=>{var g=[m.dataKey].filter(y=>y!=null),v=Bu(e,t,m.barSize);return{stackId:void 0,dataKeys:g,barSize:v}});return[...u,...d]},Lm=Nr([Nm,Uf,Am],Sm),Pm=(r,e,t,n,i)=>{var s,l,u=wa(r,e,t,n,i);if(u!=null){var d=ks(r),m=Ed(r),{maxBarSize:g}=u,v=Bn(g)?m:g,y,p;return d==="horizontal"?(y=oi(r,"xAxis",e,n),p=li(r,"xAxis",e,n)):(y=oi(r,"yAxis",t,n),p=li(r,"yAxis",t,n)),(s=(l=Td(y,p,!0))!==null&&l!==void 0?l:v)!==null&&s!==void 0?s:0}},Jd=(r,e,t,n)=>{var i=ks(r),s,l;return i==="horizontal"?(s=oi(r,"xAxis",e,n),l=li(r,"xAxis",e,n)):(s=oi(r,"yAxis",t,n),l=li(r,"yAxis",t,n)),Td(s,l)};function km(r,e,t,n,i){var s=n.length;if(!(s<1)){var l=ki(r,t,0,!0),u,d=[];if(Pu(n[0].barSize)){var m=!1,g=t/s,v=n.reduce((w,S)=>w+(S.barSize||0),0);v+=(s-1)*l,v>=t&&(v-=(s-1)*l,l=0),v>=t&&g>0&&(m=!0,g*=.9,v=s*g);var y=(t-v)/2>>0,p={offset:y-l,size:0};u=n.reduce((w,S)=>{var T,W={stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:p.offset+p.size+l,size:m?g:(T=S.barSize)!==null&&T!==void 0?T:0}},G=[...w,W];return p=G[G.length-1].position,G},d)}else{var N=ki(e,t,0,!0);t-2*N-(s-1)*l<=0&&(l=0);var b=(t-2*N-(s-1)*l)/s;b>1&&(b>>=0);var I=Pu(i)?Math.min(b,i):b;u=n.reduce((w,S,T)=>[...w,{stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:N+(b+l)*T+(b-I)/2,size:I}}],d)}return u}}var _m=(r,e,t,n,i,s,l)=>{var u=Bn(l)?e:l,d=km(t,n,i!==s?i:s,r,u);return i!==s&&d!=null&&(d=d.map(m=>po(po({},m),{},{position:po(po({},m.position),{},{offset:m.position.offset-i/2})}))),d},Cm=Nr([Lm,Ed,Vf,Wf,Pm,Jd,bm],_m),Im=(r,e,t,n)=>oi(r,"xAxis",e,n),Em=(r,e,t,n)=>oi(r,"yAxis",t,n),Om=(r,e,t,n)=>li(r,"xAxis",e,n),Tm=(r,e,t,n)=>li(r,"yAxis",t,n),Dm=Nr([Cm,wa],(r,e)=>{if(!(r==null||e==null)){var t=r.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(t!=null)return t.position}}),Rm=(r,e)=>{var t=Gf(e);if(!(!r||t==null||e==null)){var{stackId:n}=e;if(n!=null){var i=r[n];if(i){var{stackedData:s}=i;if(s)return s.find(l=>l.key===t)}}}},Fm=Nr([jm,wa],Rm),Mm=Nr([jd,Im,Em,Om,Tm,Dm,ks,Od,Jd,Fm,wa,wm],(r,e,t,n,i,s,l,u,d,m,g,v)=>{var{chartData:y,dataStartIndex:p,dataEndIndex:N}=u;if(!(g==null||s==null||l!=="horizontal"&&l!=="vertical"||e==null||t==null||n==null||i==null||d==null)){var{data:b}=g,I;if(b!=null&&b.length>0?I=b:I=y==null?void 0:y.slice(p,N+1),I!=null)return hm({layout:l,barSettings:g,pos:s,bandSize:d,xAxis:e,yAxis:t,xAxisTicks:n,yAxisTicks:i,stackedData:m,displayedData:I,offset:r,cells:v})}});function Xd(r,e,t){return(e=Bm(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Bm(r){var e=qm(r,"string");return typeof e=="symbol"?e:e+""}function qm(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function zm(r){var e=qo();return V.useEffect(()=>(e($f(r)),()=>{e(Kf(r))}),[r,e]),null}class Mc extends V.Component{render(){return V.createElement(zm,{domain:this.props.domain,id:this.props.zAxisId,dataKey:this.props.dataKey,name:this.props.name,unit:this.props.unit,range:this.props.range,scale:this.props.scale,type:this.props.type,allowDuplicatedCategory:Pi.allowDuplicatedCategory,allowDataOverflow:Pi.allowDataOverflow,reversed:Pi.reversed,includeHidden:Pi.includeHidden})}}Xd(Mc,"displayName","ZAxis");Xd(Mc,"defaultProps",{zAxisId:0,range:Pi.range,scale:Pi.scale,type:Pi.type});var Um=["option","isActive"];function va(){return va=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},va.apply(null,arguments)}function Vm(r,e){if(r==null)return{};var t,n,i=Wm(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function Wm(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}function Hm(r){var{option:e,isActive:t}=r,n=Vm(r,Um);return typeof e=="string"?V.createElement(To,va({option:V.createElement(qd,va({type:e},n)),isActive:t,shapeType:"symbols"},n)):V.createElement(To,va({option:e,isActive:t,shapeType:"symbols"},n))}var Gm=(r,e,t,n,i,s,l)=>oi(r,"xAxis",e,l),$m=(r,e,t,n,i,s,l)=>li(r,"xAxis",e,l),Km=(r,e,t,n,i,s,l)=>oi(r,"yAxis",t,l),Ym=(r,e,t,n,i,s,l)=>li(r,"yAxis",t,l),Jm=(r,e,t,n)=>Yf(r,"zAxis",n,!1),Xm=(r,e,t,n,i)=>i,Qm=(r,e,t,n,i,s)=>s,Zm=(r,e,t,n,i,s,l)=>Od(r,e,t,l),e1=Nr([Oc,Xm],(r,e)=>r.filter(t=>t.type==="scatter").find(t=>t.id===e)),t1=Nr([Zm,Gm,$m,Km,Ym,Jm,e1,Qm],(r,e,t,n,i,s,l,u)=>{var{chartData:d,dataStartIndex:m,dataEndIndex:g}=r;if(l!=null){var v;if((l==null?void 0:l.data)!=null&&l.data.length>0?v=l.data:v=d==null?void 0:d.slice(m,g+1),!(v==null||e==null||n==null||t==null||i==null||(t==null?void 0:t.length)===0||(i==null?void 0:i.length)===0))return p1({displayedData:v,xAxis:e,yAxis:n,zAxis:s,scatterSettings:l,xAxisTicks:t,yAxisTicks:i,cells:u})}}),r1=["onMouseEnter","onClick","onMouseLeave"],n1=["id"],i1=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function cc(r,e){if(r==null)return{};var t,n,i=s1(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function s1(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}function Ii(){return Ii=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Ii.apply(null,arguments)}function qu(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function wr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qu(Object(t),!0).forEach(function(n){a1(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):qu(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function a1(r,e,t){return(e=o1(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function o1(r){var e=l1(r,"string");return typeof e=="symbol"?e:e+""}function l1(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var c1=r=>{var{dataKey:e,name:t,fill:n,legendType:i,hide:s}=r;return[{inactive:s,dataKey:e,type:i,color:n,value:Ls(t,e),payload:r}]};function u1(r){var{points:e,props:t}=r,{line:n,lineType:i,lineJointType:s}=t;if(!n)return null;var l=ba(t),u=js(n,!1),d,m;if(i==="joint")d=e.map(I=>({x:I.cx,y:I.cy}));else if(i==="fitting"){var{xmin:g,xmax:v,a:y,b:p}=Jf(e),N=I=>y*I+p;d=[{x:g,y:N(g)},{x:v,y:N(v)}]}var b=wr(wr(wr({},l),{},{fill:"none",stroke:l&&l.fill},u),{},{points:d});return V.isValidElement(n)?m=V.cloneElement(n,b):typeof n=="function"?m=n(b):m=V.createElement(Ld,Ii({},b,{type:s})),V.createElement(fr,{className:"recharts-scatter-line",key:"recharts-scatter-line"},m)}function Qd(r){var{points:e,showLabels:t,allOtherScatterProps:n}=r,{shape:i,activeShape:s,dataKey:l}=n,u=zn(Uo),{onMouseEnter:d,onClick:m,onMouseLeave:g}=n,v=cc(n,r1),y=Ho(d,n.dataKey),p=Go(g),N=$o(m,n.dataKey);if(e==null)return null;var b=cc(n,n1),I=ba(b);return V.createElement(V.Fragment,null,V.createElement(u1,{points:e,props:b}),e.map((w,S)=>{var T=s&&u===String(S),W=T?s:i,G=wr(wr(wr({key:"symbol-".concat(S)},I),w),{},{[Ad]:S,[Sd]:String(l)});return V.createElement(fr,Ii({className:"recharts-scatter-symbol"},Vo(v,w,S),{onMouseEnter:y(w,S),onMouseLeave:p(w,S),onClick:N(w,S),key:"symbol-".concat(w==null?void 0:w.cx,"-").concat(w==null?void 0:w.cy,"-").concat(w==null?void 0:w.size,"-").concat(S)}),V.createElement(Hm,Ii({option:W,isActive:T},G)))}),t&&Id.renderCallByParent(b,e))}function d1(r){var{previousPointsRef:e,props:t}=r,{points:n,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:u}=t,d=e.current,m=Ic(t,"recharts-scatter-"),[g,v]=V.useState(!1),y=V.useCallback(()=>{v(!1)},[]),p=V.useCallback(()=>{v(!0)},[]);return V.createElement(Ec,{begin:s,duration:l,isActive:i,easing:u,onAnimationEnd:y,onAnimationStart:p,key:m},N=>{var b=N===1?n:n.map((I,w)=>{var S=d&&d[w];if(S){var T=ms(S.cx,I.cx),W=ms(S.cy,I.cy),G=ms(S.size,I.size);return wr(wr({},I),{},{cx:T(N),cy:W(N),size:G(N)})}var te=ms(0,I.size);return wr(wr({},I),{},{size:te(N)})});return N>0&&(e.current=b),V.createElement(fr,null,V.createElement(Qd,{points:b,allOtherScatterProps:t,showLabels:!g}))})}function h1(r){var{points:e,isAnimationActive:t}=r,n=V.useRef(null),i=n.current;return t&&e&&e.length&&(!i||i!==e)?V.createElement(d1,{props:r,previousPointsRef:n}):V.createElement(Qd,{points:e,allOtherScatterProps:r,showLabels:!0})}function f1(r){var{dataKey:e,points:t,stroke:n,strokeWidth:i,fill:s,name:l,hide:u,tooltipType:d}=r;return{dataDefinedOnItem:t==null?void 0:t.map(m=>m.tooltipPayload),positions:t==null?void 0:t.map(m=>m.tooltipPosition),settings:{stroke:n,strokeWidth:i,fill:s,nameKey:void 0,dataKey:e,name:Ls(l,e),hide:u,type:d,color:s,unit:""}}}function p1(r){var{displayedData:e,xAxis:t,yAxis:n,zAxis:i,scatterSettings:s,xAxisTicks:l,yAxisTicks:u,cells:d}=r,m=Bn(t.dataKey)?s.dataKey:t.dataKey,g=Bn(n.dataKey)?s.dataKey:n.dataKey,v=i&&i.dataKey,y=i?i.range:Mc.defaultProps.range,p=y&&y[0],N=t.scale.bandwidth?t.scale.bandwidth():0,b=n.scale.bandwidth?n.scale.bandwidth():0;return e.map((I,w)=>{var S=Cr(I,m),T=Cr(I,g),W=!Bn(v)&&Cr(I,v)||"-",G=[{name:Bn(t.dataKey)?s.name:t.name||t.dataKey,unit:t.unit||"",value:S,payload:I,dataKey:m,type:s.tooltipType},{name:Bn(n.dataKey)?s.name:n.name||n.dataKey,unit:n.unit||"",value:T,payload:I,dataKey:g,type:s.tooltipType}];W!=="-"&&G.push({name:i.name||i.dataKey,unit:i.unit||"",value:W,payload:I,dataKey:v,type:s.tooltipType});var te=ku({axis:t,ticks:l,bandSize:N,entry:I,index:w,dataKey:m}),H=ku({axis:n,ticks:u,bandSize:b,entry:I,index:w,dataKey:g}),M=W!=="-"?i.scale(W):p,Q=Math.sqrt(Math.max(M,0)/Math.PI);return wr(wr({},I),{},{cx:te,cy:H,x:te-Q,y:H-Q,width:2*Q,height:2*Q,size:M,node:{x:S,y:T,z:W},tooltipPayload:G,tooltipPosition:{x:te,y:H},payload:I},d&&d[w]&&d[w].props)})}var m1=(r,e,t)=>({x:r.cx,y:r.cy,value:t==="x"?+r.node.x:+r.node.y,errorVal:Cr(r,e)});function g1(r){var{hide:e,points:t,className:n,needClip:i,xAxisId:s,yAxisId:l,id:u,children:d}=r;if(e)return null;var m=_s("recharts-scatter",n),g=u;return V.createElement(fr,{className:m,clipPath:i?"url(#clipPath-".concat(g,")"):null,id:u},i&&V.createElement("defs",null,V.createElement(Cd,{clipPathId:g,xAxisId:s,yAxisId:l})),V.createElement(zd,{xAxisId:s,yAxisId:l,data:t,dataPointFormatter:m1,errorBarOffset:0},d),V.createElement(fr,{key:"recharts-scatter-symbols"},V.createElement(h1,r)))}var Zd={xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!Cc.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"};function v1(r){var e=Ps(r,Zd),{animationBegin:t,animationDuration:n,animationEasing:i,hide:s,isAnimationActive:l,legendType:u,lineJointType:d,lineType:m,shape:g,xAxisId:v,yAxisId:y,zAxisId:p}=e,N=cc(e,i1),{needClip:b}=_d(v,y),I=V.useMemo(()=>zo(r.children,Cs),[r.children]),w=Wo(),S=zn(T=>t1(T,v,y,p,r.id,I,w));return b==null?null:V.createElement(V.Fragment,null,V.createElement(_c,{fn:f1,args:wr(wr({},r),{},{points:S})}),V.createElement(g1,Ii({},N,{xAxisId:v,yAxisId:y,zAxisId:p,lineType:m,lineJointType:d,legendType:u,shape:g,hide:s,isAnimationActive:l,animationBegin:t,animationDuration:n,animationEasing:i,points:S,needClip:b})))}function eh(r){var e=Ps(r,Zd),t=Wo();return V.createElement(kc,{id:e.id,type:"scatter"},n=>V.createElement(V.Fragment,null,V.createElement(Pd,{legendPayload:c1(e)}),V.createElement(kd,{type:"scatter",id:n,data:e.data,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:e.zAxisId,dataKey:e.dataKey,hide:e.hide,name:e.name,tooltipType:e.tooltipType,isPanorama:t}),V.createElement(v1,Ii({},e,{id:n}))))}eh.displayName="Scatter";var x1=["axis","item"],y1=V.forwardRef((r,e)=>V.createElement(Dd,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:x1,tooltipPayloadSearcher:Tc,categoricalChartProps:r,ref:e})),b1=["item"],w1={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},N1=V.forwardRef((r,e)=>{var t=Ps(r,w1);return V.createElement(Xf,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:b1,tooltipPayloadSearcher:Tc,categoricalChartProps:t,ref:e})}),j1=["item"],A1=V.forwardRef((r,e)=>V.createElement(Dd,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:j1,tooltipPayloadSearcher:Tc,categoricalChartProps:r,ref:e}));const S1=[{id:"select",title:"Select & Modify",icon:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2.5m6-6a1.5 1.5 0 00-3 0v6a1.5 1.5 0 003 0m-3-6a1.5 1.5 0 013 0v2.5m0 0a1.5 1.5 0 013 0m-3-6a1.5 1.5 0 013 0v6a1.5 1.5 0 01-3 0m6-2.5v-2.5a1.5 1.5 0 013 0v2.5"})})},{id:"wall",title:"Draw Wall",icon:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},{id:"door",title:"Add Door",icon:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M4 7v10a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2zm12-1V5a2 2 0 00-2-2H8a2 2 0 00-2 2v1m5 5a1 1 0 11-2 0 1 1 0 012 0z"})})},{id:"window",title:"Add Window",icon:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M4 6h16M4 12h16M4 18h16M6 4v16M18 4v16"})})},{id:"dimension",title:"Add Dimension",icon:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v4m0 0h-4m4 0l-5-5"})})},{id:"comment",title:"Add Comment",icon:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})},{id:"zone",title:"Draw Zone",icon:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"})})},{id:"road",title:"Draw Road/Infra",icon:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}],L1=({activeTool:r,onToolChange:e,editorMode:t,onModeChange:n})=>o.jsxs("div",{className:"absolute top-20 left-4 z-30 flex flex-col gap-2 p-2 bg-slate-800/80 backdrop-blur-md rounded-lg border border-slate-700",children:[S1.map(i=>o.jsx("button",{onClick:()=>e(i.id),title:i.title,className:`p-3 rounded-md transition-colors ${r===i.id?"bg-sky-500 text-white":"text-slate-300 hover:bg-slate-700"}`,children:i.icon},i.id)),o.jsx("div",{className:"my-1 h-px bg-slate-700"}),o.jsxs("button",{onClick:()=>n(t==="concept"?"precision":"concept"),title:`Switch to ${t==="concept"?"Precision":"Concept"} Mode`,className:"p-2 text-xs text-center text-slate-300 hover:bg-slate-700 rounded-md",children:[o.jsx("div",{className:"font-bold capitalize",children:t}),o.jsx("div",{className:"text-slate-400",children:"Mode"})]})]}),P1=Ei.div,Fn=({title:r,panelState:e,setPanelState:t,onFocus:n,children:i})=>{const s=V.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:s,className:"fixed inset-0 pointer-events-none"}),o.jsxs(P1,{drag:!0,dragConstraints:s,dragMomentum:!1,dragElastic:.05,onDragStart:n,className:"aura-floating-panel",style:{x:e.x,y:e.y,width:e.width,height:e.height,zIndex:e.zIndex},onDrag:(l,u)=>{t(d=>({...d,x:d.x+u.delta.x,y:d.y+u.delta.y}))},children:[o.jsx("div",{className:"aura-floating-panel-header",children:o.jsx("h3",{className:"font-semibold text-sm text-slate-200",children:r})}),o.jsx("div",{className:"aura-floating-panel-content",children:i})]})]})},k1=qn.lazy(()=>Ns(()=>import("./DesignDialogueModal-e1ebdf78.js"),["assets/DesignDialogueModal-e1ebdf78.js","assets/index-e439054e.js","assets/index-6a1ae680.css","assets/geminiService-f982c15c.js","assets/constants-81f60586.js","assets/authService-2d4415af.js"])),_1=r=>{const[e,t]=V.useState(!1),{setLevels:n,pushToUndoStack:i,addNotification:s,currentProject:l,setBillOfQuantities:u,setSustainabilityReport:d,setAdvancedStructuralReport:m,setVastuGridAnalysis:g,setLastAiToolRun:v}=r,y=p=>{i();const{projectData:N,structuralReport:b,vastuReport:I,boq:w}=p;n(N.levels||[]),w&&u(w),N.sustainabilityReport&&d(N.sustainabilityReport),b&&m(b),I&&g(I),s(`Applied '${p.summary.substring(0,20)}...' concept to the editor!`,"success"),v("MasterArchitect")};return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Master Architect AI"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Engage in a design dialogue with the AI to generate a complete project concept — including floor plans, structural analysis, BoQ, and Vastu reports — from a simple idea."}),o.jsxs("div",{className:"p-3 my-4 bg-gradient-to-r from-amber-500/20 to-orange-500/20 border-l-4 border-amber-400 text-amber-200 text-sm rounded-r-lg",children:[o.jsx("p",{className:"font-bold text-amber-100",children:"💡 Enhance AI Precision"}),o.jsxs("p",{className:"mt-1",children:["For superior results, add project details like location and client profile in the"," ",o.jsx("strong",{className:"text-white",children:"Properties panel"})," (when no object is selected). The AI will use this context."]})]}),o.jsxs("button",{onClick:()=>t(!0),className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md flex items-center justify-center transition-all bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700",children:[o.jsx("span",{className:"mr-2 text-lg",children:"✨"}),o.jsx("span",{className:"flex-grow",children:"Start Design Dialogue"}),o.jsx(bn,{cost:100})]}),e&&o.jsx(V.Suspense,{fallback:o.jsx(dt,{}),children:o.jsx(k1,{...r,onClose:()=>t(!1),onApplyConcept:y})})]})},C1=({isLoading:r,error:e,result:t,renderResult:n,placeholder:i})=>r?o.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-center",children:[o.jsx(dt,{}),o.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"AI is thinking..."})]}):e?o.jsx("p",{className:"p-4 text-sm text-red-400 bg-red-900/50 rounded-md",children:e}):t?o.jsx("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg animate-fade-in-up",children:n(t)}):i?o.jsx(o.Fragment,{children:i}):null;function Pt(r){const{toolName:e,description:t,creditCost:n,icon:i,apiFn:s,buildPayload:l,onSuccess:u,buttonText:d,renderResult:m,resultPlaceholder:g,children:v,setLastAiToolRun:y}=r,[p,N]=V.useState(!1),[b,I]=V.useState(null),[w,S]=V.useState(null),{addNotification:T}=pr(),{currentUser:W,setBuyCreditsModalOpen:G,refreshCurrentUser:te,currentProject:H}=r,M=V.useCallback(async()=>{if(!W||!H){T("Please log in and select a project.","error");return}if(W.role!=="owner"&&W.credits<n){T(`You need ${n} credits for ${e}. You have ${W.credits}.`,"info"),G(!0);return}const Q=l(r);if(Q!==null){N(!0),I(null),S(null);try{const ce=await s(H.id,...Q);S(ce),u(ce,r),y(e),T(`${e} executed successfully!`,"success"),n>0&&W.role!=="owner"&&await te()}catch(ce){const E=ce.message||`An error occurred while running ${e}.`;I(E),T(E,"error")}finally{N(!1)}}},[s,l,n,W,G,u,r,te,e,T,H,y]);return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:e}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:t}),v,o.jsxs("button",{id:"generic-tool-button",onClick:M,disabled:p,className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-sky-500 to-indigo-600 hover:from-sky-600 hover:to-indigo-700",children:[p?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:i}),o.jsx("span",{className:"flex-grow",children:p?"Processing...":d||`Run ${e}`}),o.jsx(bn,{cost:n})]}),o.jsx(C1,{isLoading:p,error:b,result:w,renderResult:m||(()=>o.jsx("p",{children:"Success!"})),placeholder:g})]})}const I1=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg",children:[o.jsx("div",{className:"prose prose-sm prose-invert max-w-none text-slate-200 whitespace-pre-wrap",children:r.text}),r.sources&&r.sources.length>0&&o.jsxs("div",{className:"mt-4 border-t border-slate-600 pt-2",children:[o.jsx("h5",{className:"text-xs font-semibold text-slate-400 mb-1",children:"Sources:"}),o.jsx("ul",{className:"text-xs list-disc list-inside text-sky-400 space-y-1",children:r.sources.map((e,t)=>o.jsx("li",{children:o.jsx("a",{href:e.web.uri,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:e.web.title||e.web.uri})},t))})]})]}),E1=r=>{const[e,t]=V.useState("");return o.jsx(Pt,{...r,toolName:"AI Research Assistant",description:"Ask your AI Research Assistant anything related to architecture, engineering, materials, or building codes.",creditCost:1,icon:"🌐",apiFn:Qf,buildPayload:n=>e.trim()?[e]:(n.addNotification("Please enter a research query.","error"),null),onSuccess:n=>{},buttonText:"Ask",renderResult:I1,children:o.jsx("div",{className:"flex gap-2 mb-4",children:o.jsx("input",{type:"text",value:e,onChange:n=>t(n.target.value),onKeyDown:n=>{var i;return n.key==="Enter"&&((i=document.getElementById("generic-tool-button"))==null?void 0:i.click())},className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-slate-100",placeholder:"e.g., Benefits of CLT, or 'CLT के क्या फायदे हैं?'"})})})},O1=({report:r,projectId:e})=>{var l,u;const{addNotification:t}=pr(),[n,i]=qn.useState(!1),s=async()=>{i(!0);try{t("BOQ exported successfully!","success")}catch{t("Failed to export BOQ","error")}finally{i(!1)}};return o.jsxs("div",{className:"p-4 bg-white rounded-lg shadow",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Bill of Quantities"}),o.jsx("button",{onClick:s,disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:n?o.jsx(dt,{size:"sm"}):"Export BOQ"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Items"}),o.jsx("p",{className:"text-lg font-semibold",children:((l=r.items)==null?void 0:l.length)||0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Value"}),o.jsxs("p",{className:"text-lg font-semibold",children:["₹",((u=r.total)==null?void 0:u.toLocaleString())||0]})]})]}),r.items&&r.items.length>0?o.jsx("div",{className:"border rounded-lg overflow-hidden",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rate"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.items.map((d,m)=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.description}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.quantity}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.unit}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["₹",d.rate]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["₹",d.amount]})]},m))})]})}):o.jsx("div",{className:"text-center py-8 text-gray-500",children:o.jsx("p",{children:"No BOQ items available"})})]})]})},T1=async(r,e)=>(await new Promise(t=>setTimeout(t,1e3)),{items:[{description:"Concrete",quantity:100,unit:"m³",rate:5e3,amount:5e5},{description:"Steel",quantity:50,unit:"tonnes",rate:8e4,amount:4e6},{description:"Bricks",quantity:1e4,unit:"pieces",rate:15,amount:15e4}],total:465e4}),D1=r=>{const e=$e();return o.jsx(Pt,{...r,toolName:"BOQ Generator",description:"Generate comprehensive Bill of Quantities for your project",creditCost:15,icon:"🧾",apiFn:T1,buildPayload:t=>{var i;return t.currentProject?[e.createProjectData({projectType:((i=t.currentProject)==null?void 0:i.projectType)||"building",levels:t.levels,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh,zones:[],infrastructure:[]})]:null},onSuccess:(t,n)=>{n.setBillOfQuantities(t),n.addNotification("BOQ generated successfully!","success")},buttonText:"Generate Bill of Quantities",renderResult:t=>{var n;return o.jsx(O1,{report:t,projectId:((n=r.currentProject)==null?void 0:n.id)||""})}})},R1=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-3",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-slate-300",children:"Overall Score"}),o.jsxs("p",{className:"text-4xl font-bold text-emerald-300",children:[r.score,"/100"]})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-1",children:"Breakdown:"}),r.scoreBreakdown.map((e,t)=>o.jsxs("p",{className:"text-sm",children:[o.jsxs("strong",{children:[e.metric,":"]})," ",e.assessment]},t))]}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-1",children:"Recommendations:"}),o.jsx("ul",{className:"list-disc list-inside text-sm",children:r.recommendations.map((e,t)=>o.jsxs("li",{children:[o.jsxs("strong",{children:[e.title,":"]})," ",e.description]},t))})]})]}),F1=r=>{const e=$e();return o.jsx(Pt,{...r,toolName:"Sustainability Analysis",description:"Analyze your project's environmental impact, including orientation, daylighting, and material choices.",creditCost:10,icon:"🌿",apiFn:Zf,buildPayload:t=>{var i;return[e.createProjectData({projectType:((i=t.currentProject)==null?void 0:i.projectType)||"building",levels:t.levels,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(t,n)=>n.setSustainabilityReport(t),buttonText:"Run Sustainability Analysis",renderResult:R1})},zu=r=>{switch(r){case"Pass":return"text-emerald-400";case"Fail":return"text-red-400";case"Warning":return"text-amber-400";default:return"text-slate-400"}},M1=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-3",children:[o.jsxs("h4",{className:`text-lg font-bold ${zu(r.overallResult)}`,children:["Result: ",r.overallResult]}),o.jsx("p",{className:"text-sm",children:r.summary}),o.jsx("div",{className:"space-y-1",children:r.items.map((e,t)=>o.jsxs("div",{className:"text-xs",children:[o.jsxs("span",{className:`font-semibold ${zu(e.status)}`,children:["[",e.status,"]"]})," ",e.check,": ",e.details]},t))})]}),B1=r=>{var m;const{levels:e,activeLevelIndex:t}=r,[n,i]=V.useState(""),[s,l]=V.useState("IRC 2021"),u=((m=e[t])==null?void 0:m.rooms)||[],d=$e();return o.jsxs("div",{children:[o.jsxs("div",{className:"space-y-3 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"room-select",className:"block text-sm font-medium text-slate-300 mb-1",children:"Select Room"}),o.jsxs("select",{id:"room-select",value:n,onChange:g=>i(g.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white",children:[o.jsx("option",{value:"",children:"-- Select a room --"}),u.map(g=>o.jsx("option",{value:g.id,children:g.name},g.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"standard-input",className:"block text-sm font-medium text-slate-300 mb-1",children:"Compliance Standard"}),o.jsx("input",{type:"text",id:"standard-input",value:s,onChange:g=>l(g.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white"})]})]}),o.jsx(Pt,{...r,toolName:"Code Compliance",description:"Check a room against common building codes and standards.",creditCost:10,icon:"✅",apiFn:ep,buildPayload:g=>{var y;if(!n||!s.trim())return g.addNotification("Please select a room and specify a standard.","error"),null;const v=d.createProjectData({projectType:((y=g.currentProject)==null?void 0:y.projectType)||"building",levels:g.levels,planNorthDirection:g.planNorthDirection,propertyLines:g.propertyLines,terrainMesh:g.terrainMesh,zones:[],infrastructure:[]});return[n,s,v]},onSuccess:(g,v)=>{const y=g;v.addNotification(`Compliance check for room complete: ${y.overallResult}`,"info")},buttonText:"Run Compliance Check",renderResult:M1})]})},q1=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-3",children:[o.jsx("h4",{className:"text-lg font-bold text-amber-300",children:r.materialName}),o.jsx("p",{className:"text-sm",children:r.description}),o.jsxs("p",{className:"text-sm",children:[o.jsx("strong",{children:"Sustainability Score:"})," ",r.sustainabilityScore,"/10"]}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-emerald-300",children:"Pros:"}),o.jsx("ul",{className:"list-disc list-inside text-sm",children:r.pros.map((e,t)=>o.jsx("li",{children:e},t))})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-red-300",children:"Cons:"}),o.jsx("ul",{className:"list-disc list-inside text-sm",children:r.cons.map((e,t)=>o.jsx("li",{children:e},t))})]})]}),z1=r=>{const[e,t]=V.useState("");return o.jsx(Pt,{...r,toolName:"Material Analysis",description:"Get a detailed report on any construction material, including its properties, pros, cons, and sustainability score.",creditCost:1,icon:"🧱",apiFn:tp,buildPayload:n=>e.trim()?[e]:(n.addNotification("Please enter a material name.","error"),null),onSuccess:n=>{},buttonText:"Analyze Material",renderResult:q1,children:o.jsx("div",{className:"flex gap-2 mb-4",children:o.jsx("input",{type:"text",value:e,onChange:n=>t(n.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-slate-100",placeholder:"e.g., Cross-Laminated Timber"})})})},U1=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-slate-200",children:"Structural Summary"}),o.jsx("p",{className:"text-sm text-slate-300 italic",children:r.summary})]}),o.jsxs("div",{children:[o.jsxs("h5",{className:"font-semibold text-slate-200 mb-1",children:["Load Bearing Walls (",r.loadBearingWalls.length,"):"]}),o.jsx("p",{className:"text-xs text-slate-400 break-all",children:r.loadBearingWalls.join(", ")})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-1",children:"Preliminary Load Calculations:"}),o.jsx("ul",{className:"space-y-1 text-sm",children:r.preliminaryLoadCalculations.map((e,t)=>o.jsxs("li",{children:[o.jsxs("strong",{children:[e.area,":"]})," DL ",e.deadLoad,", LL ",e.liveLoad]},t))})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-1",children:"Sizing Suggestions:"}),o.jsx("ul",{className:"space-y-1 text-sm",children:r.sizingSuggestions.map((e,t)=>o.jsxs("li",{className:"text-xs p-2 bg-slate-900/50 rounded-md",children:[o.jsxs("strong",{className:"capitalize",children:[e.type,":"]})," ",e.suggestedSize," - ",e.reason]},t))})]})]}),V1=r=>{const e=$e();return o.jsx(Pt,{...r,toolName:"Structural Analysis",description:"Get a preliminary structural analysis, including load-bearing wall identification and suggestions for column and beam sizing.",creditCost:25,icon:"🏛️",apiFn:rp,buildPayload:t=>{var i;return[e.createProjectData({projectType:((i=t.currentProject)==null?void 0:i.projectType)||"building",levels:t.levels,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(t,n)=>n.setAdvancedStructuralReport(t),buttonText:"Run Structural Analysis",renderResult:U1})},W1=({isActive:r,onClick:e,children:t})=>o.jsx("button",{onClick:e,className:`py-2 px-3 text-sm font-medium border-b-2 transition-colors flex-grow ${r?"border-pink-400 text-pink-300":"border-transparent text-slate-400 hover:text-white"}`,children:t}),H1=r=>{const{pushToUndoStack:e,setLevels:t,addNotification:n,currentProject:i,setLastAiToolRun:s}=r,[l,u]=V.useState("A modern 2-story villa with an infinity pool and large glass windows."),[d,m]=V.useState(!1),[g,v]=V.useState(null),[y,p]=V.useState(null),[N,b]=V.useState(0),I=async()=>{if(!l.trim()){n("Please enter a prompt.","error");return}m(!0),v(null),p(null);try{const S=await np((i==null?void 0:i.id)||"",l);p(S),b(0)}catch(S){v(S.message)}finally{m(!1)}},w=S=>{e(),t(S.projectData.levels||[]),n(`Applied '${S.summary.substring(0,20)}...' concept.`,"success"),s("DreamWeaver")};return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"DreamWeaver Engine"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Explore multiple design directions from a single prompt. The AI will generate concepts from different architectural personas."}),o.jsx("textarea",{value:l,onChange:S=>u(S.target.value),rows:3,className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-slate-100",placeholder:"Describe your vision...",disabled:d}),o.jsxs("button",{onClick:I,disabled:d||!l.trim(),className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700",children:[d?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"🌌"}),o.jsx("span",{className:"flex-grow",children:d?"Weaving Dreams...":"Generate Concepts"}),o.jsx(bn,{cost:80})]}),g&&o.jsx("p",{className:"text-red-400 text-xs mt-2",children:g}),y&&o.jsxs("div",{className:"mt-4 bg-slate-700/50 rounded-lg",children:[o.jsx("div",{className:"flex border-b border-slate-600",children:y.map((S,T)=>o.jsx(W1,{isActive:N===T,onClick:()=>b(T),children:S.persona},T))}),o.jsx("div",{className:"p-3",children:y[N]&&o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-slate-300 italic mb-2",children:['"',y[N].concept.summary,'"']}),o.jsx("img",{src:y[N].concept.previewRender.imageUrl,alt:`${y[N].persona} concept`,className:"w-full rounded-md mb-2"}),o.jsx("button",{onClick:()=>w(y[N].concept),className:"w-full py-2 text-sm bg-emerald-600 hover:bg-emerald-500 rounded-md font-semibold",children:"Apply this Concept"})]})})]})]})},G1=Ei.div,Ai=({icon:r,title:e,justification:t})=>o.jsxs("div",{className:"bg-slate-900/50 p-3 rounded-lg flex items-start gap-3",children:[o.jsx("div",{className:"text-2xl mt-1",children:r}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-100",children:e}),o.jsxs("p",{className:"text-xs text-slate-400 italic",children:['"',t,'"']})]})]}),$1=r=>{var M,Q,ce,E,_,B,q,ae;const{currentUser:e,levels:t,activeLevelIndex:n,setBuyCreditsModalOpen:i,atmanSignature:s,runAiFurnishRoom:l}=$e(),[u,d]=V.useState(""),[m,g]=V.useState("modern minimalist"),[v,y]=V.useState(!1),[p,N]=V.useState(null),[b,I]=V.useState(null),[w,S]=V.useState(!1),{addNotification:T}=pr(),W=t[n],G=(W==null?void 0:W.rooms)||[],te=async()=>{if(!u||!m){T("Please select a room and define a style.","error");return}if(!e){T("Please log in to use this feature.","error");return}const K=w?15:10;if(e.role!=="owner"&&e.credits<K){T(`You need ${K} credits. You have ${e.credits}.`,"info"),i(!0);return}y(!0),N(null),I(null);try{const se=await l(u,m,w&&s||void 0,!1);se&&(I(se),T("Interior scheme generated! Review and apply.","success"))}catch(fe){N(fe.message),T(fe.message,"error")}finally{y(!1)}},H=async()=>{if(b){y(!0);try{await l(u,m,w&&s||void 0,!0,b),T("AI scheme has been placed in the room!","success"),I(null)}catch(K){T(`Failed to apply scheme: ${K.message}`,"error")}finally{y(!1)}}};return o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"AI Interior Decorator (for Digital Model)"}),o.jsx("p",{className:"text-sm text-slate-300 -mt-2 mb-3",children:"Automatically furnish your digital 3D model based on a style prompt. The AI will select and place furniture, lighting, decor, and materials."}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Select Room"}),o.jsxs("select",{value:u,onChange:K=>d(K.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white",children:[o.jsx("option",{value:"",children:"-- Choose a room --"}),G.map(K=>o.jsx("option",{value:K.id,children:K.name},K.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Design Style"}),o.jsx("input",{type:"text",value:m,onChange:K=>g(K.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white",placeholder:"e.g., Scandinavian, Industrial, Boho..."})]}),s&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",id:"useAtman",checked:w,onChange:K=>S(K.target.checked),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),o.jsxs("label",{htmlFor:"useAtman",className:"text-sm text-purple-200 flex items-center gap-2",children:["Use Atman Signature ",o.jsx("span",{className:"text-xs text-slate-400",children:"(+5 Credits)"})]})]}),o.jsxs("button",{onClick:te,disabled:v||!u,className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700",children:[v&&!b?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"🎨"}),o.jsx("span",{className:"flex-grow",children:v&&!b?"Designing...":"Generate Interior Scheme"}),o.jsx(bn,{cost:w?15:10})]}),p&&o.jsx("p",{className:"text-red-400 text-xs mt-2",children:p}),b&&o.jsxs(G1,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-3 bg-slate-700/50 rounded-lg",children:[o.jsx("h4",{className:"font-bold text-pink-300 mb-2",children:"Generated Scheme"}),o.jsxs("p",{className:"text-sm text-slate-300 italic mb-3",children:['"',b.designNarrative,'"']}),o.jsxs("button",{onClick:H,disabled:v,className:"w-full mb-3 p-3 text-sm bg-emerald-600 hover:bg-emerald-500 rounded-md font-semibold flex items-center justify-center",children:[v?o.jsx(dt,{size:"h-5 w-5 mr-2"}):"✨",v?"Placing Items...":"Auto-Place All Items"]}),o.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2",children:[o.jsx("h5",{className:"text-sm font-semibold text-slate-200",children:"Materials"}),o.jsx(Ai,{icon:"🎨",title:"Flooring",justification:b.materials.floor.justification}),o.jsx(Ai,{icon:"🖌️",title:"Walls",justification:b.materials.primaryWall.justification}),b.materials.accentWall&&o.jsx(Ai,{icon:"🧱",title:"Accent Wall",justification:b.materials.accentWall.justification}),(((M=b.furniture)==null?void 0:M.length)||0)>0&&o.jsx("h5",{className:"text-sm font-semibold text-slate-200 pt-2",children:"Furniture"}),(Q=b.furniture)==null?void 0:Q.map(K=>o.jsx(Ai,{icon:"🛋️",title:K.name,justification:K.justification||"No justification provided."},K.modelKey)),(((ce=b.lighting)==null?void 0:ce.length)||0)>0&&o.jsx("h5",{className:"text-sm font-semibold text-slate-200 pt-2",children:"Lighting"}),(E=b.lighting)==null?void 0:E.map(K=>o.jsx(Ai,{icon:"💡",title:K.name,justification:K.justification||"No justification provided."},K.modelKey)),(((_=b.textiles)==null?void 0:_.length)||0)>0&&o.jsx("h5",{className:"text-sm font-semibold text-slate-200 pt-2",children:"Textiles"}),(B=b.textiles)==null?void 0:B.map(K=>o.jsx(Ai,{icon:"🧣",title:K.name,justification:K.justification||"No justification provided."},K.modelKey)),(((q=b.decor)==null?void 0:q.length)||0)>0&&o.jsx("h5",{className:"text-sm font-semibold text-slate-200 pt-2",children:"Decor"}),(ae=b.decor)==null?void 0:ae.map(K=>o.jsx(Ai,{icon:"🪴",title:K.name,justification:K.justification||"No justification provided."},K.modelKey))]})]})]})},K1=Ei.div,Uu=({label:r,value:e,min:t,max:n,step:i,onChange:s})=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:r}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"range",min:t,max:n,step:i,value:e,onChange:s,className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer"}),o.jsx("span",{className:"text-xs font-mono text-slate-400 w-12 text-right",children:e.toFixed(0)})]})]}),Y1=({label:r,options:e,selected:t,onChange:n})=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:r}),o.jsx("div",{className:"flex gap-2",children:e.map(i=>o.jsx("button",{onClick:()=>n(i.value),className:`flex-1 py-2 text-xs font-semibold rounded-md transition-colors ${t===i.value?"bg-sky-600 text-white":"bg-slate-700 hover:bg-slate-600"}`,children:i.label},i.value))})]}),J1=({currentProject:r})=>{const{currentUser:e,setBuyCreditsModalOpen:t,refreshCurrentUser:n}=$e(),{addNotification:i}=pr(),s=V.useRef(null),[l,u]=V.useState(null),[d,m]=V.useState(null),[g,v]=V.useState(null),[y,p]=V.useState("modern minimalist"),[N,b]=V.useState(null),I=async T=>{var te;const W=(te=T.target.files)==null?void 0:te[0];if(!W||!r)return;u(null),m(null),v(null);const G=new FileReader;G.onload=async H=>{var ce;const M=(ce=H.target)==null?void 0:ce.result;u(M);const Q=M.split(",")[1];if(e){if(e.role!=="owner"&&e.credits<5){i("You need 5 credits for style analysis.","info"),t(!0);return}b("analyzing");try{const{style:E}=await ip(r.id,Q,W.type);p(E),i("Style analysis complete!","success"),await n()}catch(E){i(E.message,"error")}finally{b(null)}}},G.readAsDataURL(W)},w=async()=>{if(!(!l||!r||!e)){if(e.role!=="owner"&&e.credits<25){i("You need 25 credits to empty a room.","info"),t(!0);return}b("emptying");try{const T=l.split(",")[1],W=l.substring(l.indexOf(":")+1,l.indexOf(";")),{imageUrl:G}=await sp(r.id,T,W);m(G),await n()}catch(T){i(T.message,"error")}finally{b(null)}}},S=async()=>{if(!(!d||!r||!e)){if(e.role!=="owner"&&e.credits<20){i("You need 20 credits to stage a room.","info"),t(!0);return}b("staging");try{const T=d.split(",")[1],W=d.substring(d.indexOf(":")+1,d.indexOf(";")),{imageUrl:G}=await ap(r.id,T,W,y);v(G),await n()}catch(T){i(T.message,"error")}finally{b(null)}}};return o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Aura Instant Staging (Photo)"}),o.jsx("p",{className:"text-sm text-slate-300 -mt-2",children:"Virtually stage real photos. Upload a picture of an empty or furnished room, and the AI will refurnish it based on your style."}),o.jsxs("div",{className:"p-4 bg-slate-900/50 rounded-lg border border-dashed border-slate-600 space-y-4",children:[o.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:s,onChange:I}),o.jsxs("button",{onClick:()=>{var T;return(T=s.current)==null?void 0:T.click()},disabled:!!N,className:"w-full px-4 py-2 text-sm text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-amber-600 hover:bg-amber-500",children:[N==="analyzing"?o.jsx(dt,{size:"h-5 w-5 mr-2"}):"✨",o.jsx("span",{className:"flex-grow",children:N==="analyzing"?"Analyzing...":"1. Upload Photo & Analyze Style"}),o.jsx(bn,{cost:5})]}),o.jsx(ga,{children:l&&o.jsxs(K1,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 overflow-hidden",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-slate-400",children:"Original"}),o.jsx("img",{src:l,alt:"Original",className:"w-full aspect-square object-cover rounded mt-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-slate-400",children:"Emptied"}),d?o.jsx("img",{src:d,alt:"Emptied",className:"w-full aspect-square object-cover rounded mt-1"}):o.jsx("div",{className:"w-full aspect-square flex items-center justify-center bg-slate-800 rounded mt-1",children:N==="emptying"&&o.jsx(dt,{})})]})]}),o.jsxs("button",{onClick:w,disabled:!!N||!!d,className:"w-full text-sm p-2 rounded-md bg-sky-600 hover:bg-sky-500 disabled:bg-slate-600",children:["2. Empty Room ",o.jsx(bn,{cost:25})]}),d&&o.jsxs("div",{className:"space-y-2 pt-2 border-t border-slate-700",children:[o.jsx("label",{className:"text-sm font-medium",children:"Refurnish Style"}),o.jsx(Bd,{value:y,onChange:T=>p(T.target.value),disabled:!!N}),o.jsxs("button",{onClick:S,disabled:!!N,className:"w-full text-sm p-2 rounded-md bg-purple-600 hover:bg-purple-500 disabled:bg-slate-600",children:["3. Stage Room ",o.jsx(bn,{cost:20})]}),g&&o.jsx("img",{src:g,alt:"Staged",className:"w-full rounded mt-2"})]})]})})]})]})},X1=({sunPosition:r,setSunPosition:e,stagingSettings:t,setStagingSettings:n})=>{const i=(s,l)=>{n(u=>({...u,[s]:l}))};return o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Scene Lighting (3D Model)"}),o.jsx("p",{className:"text-sm text-slate-300 -mt-2",children:"Control the lighting and atmosphere of your digital 3D model."}),o.jsx(Uu,{label:"Sun Direction",value:r.azimuth,min:0,max:360,step:1,onChange:s=>e(l=>({...l,azimuth:Number(s.target.value)}))}),o.jsx(Uu,{label:"Sun Height",value:r.altitude,min:0,max:180,step:1,onChange:s=>e(l=>({...l,altitude:Number(s.target.value)}))}),o.jsx(Y1,{label:"Time of Day Preset",options:[{value:"midday",label:"Midday"},{value:"sunset",label:"Sunset"},{value:"night",label:"Night"}],selected:t.timeOfDay,onChange:s=>i("timeOfDay",s)})]})},Q1=r=>o.jsxs("div",{className:"space-y-6",children:[o.jsx(X1,{...r}),o.jsxs("div",{className:"relative text-center my-2",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-slate-700"})}),o.jsx("div",{className:"relative inline-block px-2 bg-slate-800 text-xs text-slate-500",children:"OR"})]}),o.jsx(J1,{...r})]}),Z1=r=>o.jsxs("div",{className:"mt-4 p-4 bg-slate-700/50 rounded-lg space-y-4",children:[o.jsx("div",{className:"prose prose-sm prose-invert max-w-none text-slate-200 whitespace-pre-wrap",children:r.text}),r.sources&&r.sources.length>0&&o.jsxs("div",{className:"border-t border-slate-600 pt-3",children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-2",children:"Sources"}),o.jsx("ul",{className:"space-y-1 text-xs list-disc list-inside",children:r.sources.map((e,t)=>o.jsx("li",{children:o.jsx("a",{href:e.web.uri,target:"_blank",rel:"noopener noreferrer",className:"text-sky-400 hover:underline",children:e.web.title||e.web.uri})},t))})]})]}),e2=r=>{const{currentProject:e}=r,[t,n]=V.useState((e==null?void 0:e.location)||""),[i,s]=V.useState(""),l=$e();return o.jsx(Pt,{...r,toolName:"Oracle AI Analysis",description:"Ask financial, market, or performance questions about your project. The Oracle uses real-world data via Google Search to provide grounded answers.",creditCost:15,icon:"🔮",apiFn:op,buildPayload:u=>{var m;return!t.trim()||!i.trim()?(u.addNotification("Please provide a project location and a question.","error"),null):[l.createProjectData({projectType:((m=u.currentProject)==null?void 0:m.projectType)||"building",levels:u.levels,planNorthDirection:u.planNorthDirection,propertyLines:u.propertyLines,terrainMesh:u.terrainMesh,zones:[],infrastructure:[]}),t,i]},onSuccess:u=>{},buttonText:"Run Predictive Analysis",renderResult:Z1,children:o.jsxs("div",{className:"space-y-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"location-input",className:"block text-sm font-medium text-slate-300 mb-1",children:"Project Location"}),o.jsx("input",{type:"text",id:"location-input",value:t,onChange:u=>n(u.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white",placeholder:"e.g., Mumbai, India"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"question-input",className:"block text-sm font-medium text-slate-300 mb-1",children:"Your Question"}),o.jsx("textarea",{id:"question-input",rows:3,value:i,onChange:u=>s(u.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white",placeholder:"e.g., Estimated cost for this design, or 'इस डिज़ाइन की अनुमानित लागत क्या है?'"})]})]})})},th=Ei.div,Vu=({prediction:r,onProposeFix:e,isFixing:t,isPreviewActive:n,onAcceptFix:i,onRejectFix:s})=>{const l={on_schedule:"border-green-500",at_risk:"border-yellow-500",delayed:"border-red-500",misaligned:"border-orange-500",new:"border-sky-500"};return o.jsxs(th,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-3 bg-slate-900/50 rounded-lg border-l-4 ${l[r.status]}`,children:[o.jsxs("p",{className:"font-semibold text-slate-200 capitalize",children:[r.elementType," ",o.jsxs("span",{className:"text-xs",children:["(",r.elementId,")"]})," - ",o.jsx("span",{className:"uppercase",children:r.status.replace("_"," ")})]}),o.jsx("p",{className:"text-sm text-slate-300 mt-1",children:r.details}),r.suggestedAction&&o.jsxs("p",{className:"text-sm text-sky-300 mt-2",children:[o.jsx("strong",{children:"Suggested Action:"})," ",r.suggestedAction]}),n?o.jsxs("div",{className:"mt-2 p-2 bg-purple-900/50 border border-purple-600 rounded-lg text-center",children:[o.jsx("p",{className:"text-sm text-purple-200 mb-2",children:"💡 AI has proposed a fix. Preview it on the 2D canvas."}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:i,className:"flex-1 p-1 text-xs bg-emerald-600 hover:bg-emerald-500 rounded-md",children:"Accept Fix"}),o.jsx("button",{onClick:s,className:"flex-1 p-1 text-xs bg-slate-600 hover:bg-slate-500 rounded-md",children:"Reject"})]})]}):r.status==="misaligned"&&o.jsx("div",{className:"mt-2",children:o.jsxs("button",{onClick:()=>e(r),disabled:t,className:"w-full text-xs p-1 rounded-md bg-sky-600 hover:bg-sky-500 text-white font-semibold flex items-center justify-center disabled:bg-sky-800",children:[t?o.jsx(dt,{size:"h-4 w-4 mr-2"}):"💡",o.jsx("span",{className:"flex-grow",children:"Propose AI Fix"}),o.jsx(bn,{cost:5})]})})]})},t2=r=>{const e=$e(),{isJuggernautModeActive:t,juggernautPredictions:n,runSiteAdjudicator:i,globalLoadingMessage:s,currentProject:l,levels:u,planNorthDirection:d,propertyLines:m,terrainMesh:g,aiFixPreview:v,setAiFixPreview:y,applySamaranganFix:p,currentUser:N,setBuyCreditsModalOpen:b,refreshCurrentUser:I,isSimulatingLiveData:w,setIsSimulatingLiveData:S}=e,[T,W]=V.useState(null),{addNotification:G}=pr(),te=async B=>{var q,ae;if(!N){G("Please log in.","error");return}if(N.role!=="owner"&&N.credits<5){G("You need 5 credits to propose a fix.","info"),b(!0);return}W(B.elementId);try{const K=e.createProjectData({name:((q=r.currentProject)==null?void 0:q.name)||"Untitled Project",projectType:((ae=r.currentProject)==null?void 0:ae.projectType)||"building",levels:r.levels,planNorthDirection:r.planNorthDirection,propertyLines:r.propertyLines,terrainMesh:r.terrainMesh,zones:[],infrastructure:[]}),fe=await lp((l==null?void 0:l.id)||"",B,K);y({commentId:B.elementId,fix:fe.fix}),G("AI has proposed a fix! Preview it on the canvas.","success"),await I()}catch(K){G(`AI Fix failed: ${K.message}`,"error")}finally{W(null)}},H=()=>{v&&p(v.fix)},M=()=>{y(null)},Q=s==null?void 0:s.includes("Adjudicator"),ce=(n==null?void 0:n.filter(B=>B.status==="delayed"||B.status==="misaligned"))||[],E=(n==null?void 0:n.filter(B=>B.status==="at_risk"))||[],_=(n==null?void 0:n.filter(B=>B.status==="on_schedule").length)||0;return o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Site Adjudicator AI"}),o.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold",children:[o.jsxs("span",{className:"relative flex h-3 w-3",children:[t&&o.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full ${t?"bg-red-400":"bg-slate-500"} opacity-75`}),o.jsx("span",{className:`relative inline-flex rounded-full h-3 w-3 ${t?"bg-red-500":"bg-slate-600"}`})]}),t?"LIVE FEED ACTIVE":"INACTIVE"]})]}),o.jsx("p",{className:"text-sm text-slate-300 mb-4",children:"This panel displays a live feed from the Juggernaut Protocol, analyzing on-site progress against the digital plan in real-time."}),o.jsxs("div",{className:"p-3 my-4 bg-slate-700/50 rounded-lg flex items-center justify-between",children:[o.jsx("label",{htmlFor:"live-data-toggle",className:"text-sm font-medium text-slate-200",children:"Simulate Live Data Feed"}),o.jsx("input",{type:"checkbox",id:"live-data-toggle",checked:w,onChange:B=>S(B.target.checked),className:"h-4 w-4 rounded text-primary bg-slate-600 border-slate-500 focus:ring-primary"})]}),t?o.jsxs("div",{className:"space-y-6",children:[!n&&o.jsxs("div",{className:"text-center p-4",children:[o.jsx("p",{className:"text-slate-400 mb-2",children:"Live feed is active. Run initial site scan to populate data."}),o.jsx("button",{onClick:i,disabled:Q,className:"px-4 py-2 text-sm font-semibold text-white rounded-md transition-all bg-gradient-to-r from-red-600 to-orange-500 hover:from-red-700 hover:to-orange-600 disabled:opacity-50 flex items-center justify-center",children:Q?o.jsx(dt,{size:"h-5 w-5"}):"Run Manual Adjudication Scan (20 Cr)"})]}),o.jsx(ga,{children:n&&o.jsxs(th,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("h4",{className:"font-semibold text-red-400 mb-2",children:["High-Severity Discrepancies (",ce.length,")"]}),o.jsx("div",{className:"space-y-2",children:o.jsx(ga,{children:ce.length>0?ce.map(B=>o.jsx(Vu,{prediction:B,onProposeFix:te,isFixing:T===B.elementId,isPreviewActive:(v==null?void 0:v.commentId)===B.elementId,onAcceptFix:H,onRejectFix:M},B.elementId)):o.jsx("p",{className:"text-xs text-slate-500",children:"None detected."})})})]}),o.jsxs("div",{children:[o.jsxs("h4",{className:"font-semibold text-yellow-400 mb-2",children:["Elements at Risk (",E.length,")"]}),o.jsx("div",{className:"space-y-2",children:o.jsx(ga,{children:E.length>0?E.map(B=>o.jsx(Vu,{prediction:B,onProposeFix:te,isFixing:T===B.elementId,isPreviewActive:(v==null?void 0:v.commentId)===B.elementId,onAcceptFix:H,onRejectFix:M},B.elementId)):o.jsx("p",{className:"text-xs text-slate-500",children:"None detected."})})})]}),o.jsxs("div",{children:[o.jsxs("h4",{className:"font-semibold text-green-400 mb-2",children:["On Schedule (",_,")"]}),o.jsx("p",{className:"text-xs text-slate-500",children:_>0?`${_} elements are progressing as planned.`:"Awaiting data..."})]})]})})]}):o.jsx("div",{className:"text-center p-8 bg-slate-700/50 rounded-lg",children:o.jsx("p",{className:"text-slate-400",children:"Activate the Juggernaut Protocol from the bottom dock to begin live site monitoring."})})]})},r2=r=>`${r}_${new Date().getTime()}_${Math.random().toString(36).substring(2,7)}`,n2=r=>{const{currentUser:e,levels:t,activeLevelIndex:n,setSingleLevelProp:i,pushToUndoStack:s,focusedCommentId:l,setFocusedCommentId:u,setBuyCreditsModalOpen:d,refreshCurrentUser:m,aiFixPreview:g,setAiFixPreview:v,currentProject:y,applySamaranganFix:p}=r,N=t[n];if(!N)return null;const b=N.comments||[],I=_=>i("comments",_),[w,S]=V.useState(""),[T,W]=V.useState(null),{addNotification:G}=pr(),te=$e(),H=b==null?void 0:b.find(_=>_.id===l),M=_=>{s(),I(B=>B.map(q=>q.id===_?{...q,resolved:!q.resolved}:q))},Q=_=>{if(_.preventDefault(),!w.trim()||!H||!e)return;s();const B={id:r2("reply"),userId:e.id,userName:e.name||e.email,text:w.trim(),createdAt:new Date().toISOString()};I(q=>q.map(ae=>ae.id===H.id?{...ae,replies:[...ae.replies||[],B]}:ae)),S("")},ce=async _=>{var B,q;if(!e){G("Please log in.","error");return}if(e.role!=="owner"&&e.credits<5){G("You need 5 credits.","info"),d(!0);return}W(_.id);try{const ae=te.createProjectData({name:((B=r.currentProject)==null?void 0:B.name)||"Untitled Project",projectType:((q=r.currentProject)==null?void 0:q.projectType)||"building",levels:r.levels,planNorthDirection:r.planNorthDirection,propertyLines:r.propertyLines,terrainMesh:r.terrainMesh,zones:[],infrastructure:[]}),K=await cp((y==null?void 0:y.id)||"",_.text,ae,{x:_.x,y:_.y});v({commentId:_.id,fix:K.fix}),G("AI has proposed a fix! Preview it on the canvas.","success"),await m()}catch(ae){G(`AI Fix failed: ${ae.message}`,"error")}finally{W(null)}},E=()=>{g&&p(g.fix)};return o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex-grow overflow-y-auto",children:[(b==null?void 0:b.length)===0&&o.jsx("p",{className:"text-center text-slate-400 p-4",children:"No comments on this level yet. Use the comment tool to add feedback."}),o.jsx("ul",{className:"space-y-2",children:b==null?void 0:b.map(_=>o.jsx("li",{onClick:()=>u(_.id),className:`p-3 rounded-lg cursor-pointer transition-colors ${l===_.id?"bg-slate-700":"bg-slate-900/50 hover:bg-slate-700/50"}`,children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("p",{className:`text-sm ${_.resolved?"line-through text-slate-500":"text-slate-200"}`,children:_.text}),o.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:[_.userName," - ",new Date(_.createdAt).toLocaleDateString()]})]}),o.jsx("button",{onClick:B=>{B.stopPropagation(),M(_.id)},className:`p-1 rounded-full ${_.resolved?"bg-emerald-500":"bg-slate-600"}`,children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})]})},_.id))})]}),H&&o.jsxs("div",{className:"flex-shrink-0 p-3 border-t border-slate-700 bg-slate-800",children:[o.jsxs("h4",{className:"text-base font-semibold text-sky-300 mb-2",children:['Thread for: "',H.text,'"']}),o.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto mb-2 pr-2",children:(H.replies||[]).map(_=>o.jsxs("div",{className:"bg-slate-700 p-2 rounded-md",children:[o.jsx("p",{className:"text-sm text-slate-300",children:_.text}),o.jsx("p",{className:"text-xs text-slate-500 text-right mt-1",children:_.userName})]},_.id))}),g&&g.commentId===H.id&&o.jsxs("div",{className:"my-2 p-3 bg-purple-900/50 border border-purple-600 rounded-lg text-center",children:[o.jsx("p",{className:"text-sm text-purple-200 mb-2",children:"💡 AI has proposed a fix. Preview the changes on the 2D canvas."}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:E,className:"flex-1 p-2 text-sm bg-emerald-600 hover:bg-emerald-500 rounded-md",children:"Apply Fix"}),o.jsx("button",{onClick:()=>v(null),className:"flex-1 p-2 text-sm bg-slate-600 hover:bg-slate-500 rounded-md",children:"Discard"})]})]}),o.jsxs("button",{onClick:()=>ce(H),disabled:T===H.id||!!g,className:"w-full text-sm p-2 rounded-md bg-sky-600 hover:bg-sky-500 text-white font-semibold flex items-center justify-center disabled:bg-sky-800",children:[T===H.id?o.jsx(dt,{size:"h-4 w-4 mr-2"}):"💡"," Ask AI to Fix (5 Cr)"]}),o.jsxs("form",{onSubmit:Q,className:"flex gap-2 mt-2",children:[o.jsx("input",{type:"text",value:w,onChange:_=>S(_.target.value),placeholder:"Add a reply...",className:"flex-grow p-2 text-sm bg-slate-700 border border-slate-600 rounded-md"}),o.jsx("button",{type:"submit",className:"px-4 bg-slate-600 rounded-md",children:"Send"})]})]})]})},i2=({setCurrentPlacingModelKey:r,currentPlacingModelKey:e})=>{const[t,n]=V.useState(null),i=Array.from(new Set(_u.map(l=>l.category))),s=_u.reduce((l,u)=>(l[u.category]||(l[u.category]=[]),l[u.category].push(u),l),{});return o.jsxs("div",{className:"p-3 bg-slate-700 rounded-md h-full flex flex-col",children:[o.jsx("h4",{className:"text-lg font-semibold text-sky-300 mb-3",children:"Place 3D Models"}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{htmlFor:"categoryFilter",className:"text-xs text-slate-300 mr-2",children:"Filter by Category:"}),o.jsxs("select",{id:"categoryFilter",value:t||"",onChange:l=>n(l.target.value||null),className:"text-xs p-1.5 bg-slate-600 border border-slate-500 rounded text-white focus:ring-sky-500",children:[o.jsx("option",{value:"",children:"All Categories"}),i.map(l=>o.jsx("option",{value:l,children:l},l))]})]}),o.jsx("div",{className:"flex-grow overflow-y-auto pr-1 space-y-3",children:Object.entries(s).map(([l,u])=>t&&t!==l?null:o.jsxs("div",{children:[o.jsx("h5",{className:"text-md font-semibold text-emerald-300 mb-1.5",children:l}),o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:u.map(d=>o.jsx("button",{onClick:()=>r(e===d.key?null:d.key),title:`Place ${d.name}`,className:`p-2 rounded-md text-xs transition-all duration-150 ease-in-out text-center
                                ${e===d.key?"bg-sky-500 ring-2 ring-sky-300 text-white":"bg-slate-800 hover:bg-slate-700 text-slate-300"}`,children:d.name},d.key))})]},l))})]})},Wu=[{name:"Photorealistic",prompt:"award-winning photorealistic architectural photography, cinematic lighting, ultra-detailed, 8k"},{name:"Clay Model",prompt:"monochromatic clay model render, ambient occlusion, studio lighting, minimalist"},{name:"Blueprint",prompt:"schematic blueprint style, white lines on a blue background, technical drawing"},{name:"Watercolor",prompt:"architectural watercolor sketch, soft edges, artistic, vibrant colors"}],s2=r=>{var q,ae;const{levels:e,activeLevelIndex:t,currentUser:n,setBuyCreditsModalOpen:i,refreshCurrentUser:s,planNorthDirection:l,propertyLines:u,terrainMesh:d,currentProject:m,setGeneratedRenders:g,setLastAiToolRun:v}=r,y=e[t],[p,N]=V.useState(""),[b,I]=V.useState(Wu[0].prompt),[w,S]=V.useState("16:9"),[T,W]=V.useState(!1),[G,te]=V.useState(null),[H,M]=V.useState(null),{addNotification:Q}=pr(),E=$e().createProjectData({name:((q=r.currentProject)==null?void 0:q.name)||"Untitled Project",projectType:((ae=r.currentProject)==null?void 0:ae.projectType)||"building",levels:e,planNorthDirection:l,propertyLines:u,terrainMesh:d,zones:[],infrastructure:[]}),_=5,B=async()=>{if(!p||!b){Q("Please select a room and provide a style prompt.","error");return}if(!n||!m){Q("Please log in and open a project.","error");return}if(n.role!=="owner"&&n.credits<_){Q(`You need ${_} credits.`,"info"),i(!0);return}W(!0),te(null),M(null);try{const K={aspectRatio:w},fe=await up(m.id,E,p,b,K);M(fe.imageUrl);const se={prompt:b,url:fe.imageUrl},me=await Mp(m.id,se);g(me),v("Render"),Q("Render generated and saved to Project Hub!","success"),await s()}catch(K){te(K.message),Q(K.message,"error")}finally{W(!1)}};return o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-slate-300 mb-3",children:["Generate a photorealistic render for a specific room on the current level (",y.name,")."]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"room-select-render",className:"block text-sm font-medium text-slate-300 mb-1",children:"Select Room"}),o.jsxs("select",{id:"room-select-render",value:p,onChange:K=>N(K.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white",children:[o.jsx("option",{value:"",children:"-- Select a room --"}),y.rooms.map(K=>o.jsx("option",{value:K.id,children:K.name},K.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"aspect-ratio-select",className:"block text-sm font-medium text-slate-300 mb-1",children:"Aspect Ratio"}),o.jsxs("select",{id:"aspect-ratio-select",value:w,onChange:K=>S(K.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white",children:[o.jsx("option",{value:"16:9",children:"16:9 (Widescreen)"}),o.jsx("option",{value:"1:1",children:"1:1 (Square)"}),o.jsx("option",{value:"9:16",children:"9:16 (Portrait)"}),o.jsx("option",{value:"4:3",children:"4:3 (Standard)"}),o.jsx("option",{value:"3:4",children:"3:4 (Portrait)"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"style-preset-select",className:"block text-sm font-medium text-slate-300 mb-1",children:"Style Preset"}),o.jsxs("select",{id:"style-preset-select",onChange:K=>I(K.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white",children:[Wu.map(K=>o.jsx("option",{value:K.prompt,children:K.name},K.name)),o.jsx("option",{value:"",children:"Custom..."})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"style-prompt-render",className:"block text-sm font-medium text-slate-300 mb-1",children:"Style Prompt Details"}),o.jsx("textarea",{id:"style-prompt-render",rows:3,value:b,onChange:K=>I(K.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-white"})]})]}),o.jsxs("button",{onClick:B,disabled:T||!p||!b,className:"w-full mt-4 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600",children:[T?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"🖼️"}),o.jsx("span",{className:"flex-grow",children:T?"Rendering...":"Generate Render"}),o.jsx(bn,{cost:_})]}),G&&o.jsx("p",{className:"text-red-400 text-xs mt-2",children:G}),H&&o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"font-semibold text-slate-200 mb-2",children:"Generated Render:"}),o.jsx("img",{src:H,alt:"Generated render",className:"w-full rounded-md shadow-lg"})]})]})};function vt(r){"@babel/helpers - typeof";return vt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vt(r)}var cr=Uint8Array,Ir=Uint16Array,Bc=Int32Array,Ko=new cr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Yo=new cr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uc=new cr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rh=function(r,e){for(var t=new Ir(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var i=new Bc(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)i[s]=s-t[n]<<5|n;return{b:t,r:i}},nh=rh(Ko,2),ih=nh.b,dc=nh.r;ih[28]=258,dc[258]=28;var sh=rh(Yo,0),a2=sh.b,Hu=sh.r,hc=new Ir(32768);for(var St=0;St<32768;++St){var ni=(St&43690)>>1|(St&21845)<<1;ni=(ni&52428)>>2|(ni&13107)<<2,ni=(ni&61680)>>4|(ni&3855)<<4,hc[St]=((ni&65280)>>8|(ni&255)<<8)>>1}var Nn=function(r,e,t){for(var n=r.length,i=0,s=new Ir(e);i<n;++i)r[i]&&++s[r[i]-1];var l=new Ir(e);for(i=1;i<e;++i)l[i]=l[i-1]+s[i-1]<<1;var u;if(t){u=new Ir(1<<e);var d=15-e;for(i=0;i<n;++i)if(r[i])for(var m=i<<4|r[i],g=e-r[i],v=l[r[i]-1]++<<g,y=v|(1<<g)-1;v<=y;++v)u[hc[v]>>d]=m}else for(u=new Ir(n),i=0;i<n;++i)r[i]&&(u[i]=hc[l[r[i]-1]++]>>15-r[i]);return u},ci=new cr(288);for(var St=0;St<144;++St)ci[St]=8;for(var St=144;St<256;++St)ci[St]=9;for(var St=256;St<280;++St)ci[St]=7;for(var St=280;St<288;++St)ci[St]=8;var ya=new cr(32);for(var St=0;St<32;++St)ya[St]=5;var o2=Nn(ci,9,0),l2=Nn(ci,9,1),c2=Nn(ya,5,0),u2=Nn(ya,5,1),Ul=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},Zr=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},Vl=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},qc=function(r){return(r+7)/8|0},ah=function(r,e,t){return(e==null||e<0)&&(e=0),(t==null||t>r.length)&&(t=r.length),new cr(r.subarray(e,t))},d2=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],tn=function(r,e,t){var n=new Error(e||d2[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,tn),!t)throw n;return n},h2=function(r,e,t,n){var i=r.length,s=n?n.length:0;if(!i||e.f&&!e.l)return t||new cr(0);var l=!t,u=l||e.i!=2,d=e.i;l&&(t=new cr(i*3));var m=function(Ae){var Ee=t.length;if(Ae>Ee){var _e=new cr(Math.max(Ee*2,Ae));_e.set(t),t=_e}},g=e.f||0,v=e.p||0,y=e.b||0,p=e.l,N=e.d,b=e.m,I=e.n,w=i*8;do{if(!p){g=Zr(r,v,1);var S=Zr(r,v+1,3);if(v+=3,S)if(S==1)p=l2,N=u2,b=9,I=5;else if(S==2){var te=Zr(r,v,31)+257,H=Zr(r,v+10,15)+4,M=te+Zr(r,v+5,31)+1;v+=14;for(var Q=new cr(M),ce=new cr(19),E=0;E<H;++E)ce[uc[E]]=Zr(r,v+E*3,7);v+=H*3;for(var _=Ul(ce),B=(1<<_)-1,q=Nn(ce,_,1),E=0;E<M;){var ae=q[Zr(r,v,B)];v+=ae&15;var T=ae>>4;if(T<16)Q[E++]=T;else{var K=0,fe=0;for(T==16?(fe=3+Zr(r,v,3),v+=2,K=Q[E-1]):T==17?(fe=3+Zr(r,v,7),v+=3):T==18&&(fe=11+Zr(r,v,127),v+=7);fe--;)Q[E++]=K}}var se=Q.subarray(0,te),me=Q.subarray(te);b=Ul(se),I=Ul(me),p=Nn(se,b,1),N=Nn(me,I,1)}else tn(1);else{var T=qc(v)+4,W=r[T-4]|r[T-3]<<8,G=T+W;if(G>i){d&&tn(0);break}u&&m(y+W),t.set(r.subarray(T,G),y),e.b=y+=W,e.p=v=G*8,e.f=g;continue}if(v>w){d&&tn(0);break}}u&&m(y+131072);for(var ee=(1<<b)-1,Le=(1<<I)-1,k=v;;k=v){var K=p[Vl(r,v)&ee],R=K>>4;if(v+=K&15,v>w){d&&tn(0);break}if(K||tn(2),R<256)t[y++]=R;else if(R==256){k=v,p=null;break}else{var z=R-254;if(R>264){var E=R-257,Y=Ko[E];z=Zr(r,v,(1<<Y)-1)+ih[E],v+=Y}var ne=N[Vl(r,v)&Le],ue=ne>>4;ne||tn(3),v+=ne&15;var me=a2[ue];if(ue>3){var Y=Yo[ue];me+=Vl(r,v)&(1<<Y)-1,v+=Y}if(v>w){d&&tn(0);break}u&&m(y+131072);var de=y+z;if(y<me){var he=s-me,Se=Math.min(me,de);for(he+y<0&&tn(3);y<Se;++y)t[y]=n[he+y]}for(;y<de;++y)t[y]=t[y-me]}}e.l=p,e.p=k,e.b=y,e.f=g,p&&(g=1,e.m=b,e.d=N,e.n=I)}while(!g);return y!=t.length&&l?ah(t,0,y):t.subarray(0,y)},Mn=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8},ca=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8,r[n+2]|=t>>16},Wl=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var i=t.length,s=t.slice();if(!i)return{t:lh,l:0};if(i==1){var l=new cr(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(G,te){return G.f-te.f}),t.push({s:-1,f:25001});var u=t[0],d=t[1],m=0,g=1,v=2;for(t[0]={s:-1,f:u.f+d.f,l:u,r:d};g!=i-1;)u=t[t[m].f<t[v].f?m++:v++],d=t[m!=g&&t[m].f<t[v].f?m++:v++],t[g++]={s:-1,f:u.f+d.f,l:u,r:d};for(var y=s[0].s,n=1;n<i;++n)s[n].s>y&&(y=s[n].s);var p=new Ir(y+1),N=fc(t[g-1],p,0);if(N>e){var n=0,b=0,I=N-e,w=1<<I;for(s.sort(function(te,H){return p[H.s]-p[te.s]||te.f-H.f});n<i;++n){var S=s[n].s;if(p[S]>e)b+=w-(1<<N-p[S]),p[S]=e;else break}for(b>>=I;b>0;){var T=s[n].s;p[T]<e?b-=1<<e-p[T]++-1:++n}for(;n>=0&&b;--n){var W=s[n].s;p[W]==e&&(--p[W],++b)}N=e}return{t:new cr(p),l:N}},fc=function(r,e,t){return r.s==-1?Math.max(fc(r.l,e,t+1),fc(r.r,e,t+1)):e[r.s]=t},Gu=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Ir(++e),n=0,i=r[0],s=1,l=function(d){t[n++]=d},u=1;u<=e;++u)if(r[u]==i&&u!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(i),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(i);s=1,i=r[u]}return{c:t.subarray(0,n),n:e}},ua=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},oh=function(r,e,t){var n=t.length,i=qc(e+2);r[i]=n&255,r[i+1]=n>>8,r[i+2]=r[i]^255,r[i+3]=r[i+1]^255;for(var s=0;s<n;++s)r[i+s+4]=t[s];return(i+4+n)*8},$u=function(r,e,t,n,i,s,l,u,d,m,g){Mn(e,g++,t),++i[256];for(var v=Wl(i,15),y=v.t,p=v.l,N=Wl(s,15),b=N.t,I=N.l,w=Gu(y),S=w.c,T=w.n,W=Gu(b),G=W.c,te=W.n,H=new Ir(19),M=0;M<S.length;++M)++H[S[M]&31];for(var M=0;M<G.length;++M)++H[G[M]&31];for(var Q=Wl(H,7),ce=Q.t,E=Q.l,_=19;_>4&&!ce[uc[_-1]];--_);var B=m+5<<3,q=ua(i,ci)+ua(s,ya)+l,ae=ua(i,y)+ua(s,b)+l+14+3*_+ua(H,ce)+2*H[16]+3*H[17]+7*H[18];if(d>=0&&B<=q&&B<=ae)return oh(e,g,r.subarray(d,d+m));var K,fe,se,me;if(Mn(e,g,1+(ae<q)),g+=2,ae<q){K=Nn(y,p,0),fe=y,se=Nn(b,I,0),me=b;var ee=Nn(ce,E,0);Mn(e,g,T-257),Mn(e,g+5,te-1),Mn(e,g+10,_-4),g+=14;for(var M=0;M<_;++M)Mn(e,g+3*M,ce[uc[M]]);g+=3*_;for(var Le=[S,G],k=0;k<2;++k)for(var R=Le[k],M=0;M<R.length;++M){var z=R[M]&31;Mn(e,g,ee[z]),g+=ce[z],z>15&&(Mn(e,g,R[M]>>5&127),g+=R[M]>>12)}}else K=o2,fe=ci,se=c2,me=ya;for(var M=0;M<u;++M){var Y=n[M];if(Y>255){var z=Y>>18&31;ca(e,g,K[z+257]),g+=fe[z+257],z>7&&(Mn(e,g,Y>>23&31),g+=Ko[z]);var ne=Y&31;ca(e,g,se[ne]),g+=me[ne],ne>3&&(ca(e,g,Y>>5&8191),g+=Yo[ne])}else ca(e,g,K[Y]),g+=fe[Y]}return ca(e,g,K[256]),g+fe[256]},f2=new Bc([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),lh=new cr(0),p2=function(r,e,t,n,i,s){var l=s.z||r.length,u=new cr(n+l+5*(1+Math.ceil(l/7e3))+i),d=u.subarray(n,u.length-i),m=s.l,g=(s.r||0)&7;if(e){g&&(d[0]=s.r>>3);for(var v=f2[e-1],y=v>>13,p=v&8191,N=(1<<t)-1,b=s.p||new Ir(32768),I=s.h||new Ir(N+1),w=Math.ceil(t/3),S=2*w,T=function(Ve){return(r[Ve]^r[Ve+1]<<w^r[Ve+2]<<S)&N},W=new Bc(25e3),G=new Ir(288),te=new Ir(32),H=0,M=0,Q=s.i||0,ce=0,E=s.w||0,_=0;Q+2<l;++Q){var B=T(Q),q=Q&32767,ae=I[B];if(b[q]=ae,I[B]=q,E<=Q){var K=l-Q;if((H>7e3||ce>24576)&&(K>423||!m)){g=$u(r,d,0,W,G,te,M,ce,_,Q-_,g),ce=H=M=0,_=Q;for(var fe=0;fe<286;++fe)G[fe]=0;for(var fe=0;fe<30;++fe)te[fe]=0}var se=2,me=0,ee=p,Le=q-ae&32767;if(K>2&&B==T(Q-Le))for(var k=Math.min(y,K)-1,R=Math.min(32767,Q),z=Math.min(258,K);Le<=R&&--ee&&q!=ae;){if(r[Q+se]==r[Q+se-Le]){for(var Y=0;Y<z&&r[Q+Y]==r[Q+Y-Le];++Y);if(Y>se){if(se=Y,me=Le,Y>k)break;for(var ne=Math.min(Le,Y-2),ue=0,fe=0;fe<ne;++fe){var de=Q-Le+fe&32767,he=b[de],Se=de-he&32767;Se>ue&&(ue=Se,ae=de)}}}q=ae,ae=b[q],Le+=q-ae&32767}if(me){W[ce++]=268435456|dc[se]<<18|Hu[me];var Ae=dc[se]&31,Ee=Hu[me]&31;M+=Ko[Ae]+Yo[Ee],++G[257+Ae],++te[Ee],E=Q+se,++H}else W[ce++]=r[Q],++G[r[Q]]}}for(Q=Math.max(Q,E);Q<l;++Q)W[ce++]=r[Q],++G[r[Q]];g=$u(r,d,m,W,G,te,M,ce,_,Q-_,g),m||(s.r=g&7|d[g/8|0]<<3,g-=7,s.h=I,s.p=b,s.i=Q,s.w=E)}else{for(var Q=s.w||0;Q<l+m;Q+=65535){var _e=Q+65535;_e>=l&&(d[g/8|0]=m,_e=l),g=oh(d,g+1,r.subarray(Q,_e))}s.i=l}return ah(u,0,n+qc(g)+i)},ch=function(){var r=1,e=0;return{p:function(t){for(var n=r,i=e,s=t.length|0,l=0;l!=s;){for(var u=Math.min(l+2655,s);l<u;++l)i+=n+=t[l];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}r=n,e=i},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},m2=function(r,e,t,n,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),l=new cr(s.length+r.length);l.set(s),l.set(r,s.length),r=l,i.w=s.length}return p2(r,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,n,i)},uh=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},g2=function(r,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var i=ch();i.p(e.dictionary),uh(r,2,i.d())}},v2=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&tn(6,"invalid zlib data"),(r[1]>>5&1)==+!e&&tn(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function pc(r,e){e||(e={});var t=ch();t.p(r);var n=m2(r,e,e.dictionary?6:2,4);return g2(n,e),uh(n,n.length-4,t.d()),n}function x2(r,e){return h2(r.subarray(v2(r,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}var y2=typeof TextDecoder<"u"&&new TextDecoder,b2=0;try{y2.decode(lh,{stream:!0}),b2=1}catch{}var He=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Hl(){He.console&&typeof He.console.log=="function"&&He.console.log.apply(He.console,arguments)}var Nt={log:Hl,warn:function(r){He.console&&(typeof He.console.warn=="function"?He.console.warn.apply(He.console,arguments):Hl.call(null,arguments))},error:function(r){He.console&&(typeof He.console.error=="function"?He.console.error.apply(He.console,arguments):Hl(r))}};function Gl(r,e,t){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){Si(n.response,e,t)},n.onerror=function(){Nt.error("could not download file")},n.send()}function Ku(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function mo(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var xa,mc,Si=He.saveAs||((typeof window>"u"?"undefined":vt(window))!=="object"||window!==He?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var n=He.URL||He.webkitURL,i=document.createElement("a");e=e||r.name||"download",i.download=e,i.rel="noopener",typeof r=="string"?(i.href=r,i.origin!==location.origin?Ku(i.href)?Gl(r,e,t):mo(i,i.target="_blank"):mo(i)):(i.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){mo(i)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(Ku(r))Gl(r,e,t);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){mo(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:vt(s)!=="object"&&(Nt.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob([String.fromCharCode(65279),i],{type:i.type}):i}(r,t),e)}:function(r,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return Gl(r,e,t);var i=r.type==="application/octet-stream",s=/constructor/i.test(He.HTMLElement)||He.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||i&&s)&&(typeof FileReader>"u"?"undefined":vt(FileReader))==="object"){var u=new FileReader;u.onloadend=function(){var g=u.result;g=l?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=g:location=g,n=null},u.readAsDataURL(r)}else{var d=He.URL||He.webkitURL,m=d.createObjectURL(r);n?n.location=m:location.href=m,n=null,setTimeout(function(){d.revokeObjectURL(m)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function dh(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(u){return[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(u){return[parseInt(u[1]+u[1],16),parseInt(u[2]+u[2],16),parseInt(u[3]+u[3],16)]}}],n=0;n<t.length;n++){var i=t[n].re,s=t[n].process,l=i.exec(r);l&&(e=s(l),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var u=this.r.toString(16),d=this.g.toString(16),m=this.b.toString(16);return u.length==1&&(u="0"+u),d.length==1&&(d="0"+d),m.length==1&&(m="0"+m),"#"+u+d+m}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function $l(r,e){var t=r[0],n=r[1],i=r[2],s=r[3];t=ir(t,n,i,s,e[0],7,-680876936),s=ir(s,t,n,i,e[1],12,-389564586),i=ir(i,s,t,n,e[2],17,606105819),n=ir(n,i,s,t,e[3],22,-1044525330),t=ir(t,n,i,s,e[4],7,-176418897),s=ir(s,t,n,i,e[5],12,1200080426),i=ir(i,s,t,n,e[6],17,-1473231341),n=ir(n,i,s,t,e[7],22,-45705983),t=ir(t,n,i,s,e[8],7,1770035416),s=ir(s,t,n,i,e[9],12,-1958414417),i=ir(i,s,t,n,e[10],17,-42063),n=ir(n,i,s,t,e[11],22,-1990404162),t=ir(t,n,i,s,e[12],7,1804603682),s=ir(s,t,n,i,e[13],12,-40341101),i=ir(i,s,t,n,e[14],17,-1502002290),t=sr(t,n=ir(n,i,s,t,e[15],22,1236535329),i,s,e[1],5,-165796510),s=sr(s,t,n,i,e[6],9,-1069501632),i=sr(i,s,t,n,e[11],14,643717713),n=sr(n,i,s,t,e[0],20,-373897302),t=sr(t,n,i,s,e[5],5,-701558691),s=sr(s,t,n,i,e[10],9,38016083),i=sr(i,s,t,n,e[15],14,-660478335),n=sr(n,i,s,t,e[4],20,-405537848),t=sr(t,n,i,s,e[9],5,568446438),s=sr(s,t,n,i,e[14],9,-1019803690),i=sr(i,s,t,n,e[3],14,-187363961),n=sr(n,i,s,t,e[8],20,1163531501),t=sr(t,n,i,s,e[13],5,-1444681467),s=sr(s,t,n,i,e[2],9,-51403784),i=sr(i,s,t,n,e[7],14,1735328473),t=ar(t,n=sr(n,i,s,t,e[12],20,-1926607734),i,s,e[5],4,-378558),s=ar(s,t,n,i,e[8],11,-2022574463),i=ar(i,s,t,n,e[11],16,1839030562),n=ar(n,i,s,t,e[14],23,-35309556),t=ar(t,n,i,s,e[1],4,-1530992060),s=ar(s,t,n,i,e[4],11,1272893353),i=ar(i,s,t,n,e[7],16,-155497632),n=ar(n,i,s,t,e[10],23,-1094730640),t=ar(t,n,i,s,e[13],4,681279174),s=ar(s,t,n,i,e[0],11,-358537222),i=ar(i,s,t,n,e[3],16,-722521979),n=ar(n,i,s,t,e[6],23,76029189),t=ar(t,n,i,s,e[9],4,-640364487),s=ar(s,t,n,i,e[12],11,-421815835),i=ar(i,s,t,n,e[15],16,530742520),t=or(t,n=ar(n,i,s,t,e[2],23,-995338651),i,s,e[0],6,-198630844),s=or(s,t,n,i,e[7],10,1126891415),i=or(i,s,t,n,e[14],15,-1416354905),n=or(n,i,s,t,e[5],21,-57434055),t=or(t,n,i,s,e[12],6,1700485571),s=or(s,t,n,i,e[3],10,-1894986606),i=or(i,s,t,n,e[10],15,-1051523),n=or(n,i,s,t,e[1],21,-2054922799),t=or(t,n,i,s,e[8],6,1873313359),s=or(s,t,n,i,e[15],10,-30611744),i=or(i,s,t,n,e[6],15,-1560198380),n=or(n,i,s,t,e[13],21,1309151649),t=or(t,n,i,s,e[4],6,-145523070),s=or(s,t,n,i,e[11],10,-1120210379),i=or(i,s,t,n,e[2],15,718787259),n=or(n,i,s,t,e[9],21,-343485551),r[0]=si(t,r[0]),r[1]=si(n,r[1]),r[2]=si(i,r[2]),r[3]=si(s,r[3])}function Jo(r,e,t,n,i,s){return e=si(si(e,r),si(n,s)),si(e<<i|e>>>32-i,t)}function ir(r,e,t,n,i,s,l){return Jo(e&t|~e&n,r,e,i,s,l)}function sr(r,e,t,n,i,s,l){return Jo(e&n|t&~n,r,e,i,s,l)}function ar(r,e,t,n,i,s,l){return Jo(e^t^n,r,e,i,s,l)}function or(r,e,t,n,i,s,l){return Jo(t^(e|~n),r,e,i,s,l)}function hh(r){var e,t=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)$l(n,w2(r.substring(e-64,e)));r=r.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)i[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for($l(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*t,$l(n,i),n}function w2(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}xa=He.atob.bind(He),mc=He.btoa.bind(He);var Yu="0123456789abcdef".split("");function N2(r){for(var e="",t=0;t<4;t++)e+=Yu[r>>8*t+4&15]+Yu[r>>8*t&15];return e}function j2(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function gc(r){return hh(r).map(j2).join("")}var A2=function(r){for(var e=0;e<r.length;e++)r[e]=N2(r[e]);return r.join("")}(hh("hello"))!="5d41402abc4b2a76b9719d911017c592";function si(r,e){if(A2){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function vc(r,e){var t,n,i,s;if(r!==t){for(var l=(i=r,s=1+(256/r.length>>0),new Array(s+1).join(i)),u=[],d=0;d<256;d++)u[d]=d;var m=0;for(d=0;d<256;d++){var g=u[d];m=(m+g+l.charCodeAt(d))%256,u[d]=u[m],u[m]=g}t=r,n=u}else u=n;var v=e.length,y=0,p=0,N="";for(d=0;d<v;d++)p=(p+(g=u[y=(y+1)%256]))%256,u[y]=u[p],u[p]=g,l=u[(u[y]+u[p])%256],N+=String.fromCharCode(e.charCodeAt(d)^l);return N}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Ju={print:4,modify:8,copy:16,"annot-forms":32};function hs(r,e,t,n){this.v=1,this.r=2;var i=192;r.forEach(function(u){if(Ju.perm!==void 0)throw new Error("Invalid permission: "+u);i+=Ju[u]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(e+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^i)),this.encryptionKey=gc(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=vc(this.encryptionKey,this.padding)}function fs(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,n=0;n<t;n++){var i=r.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=r[n]}return e}function Xu(r){if(vt(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,i){if(i=i||!1,typeof t!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[n,!!i],s},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in e[t]){var l=e[t][s];try{l[0].apply(r,n)}catch(u){He.console&&Nt.error("jsPDF PubSub Error",u.message,u)}l[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Ro(r){if(!(this instanceof Ro))return new Ro(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function fh(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function Li(r,e,t,n,i){if(!(this instanceof Li))return new Li(r,e,t,n,i);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,fh.call(this,n,i)}function gs(r,e,t,n,i){if(!(this instanceof gs))return new gs(r,e,t,n,i);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,fh.call(this,n,i)}function We(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],l=[],u=1,d=16,m="S",g=null;vt(r=r||{})==="object"&&(t=r.orientation,n=r.unit||n,i=r.format||i,s=r.compress||r.compressPdf||s,(g=r.encryption||null)!==null&&(g.userPassword=g.userPassword||"",g.ownerPassword=g.ownerPassword||"",g.userPermissions=g.userPermissions||[]),u=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(d=r.floatPrecision),m=r.defaultPathOperation||"S"),l=r.filters||(s===!0?["FlateEncode"]:l),n=n||"mm",t=(""+(t||"P")).toLowerCase();var v=r.putOnlyUsedFonts||!1,y={},p={internal:{},__private__:{}};p.__private__.PubSub=Xu;var N="1.3",b=p.__private__.getPdfVersion=function(){return N};p.__private__.setPdfVersion=function(h){N=h};var I={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return I};var w=p.__private__.getPageFormat=function(h){return I[h]};i=i||"a4";var S={COMPAT:"compat",ADVANCED:"advanced"},T=S.COMPAT;function W(){this.saveGraphicsState(),U(new Ue(Te,0,0,-Te,0,Hn()*Te).toString()+" cm"),this.setFontSize(this.getFontSize()/Te),m="n",T=S.ADVANCED}function G(){this.restoreGraphicsState(),m="S",T=S.COMPAT}var te=p.__private__.combineFontStyleAndFontWeight=function(h,A){if(h=="bold"&&A=="normal"||h=="bold"&&A==400||h=="normal"&&A=="italic"||h=="bold"&&A=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return A&&(h=A==400||A==="normal"?h==="italic"?"italic":"normal":A!=700&&A!=="bold"||h!=="normal"?(A==700?"bold":A)+""+h:"bold"),h};p.advancedAPI=function(h){var A=T===S.COMPAT;return A&&W.call(this),typeof h!="function"||(h(this),A&&G.call(this)),this},p.compatAPI=function(h){var A=T===S.ADVANCED;return A&&G.call(this),typeof h!="function"||(h(this),A&&W.call(this)),this},p.isAdvancedAPI=function(){return T===S.ADVANCED};var H,M=function(h){if(T!==S.ADVANCED)throw new Error(h+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Q=p.roundToPrecision=p.__private__.roundToPrecision=function(h,A){var F=e||A;if(isNaN(h)||isNaN(F))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return h.toFixed(F).replace(/0+$/,"")};H=p.hpf=p.__private__.hpf=typeof d=="number"?function(h){if(isNaN(h))throw new Error("Invalid argument passed to jsPDF.hpf");return Q(h,d)}:d==="smart"?function(h){if(isNaN(h))throw new Error("Invalid argument passed to jsPDF.hpf");return Q(h,h>-1&&h<1?16:5)}:function(h){if(isNaN(h))throw new Error("Invalid argument passed to jsPDF.hpf");return Q(h,16)};var ce=p.f2=p.__private__.f2=function(h){if(isNaN(h))throw new Error("Invalid argument passed to jsPDF.f2");return Q(h,2)},E=p.__private__.f3=function(h){if(isNaN(h))throw new Error("Invalid argument passed to jsPDF.f3");return Q(h,3)},_=p.scale=p.__private__.scale=function(h){if(isNaN(h))throw new Error("Invalid argument passed to jsPDF.scale");return T===S.COMPAT?h*Te:T===S.ADVANCED?h:void 0},B=function(h){return T===S.COMPAT?Hn()-h:T===S.ADVANCED?h:void 0},q=function(h){return _(B(h))};p.__private__.setPrecision=p.setPrecision=function(h){typeof parseInt(h,10)=="number"&&(e=parseInt(h,10))};var ae,K="00000000000000000000000000000000",fe=p.__private__.getFileId=function(){return K},se=p.__private__.setFileId=function(h){return K=h!==void 0&&/^[a-fA-F0-9]{32}$/.test(h)?h.toUpperCase():K.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),g!==null&&(rr=new hs(g.userPermissions,g.userPassword,g.ownerPassword,K)),K};p.setFileId=function(h){return se(h),this},p.getFileId=function(){return fe()};var me=p.__private__.convertDateToPDFDate=function(h){var A=h.getTimezoneOffset(),F=A<0?"+":"-",$=Math.floor(Math.abs(A/60)),ie=Math.abs(A%60),ge=[F,z($),"'",z(ie),"'"].join("");return["D:",h.getFullYear(),z(h.getMonth()+1),z(h.getDate()),z(h.getHours()),z(h.getMinutes()),z(h.getSeconds()),ge].join("")},ee=p.__private__.convertPDFDateToDate=function(h){var A=parseInt(h.substr(2,4),10),F=parseInt(h.substr(6,2),10)-1,$=parseInt(h.substr(8,2),10),ie=parseInt(h.substr(10,2),10),ge=parseInt(h.substr(12,2),10),Ne=parseInt(h.substr(14,2),10);return new Date(A,F,$,ie,ge,Ne,0)},Le=p.__private__.setCreationDate=function(h){var A;if(h===void 0&&(h=new Date),h instanceof Date)A=me(h);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(h))throw new Error("Invalid argument passed to jsPDF.setCreationDate");A=h}return ae=A},k=p.__private__.getCreationDate=function(h){var A=ae;return h==="jsDate"&&(A=ee(ae)),A};p.setCreationDate=function(h){return Le(h),this},p.getCreationDate=function(h){return k(h)};var R,z=p.__private__.padd2=function(h){return("0"+parseInt(h)).slice(-2)},Y=p.__private__.padd2Hex=function(h){return("00"+(h=h.toString())).substr(h.length)},ne=0,ue=[],de=[],he=0,Se=[],Ae=[],Ee=!1,_e=de,Ve=function(){ne=0,he=0,de=[],ue=[],Se=[],Pn=zt(),Hr=zt()};p.__private__.setCustomOutputDestination=function(h){Ee=!0,_e=h};var ve=function(h){Ee||(_e=h)};p.__private__.resetCustomOutputDestination=function(){Ee=!1,_e=de};var U=p.__private__.out=function(h){return h=h.toString(),he+=h.length+1,_e.push(h),_e},Ze=p.__private__.write=function(h){return U(arguments.length===1?h.toString():Array.prototype.join.call(arguments," "))},Me=p.__private__.getArrayBuffer=function(h){for(var A=h.length,F=new ArrayBuffer(A),$=new Uint8Array(F);A--;)$[A]=h.charCodeAt(A);return F},je=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return je};var Pe=r.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(h){return Pe=T===S.ADVANCED?h/Te:h,this};var Oe,Ie=p.__private__.getFontSize=p.getFontSize=function(){return T===S.COMPAT?Pe:Pe*Te},Be=r.R2L||!1;p.__private__.setR2L=p.setR2L=function(h){return Be=h,this},p.__private__.getR2L=p.getR2L=function(){return Be};var Ye,rt=p.__private__.setZoomMode=function(h){var A=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(h))Oe=h;else if(isNaN(h)){if(A.indexOf(h)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+h+'" is not recognized.');Oe=h}else Oe=parseInt(h,10)};p.__private__.getZoomMode=function(){return Oe};var nt,lt=p.__private__.setPageMode=function(h){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(h)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+h+'" is not recognized.');Ye=h};p.__private__.getPageMode=function(){return Ye};var xt=p.__private__.setLayoutMode=function(h){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(h)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+h+'" is not recognized.');nt=h};p.__private__.getLayoutMode=function(){return nt},p.__private__.setDisplayMode=p.setDisplayMode=function(h,A,F){return rt(h),xt(A),lt(F),this};var Ge={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(h){if(Object.keys(Ge).indexOf(h)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ge[h]},p.__private__.getDocumentProperties=function(){return Ge},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(h){for(var A in Ge)Ge.hasOwnProperty(A)&&h[A]&&(Ge[A]=h[A]);return this},p.__private__.setDocumentProperty=function(h,A){if(Object.keys(Ge).indexOf(h)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ge[h]=A};var it,Te,tr,ut,Ur,bt={},Lt={},on=[],ft={},di={},_t={},Vr={},Ln=null,Ct=0,Je=[],pt=new Xu(p),hi=r.hotfixes||[],Qt={},ln={},cn=[],Ue=function h(A,F,$,ie,ge,Ne){if(!(this instanceof h))return new h(A,F,$,ie,ge,Ne);isNaN(A)&&(A=1),isNaN(F)&&(F=0),isNaN($)&&($=0),isNaN(ie)&&(ie=1),isNaN(ge)&&(ge=0),isNaN(Ne)&&(Ne=0),this._matrix=[A,F,$,ie,ge,Ne]};Object.defineProperty(Ue.prototype,"sx",{get:function(){return this._matrix[0]},set:function(h){this._matrix[0]=h}}),Object.defineProperty(Ue.prototype,"shy",{get:function(){return this._matrix[1]},set:function(h){this._matrix[1]=h}}),Object.defineProperty(Ue.prototype,"shx",{get:function(){return this._matrix[2]},set:function(h){this._matrix[2]=h}}),Object.defineProperty(Ue.prototype,"sy",{get:function(){return this._matrix[3]},set:function(h){this._matrix[3]=h}}),Object.defineProperty(Ue.prototype,"tx",{get:function(){return this._matrix[4]},set:function(h){this._matrix[4]=h}}),Object.defineProperty(Ue.prototype,"ty",{get:function(){return this._matrix[5]},set:function(h){this._matrix[5]=h}}),Object.defineProperty(Ue.prototype,"a",{get:function(){return this._matrix[0]},set:function(h){this._matrix[0]=h}}),Object.defineProperty(Ue.prototype,"b",{get:function(){return this._matrix[1]},set:function(h){this._matrix[1]=h}}),Object.defineProperty(Ue.prototype,"c",{get:function(){return this._matrix[2]},set:function(h){this._matrix[2]=h}}),Object.defineProperty(Ue.prototype,"d",{get:function(){return this._matrix[3]},set:function(h){this._matrix[3]=h}}),Object.defineProperty(Ue.prototype,"e",{get:function(){return this._matrix[4]},set:function(h){this._matrix[4]=h}}),Object.defineProperty(Ue.prototype,"f",{get:function(){return this._matrix[5]},set:function(h){this._matrix[5]=h}}),Object.defineProperty(Ue.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ue.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ue.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ue.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ue.prototype.join=function(h){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(H).join(h)},Ue.prototype.multiply=function(h){var A=h.sx*this.sx+h.shy*this.shx,F=h.sx*this.shy+h.shy*this.sy,$=h.shx*this.sx+h.sy*this.shx,ie=h.shx*this.shy+h.sy*this.sy,ge=h.tx*this.sx+h.ty*this.shx+this.tx,Ne=h.tx*this.shy+h.ty*this.sy+this.ty;return new Ue(A,F,$,ie,ge,Ne)},Ue.prototype.decompose=function(){var h=this.sx,A=this.shy,F=this.shx,$=this.sy,ie=this.tx,ge=this.ty,Ne=Math.sqrt(h*h+A*A),De=(h/=Ne)*F+(A/=Ne)*$;F-=h*De,$-=A*De;var qe=Math.sqrt(F*F+$*$);return De/=qe,h*($/=qe)<A*(F/=qe)&&(h=-h,A=-A,De=-De,Ne=-Ne),{scale:new Ue(Ne,0,0,qe,0,0),translate:new Ue(1,0,0,1,ie,ge),rotate:new Ue(h,A,-A,h,0,0),skew:new Ue(1,0,De,1,0,0)}},Ue.prototype.toString=function(h){return this.join(" ")},Ue.prototype.inversed=function(){var h=this.sx,A=this.shy,F=this.shx,$=this.sy,ie=this.tx,ge=this.ty,Ne=1/(h*$-A*F),De=$*Ne,qe=-A*Ne,et=-F*Ne,Xe=h*Ne;return new Ue(De,qe,et,Xe,-De*ie-et*ge,-qe*ie-Xe*ge)},Ue.prototype.applyToPoint=function(h){var A=h.x*this.sx+h.y*this.shx+this.tx,F=h.x*this.shy+h.y*this.sy+this.ty;return new $i(A,F)},Ue.prototype.applyToRectangle=function(h){var A=this.applyToPoint(h),F=this.applyToPoint(new $i(h.x+h.w,h.y+h.h));return new Us(A.x,A.y,F.x-A.x,F.y-A.y)},Ue.prototype.clone=function(){var h=this.sx,A=this.shy,F=this.shx,$=this.sy,ie=this.tx,ge=this.ty;return new Ue(h,A,F,$,ie,ge)},p.Matrix=Ue;var Wr=p.matrixMult=function(h,A){return A.multiply(h)},un=new Ue(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=un;var mr=function(h,A){if(!di[h]){var F=(A instanceof Li?"Sh":"P")+(Object.keys(ft).length+1).toString(10);A.id=F,di[h]=F,ft[F]=A,pt.publish("addPattern",A)}};p.ShadingPattern=Li,p.TilingPattern=gs,p.addShadingPattern=function(h,A){return M("addShadingPattern()"),mr(h,A),this},p.beginTilingPattern=function(h){M("beginTilingPattern()"),qa(h.boundingBox[0],h.boundingBox[1],h.boundingBox[2]-h.boundingBox[0],h.boundingBox[3]-h.boundingBox[1],h.matrix)},p.endTilingPattern=function(h,A){M("endTilingPattern()"),A.stream=Ae[R].join(`
`),mr(h,A),pt.publish("endTilingPattern",A),cn.pop().restore()};var Gt=p.__private__.newObject=function(){var h=zt();return Ar(h,!0),h},zt=p.__private__.newObjectDeferred=function(){return ne++,ue[ne]=function(){return he},ne},Ar=function(h,A){return A=typeof A=="boolean"&&A,ue[h]=he,A&&U(h+" 0 obj"),h},Ti=p.__private__.newAdditionalObject=function(){var h={objId:zt(),content:""};return Se.push(h),h},Pn=zt(),Hr=zt(),Gr=p.__private__.decodeColorString=function(h){var A=h.split(" ");if(A.length!==2||A[1]!=="g"&&A[1]!=="G")A.length===5&&(A[4]==="k"||A[4]==="K")&&(A=[(1-A[0])*(1-A[3]),(1-A[1])*(1-A[3]),(1-A[2])*(1-A[3]),"r"]);else{var F=parseFloat(A[0]);A=[F,F,F,"r"]}for(var $="#",ie=0;ie<3;ie++)$+=("0"+Math.floor(255*parseFloat(A[ie])).toString(16)).slice(-2);return $},$r=p.__private__.encodeColorString=function(h){var A;typeof h=="string"&&(h={ch1:h});var F=h.ch1,$=h.ch2,ie=h.ch3,ge=h.ch4,Ne=h.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof F=="string"&&F.charAt(0)!=="#"){var De=new dh(F);if(De.ok)F=De.toHex();else if(!/^\d*\.?\d*$/.test(F))throw new Error('Invalid color "'+F+'" passed to jsPDF.encodeColorString.')}if(typeof F=="string"&&/^#[0-9A-Fa-f]{3}$/.test(F)&&(F="#"+F[1]+F[1]+F[2]+F[2]+F[3]+F[3]),typeof F=="string"&&/^#[0-9A-Fa-f]{6}$/.test(F)){var qe=parseInt(F.substr(1),16);F=qe>>16&255,$=qe>>8&255,ie=255&qe}if($===void 0||ge===void 0&&F===$&&$===ie)if(typeof F=="string")A=F+" "+Ne[0];else switch(h.precision){case 2:A=ce(F/255)+" "+Ne[0];break;case 3:default:A=E(F/255)+" "+Ne[0]}else if(ge===void 0||vt(ge)==="object"){if(ge&&!isNaN(ge.a)&&ge.a===0)return A=["1.","1.","1.",Ne[1]].join(" ");if(typeof F=="string")A=[F,$,ie,Ne[1]].join(" ");else switch(h.precision){case 2:A=[ce(F/255),ce($/255),ce(ie/255),Ne[1]].join(" ");break;default:case 3:A=[E(F/255),E($/255),E(ie/255),Ne[1]].join(" ")}}else if(typeof F=="string")A=[F,$,ie,ge,Ne[2]].join(" ");else switch(h.precision){case 2:A=[ce(F),ce($),ce(ie),ce(ge),Ne[2]].join(" ");break;case 3:default:A=[E(F),E($),E(ie),E(ge),Ne[2]].join(" ")}return A},dn=p.__private__.getFilters=function(){return l},Er=p.__private__.putStream=function(h){var A=(h=h||{}).data||"",F=h.filters||dn(),$=h.alreadyAppliedFilters||[],ie=h.addLength1||!1,ge=A.length,Ne=h.objectId,De=function(nr){return nr};if(g!==null&&Ne===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");g!==null&&(De=rr.encryptor(Ne,0));var qe={};F===!0&&(F=["FlateEncode"]);var et=h.additionalKeyValues||[],Xe=(qe=We.API.processDataByFilters!==void 0?We.API.processDataByFilters(A,F):{data:A,reverseChain:[]}).reverseChain+(Array.isArray($)?$.join(" "):$.toString());if(qe.data.length!==0&&(et.push({key:"Length",value:qe.data.length}),ie===!0&&et.push({key:"Length1",value:ge})),Xe.length!=0)if(Xe.split("/").length-1==1)et.push({key:"Filter",value:Xe});else{et.push({key:"Filter",value:"["+Xe+"]"});for(var ot=0;ot<et.length;ot+=1)if(et[ot].key==="DecodeParms"){for(var kt=[],It=0;It<qe.reverseChain.split("/").length-1;It+=1)kt.push("null");kt.push(et[ot].value),et[ot].value="["+kt.join(" ")+"]"}}U("<<");for(var Ut=0;Ut<et.length;Ut++)U("/"+et[Ut].key+" "+et[Ut].value);U(">>"),qe.data.length!==0&&(U("stream"),U(De(qe.data)),U("endstream"))},hn=p.__private__.putPage=function(h){var A=h.number,F=h.data,$=h.objId,ie=h.contentsObjId;Ar($,!0),U("<</Type /Page"),U("/Parent "+h.rootDictionaryObjId+" 0 R"),U("/Resources "+h.resourceDictionaryObjId+" 0 R"),U("/MediaBox ["+parseFloat(H(h.mediaBox.bottomLeftX))+" "+parseFloat(H(h.mediaBox.bottomLeftY))+" "+H(h.mediaBox.topRightX)+" "+H(h.mediaBox.topRightY)+"]"),h.cropBox!==null&&U("/CropBox ["+H(h.cropBox.bottomLeftX)+" "+H(h.cropBox.bottomLeftY)+" "+H(h.cropBox.topRightX)+" "+H(h.cropBox.topRightY)+"]"),h.bleedBox!==null&&U("/BleedBox ["+H(h.bleedBox.bottomLeftX)+" "+H(h.bleedBox.bottomLeftY)+" "+H(h.bleedBox.topRightX)+" "+H(h.bleedBox.topRightY)+"]"),h.trimBox!==null&&U("/TrimBox ["+H(h.trimBox.bottomLeftX)+" "+H(h.trimBox.bottomLeftY)+" "+H(h.trimBox.topRightX)+" "+H(h.trimBox.topRightY)+"]"),h.artBox!==null&&U("/ArtBox ["+H(h.artBox.bottomLeftX)+" "+H(h.artBox.bottomLeftY)+" "+H(h.artBox.topRightX)+" "+H(h.artBox.topRightY)+"]"),typeof h.userUnit=="number"&&h.userUnit!==1&&U("/UserUnit "+h.userUnit),pt.publish("putPage",{objId:$,pageContext:Je[A],pageNumber:A,page:F}),U("/Contents "+ie+" 0 R"),U(">>"),U("endobj");var ge=F.join(`
`);return T===S.ADVANCED&&(ge+=`
Q`),Ar(ie,!0),Er({data:ge,filters:dn(),objectId:ie}),U("endobj"),$},fi=p.__private__.putPages=function(){var h,A,F=[];for(h=1;h<=Ct;h++)Je[h].objId=zt(),Je[h].contentsObjId=zt();for(h=1;h<=Ct;h++)F.push(hn({number:h,data:Ae[h],objId:Je[h].objId,contentsObjId:Je[h].contentsObjId,mediaBox:Je[h].mediaBox,cropBox:Je[h].cropBox,bleedBox:Je[h].bleedBox,trimBox:Je[h].trimBox,artBox:Je[h].artBox,userUnit:Je[h].userUnit,rootDictionaryObjId:Pn,resourceDictionaryObjId:Hr}));Ar(Pn,!0),U("<</Type /Pages");var $="/Kids [";for(A=0;A<Ct;A++)$+=F[A]+" 0 R ";U($+"]"),U("/Count "+Ct),U(">>"),U("endobj"),pt.publish("postPutPages")},Di=function(h){pt.publish("putFont",{font:h,out:U,newObject:Gt,putStream:Er}),h.isAlreadyPutted!==!0&&(h.objectNumber=Gt(),U("<<"),U("/Type /Font"),U("/BaseFont /"+fs(h.postScriptName)),U("/Subtype /Type1"),typeof h.encoding=="string"&&U("/Encoding /"+h.encoding),U("/FirstChar 32"),U("/LastChar 255"),U(">>"),U("endobj"))},Ri=function(){for(var h in bt)bt.hasOwnProperty(h)&&(v===!1||v===!0&&y.hasOwnProperty(h))&&Di(bt[h])},Fi=function(h){h.objectNumber=Gt();var A=[];A.push({key:"Type",value:"/XObject"}),A.push({key:"Subtype",value:"/Form"}),A.push({key:"BBox",value:"["+[H(h.x),H(h.y),H(h.x+h.width),H(h.y+h.height)].join(" ")+"]"}),A.push({key:"Matrix",value:"["+h.matrix.toString()+"]"});var F=h.pages[1].join(`
`);Er({data:F,additionalKeyValues:A,objectId:h.objectNumber}),U("endobj")},Mi=function(){for(var h in Qt)Qt.hasOwnProperty(h)&&Fi(Qt[h])},Na=function(h,A){var F,$=[],ie=1/(A-1);for(F=0;F<1;F+=ie)$.push(F);if($.push(1),h[0].offset!=0){var ge={offset:0,color:h[0].color};h.unshift(ge)}if(h[h.length-1].offset!=1){var Ne={offset:1,color:h[h.length-1].color};h.push(Ne)}for(var De="",qe=0,et=0;et<$.length;et++){for(F=$[et];F>h[qe+1].offset;)qe++;var Xe=h[qe].offset,ot=(F-Xe)/(h[qe+1].offset-Xe),kt=h[qe].color,It=h[qe+1].color;De+=Y(Math.round((1-ot)*kt[0]+ot*It[0]).toString(16))+Y(Math.round((1-ot)*kt[1]+ot*It[1]).toString(16))+Y(Math.round((1-ot)*kt[2]+ot*It[2]).toString(16))}return De.trim()},Zo=function(h,A){A||(A=21);var F=Gt(),$=Na(h.colors,A),ie=[];ie.push({key:"FunctionType",value:"0"}),ie.push({key:"Domain",value:"[0.0 1.0]"}),ie.push({key:"Size",value:"["+A+"]"}),ie.push({key:"BitsPerSample",value:"8"}),ie.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ie.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Er({data:$,additionalKeyValues:ie,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:F}),U("endobj"),h.objectNumber=Gt(),U("<< /ShadingType "+h.type),U("/ColorSpace /DeviceRGB");var ge="/Coords ["+H(parseFloat(h.coords[0]))+" "+H(parseFloat(h.coords[1]))+" ";h.type===2?ge+=H(parseFloat(h.coords[2]))+" "+H(parseFloat(h.coords[3])):ge+=H(parseFloat(h.coords[2]))+" "+H(parseFloat(h.coords[3]))+" "+H(parseFloat(h.coords[4]))+" "+H(parseFloat(h.coords[5])),U(ge+="]"),h.matrix&&U("/Matrix ["+h.matrix.toString()+"]"),U("/Function "+F+" 0 R"),U("/Extend [true true]"),U(">>"),U("endobj")},el=function(h,A){var F=zt(),$=Gt();A.push({resourcesOid:F,objectOid:$}),h.objectNumber=$;var ie=[];ie.push({key:"Type",value:"/Pattern"}),ie.push({key:"PatternType",value:"1"}),ie.push({key:"PaintType",value:"1"}),ie.push({key:"TilingType",value:"1"}),ie.push({key:"BBox",value:"["+h.boundingBox.map(H).join(" ")+"]"}),ie.push({key:"XStep",value:H(h.xStep)}),ie.push({key:"YStep",value:H(h.yStep)}),ie.push({key:"Resources",value:F+" 0 R"}),h.matrix&&ie.push({key:"Matrix",value:"["+h.matrix.toString()+"]"}),Er({data:h.stream,additionalKeyValues:ie,objectId:h.objectNumber}),U("endobj")},Bi=function(h){var A;for(A in ft)ft.hasOwnProperty(A)&&(ft[A]instanceof Li?Zo(ft[A]):ft[A]instanceof gs&&el(ft[A],h))},ja=function(h){for(var A in h.objectNumber=Gt(),U("<<"),h)switch(A){case"opacity":U("/ca "+ce(h[A]));break;case"stroke-opacity":U("/CA "+ce(h[A]))}U(">>"),U("endobj")},tl=function(){var h;for(h in _t)_t.hasOwnProperty(h)&&ja(_t[h])},Es=function(){for(var h in U("/XObject <<"),Qt)Qt.hasOwnProperty(h)&&Qt[h].objectNumber>=0&&U("/"+h+" "+Qt[h].objectNumber+" 0 R");pt.publish("putXobjectDict"),U(">>")},rl=function(){rr.oid=Gt(),U("<<"),U("/Filter /Standard"),U("/V "+rr.v),U("/R "+rr.r),U("/U <"+rr.toHexString(rr.U)+">"),U("/O <"+rr.toHexString(rr.O)+">"),U("/P "+rr.P),U(">>"),U("endobj")},Aa=function(){for(var h in U("/Font <<"),bt)bt.hasOwnProperty(h)&&(v===!1||v===!0&&y.hasOwnProperty(h))&&U("/"+h+" "+bt[h].objectNumber+" 0 R");U(">>")},nl=function(){if(Object.keys(ft).length>0){for(var h in U("/Shading <<"),ft)ft.hasOwnProperty(h)&&ft[h]instanceof Li&&ft[h].objectNumber>=0&&U("/"+h+" "+ft[h].objectNumber+" 0 R");pt.publish("putShadingPatternDict"),U(">>")}},qi=function(h){if(Object.keys(ft).length>0){for(var A in U("/Pattern <<"),ft)ft.hasOwnProperty(A)&&ft[A]instanceof p.TilingPattern&&ft[A].objectNumber>=0&&ft[A].objectNumber<h&&U("/"+A+" "+ft[A].objectNumber+" 0 R");pt.publish("putTilingPatternDict"),U(">>")}},il=function(){if(Object.keys(_t).length>0){var h;for(h in U("/ExtGState <<"),_t)_t.hasOwnProperty(h)&&_t[h].objectNumber>=0&&U("/"+h+" "+_t[h].objectNumber+" 0 R");pt.publish("putGStateDict"),U(">>")}},Dt=function(h){Ar(h.resourcesOid,!0),U("<<"),U("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Aa(),nl(),qi(h.objectOid),il(),Es(),U(">>"),U("endobj")},Sa=function(){var h=[];Ri(),tl(),Mi(),Bi(h),pt.publish("putResources"),h.forEach(Dt),Dt({resourcesOid:Hr,objectOid:Number.MAX_SAFE_INTEGER}),pt.publish("postPutResources")},La=function(){pt.publish("putAdditionalObjects");for(var h=0;h<Se.length;h++){var A=Se[h];Ar(A.objId,!0),U(A.content),U("endobj")}pt.publish("postPutAdditionalObjects")},Pa=function(h){Lt[h.fontName]=Lt[h.fontName]||{},Lt[h.fontName][h.fontStyle]=h.id},Os=function(h,A,F,$,ie){var ge={id:"F"+(Object.keys(bt).length+1).toString(10),postScriptName:h,fontName:A,fontStyle:F,encoding:$,isStandardFont:ie||!1,metadata:{}};return pt.publish("addFont",{font:ge,instance:this}),bt[ge.id]=ge,Pa(ge),ge.id},sl=function(h){for(var A=0,F=je.length;A<F;A++){var $=Os.call(this,h[A][0],h[A][1],h[A][2],je[A][3],!0);v===!1&&(y[$]=!0);var ie=h[A][0].split("-");Pa({id:$,fontName:ie[0],fontStyle:ie[1]||""})}pt.publish("addFonts",{fonts:bt,dictionary:Lt})},Kr=function(h){return h.foo=function(){try{return h.apply(this,arguments)}catch($){var A=$.stack||"";~A.indexOf(" at ")&&(A=A.split(" at ")[1]);var F="Error in function "+A.split(`
`)[0].split("<")[0]+": "+$.message;if(!He.console)throw new Error(F);He.console.error(F,$),He.alert&&alert(F)}},h.foo.bar=h,h.foo},zi=function(h,A){var F,$,ie,ge,Ne,De,qe,et,Xe;if(ie=(A=A||{}).sourceEncoding||"Unicode",Ne=A.outputEncoding,(A.autoencode||Ne)&&bt[it].metadata&&bt[it].metadata[ie]&&bt[it].metadata[ie].encoding&&(ge=bt[it].metadata[ie].encoding,!Ne&&bt[it].encoding&&(Ne=bt[it].encoding),!Ne&&ge.codePages&&(Ne=ge.codePages[0]),typeof Ne=="string"&&(Ne=ge[Ne]),Ne)){for(qe=!1,De=[],F=0,$=h.length;F<$;F++)(et=Ne[h.charCodeAt(F)])?De.push(String.fromCharCode(et)):De.push(h[F]),De[F].charCodeAt(0)>>8&&(qe=!0);h=De.join("")}for(F=h.length;qe===void 0&&F!==0;)h.charCodeAt(F-1)>>8&&(qe=!0),F--;if(!qe)return h;for(De=A.noBOM?[]:[254,255],F=0,$=h.length;F<$;F++){if((Xe=(et=h.charCodeAt(F))>>8)>>8)throw new Error("Character at position "+F+" of string '"+h+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");De.push(Xe),De.push(et-(Xe<<8))}return String.fromCharCode.apply(void 0,De)},gr=p.__private__.pdfEscape=p.pdfEscape=function(h,A){return zi(h,A).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ts=p.__private__.beginPage=function(h){Ae[++Ct]=[],Je[Ct]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(h[0]),topRightY:Number(h[1])}},_a(Ct),ve(Ae[R])},ka=function(h,A){var F,$,ie;switch(t=A||t,typeof h=="string"&&(F=w(h.toLowerCase()),Array.isArray(F)&&($=F[0],ie=F[1])),Array.isArray(h)&&($=h[0]*Te,ie=h[1]*Te),isNaN($)&&($=i[0],ie=i[1]),($>14400||ie>14400)&&(Nt.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),$=Math.min(14400,$),ie=Math.min(14400,ie)),i=[$,ie],t.substr(0,1)){case"l":ie>$&&(i=[ie,$]);break;case"p":$>ie&&(i=[ie,$])}Ts(i),Da(Ms),U(Yr),qs!==0&&U(qs+" J"),zs!==0&&U(zs+" j"),pt.publish("addPage",{pageNumber:Ct})},al=function(h){h>0&&h<=Ct&&(Ae.splice(h,1),Je.splice(h,1),Ct--,R>Ct&&(R=Ct),this.setPage(R))},_a=function(h){h>0&&h<=Ct&&(R=h)},ol=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Ae.length-1},Ca=function(h,A,F){var $,ie=void 0;return F=F||{},h=h!==void 0?h:bt[it].fontName,A=A!==void 0?A:bt[it].fontStyle,$=h.toLowerCase(),Lt[$]!==void 0&&Lt[$][A]!==void 0?ie=Lt[$][A]:Lt[h]!==void 0&&Lt[h][A]!==void 0?ie=Lt[h][A]:F.disableWarning===!1&&Nt.warn("Unable to look up font label for font '"+h+"', '"+A+"'. Refer to getFontList() for available fonts."),ie||F.noFallback||(ie=Lt.times[A])==null&&(ie=Lt.times.normal),ie},ll=p.__private__.putInfo=function(){var h=Gt(),A=function($){return $};for(var F in g!==null&&(A=rr.encryptor(h,0)),U("<<"),U("/Producer ("+gr(A("jsPDF "+We.version))+")"),Ge)Ge.hasOwnProperty(F)&&Ge[F]&&U("/"+F.substr(0,1).toUpperCase()+F.substr(1)+" ("+gr(A(Ge[F]))+")");U("/CreationDate ("+gr(A(ae))+")"),U(">>"),U("endobj")},Ds=p.__private__.putCatalog=function(h){var A=(h=h||{}).rootDictionaryObjId||Pn;switch(Gt(),U("<<"),U("/Type /Catalog"),U("/Pages "+A+" 0 R"),Oe||(Oe="fullwidth"),Oe){case"fullwidth":U("/OpenAction [3 0 R /FitH null]");break;case"fullheight":U("/OpenAction [3 0 R /FitV null]");break;case"fullpage":U("/OpenAction [3 0 R /Fit]");break;case"original":U("/OpenAction [3 0 R /XYZ null null 1]");break;default:var F=""+Oe;F.substr(F.length-1)==="%"&&(Oe=parseInt(Oe)/100),typeof Oe=="number"&&U("/OpenAction [3 0 R /XYZ null null "+ce(Oe)+"]")}switch(nt||(nt="continuous"),nt){case"continuous":U("/PageLayout /OneColumn");break;case"single":U("/PageLayout /SinglePage");break;case"two":case"twoleft":U("/PageLayout /TwoColumnLeft");break;case"tworight":U("/PageLayout /TwoColumnRight")}Ye&&U("/PageMode /"+Ye),pt.publish("putCatalog"),U(">>"),U("endobj")},cl=p.__private__.putTrailer=function(){U("trailer"),U("<<"),U("/Size "+(ne+1)),U("/Root "+ne+" 0 R"),U("/Info "+(ne-1)+" 0 R"),g!==null&&U("/Encrypt "+rr.oid+" 0 R"),U("/ID [ <"+K+"> <"+K+"> ]"),U(">>")},ul=p.__private__.putHeader=function(){U("%PDF-"+N),U("%ºß¬à")},dl=p.__private__.putXRef=function(){var h="0000000000";U("xref"),U("0 "+(ne+1)),U("0000000000 65535 f ");for(var A=1;A<=ne;A++)typeof ue[A]=="function"?U((h+ue[A]()).slice(-10)+" 00000 n "):ue[A]!==void 0?U((h+ue[A]).slice(-10)+" 00000 n "):U("0000000000 00000 n ")},kn=p.__private__.buildDocument=function(){Ve(),ve(de),pt.publish("buildDocument"),ul(),fi(),La(),Sa(),g!==null&&rl(),ll(),Ds();var h=he;return dl(),cl(),U("startxref"),U(""+h),U("%%EOF"),ve(Ae[R]),de.join(`
`)},Ui=p.__private__.getBlob=function(h){return new Blob([Me(h)],{type:"application/pdf"})},Vi=p.output=p.__private__.output=Kr(function(h,A){switch(typeof(A=A||{})=="string"?A={filename:A}:A.filename=A.filename||"generated.pdf",h){case void 0:return kn();case"save":p.save(A.filename);break;case"arraybuffer":return Me(kn());case"blob":return Ui(kn());case"bloburi":case"bloburl":if(He.URL!==void 0&&typeof He.URL.createObjectURL=="function")return He.URL&&He.URL.createObjectURL(Ui(kn()))||void 0;Nt.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var F="",$=kn();try{F=mc($)}catch{F=mc(unescape(encodeURIComponent($)))}return"data:application/pdf;filename="+A.filename+";base64,"+F;case"pdfobjectnewwindow":if(Object.prototype.toString.call(He)==="[object Window]"){var ie="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ge=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';A.pdfObjectUrl&&(ie=A.pdfObjectUrl,ge="");var Ne='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ie+'"'+ge+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(A)+");<\/script></body></html>",De=He.open();return De!==null&&De.document.write(Ne),De}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(He)==="[object Window]"){var qe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(A.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+A.filename+'" width="500px" height="400px" /></body></html>',et=He.open();if(et!==null){et.document.write(qe);var Xe=this;et.document.documentElement.querySelector("#pdfViewer").onload=function(){et.document.title=A.filename,et.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Xe.output("bloburl"))}}return et}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(He)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ot='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",A)+'"></iframe></body></html>',kt=He.open();if(kt!==null&&(kt.document.write(ot),kt.document.title=A.filename),kt||typeof safari>"u")return kt;break;case"datauri":case"dataurl":return He.document.location.href=this.output("datauristring",A);default:return null}}),Ia=function(h){return Array.isArray(hi)===!0&&hi.indexOf(h)>-1};switch(n){case"pt":Te=1;break;case"mm":Te=72/25.4;break;case"cm":Te=72/2.54;break;case"in":Te=72;break;case"px":Te=Ia("px_scaling")==1?.75:96/72;break;case"pc":case"em":Te=12;break;case"ex":Te=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Te=n}var rr=null;Le(),se();var hl=function(h){return g!==null?rr.encryptor(h,0):function(A){return A}},Ea=p.__private__.getPageInfo=p.getPageInfo=function(h){if(isNaN(h)||h%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Je[h].objId,pageNumber:h,pageContext:Je[h]}},Ke=p.__private__.getPageInfoByObjId=function(h){if(isNaN(h)||h%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var A in Je)if(Je[A].objId===h)break;return Ea(A)},fl=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Je[R].objId,pageNumber:R,pageContext:Je[R]}};p.addPage=function(){return ka.apply(this,arguments),this},p.setPage=function(){return _a.apply(this,arguments),ve.call(this,Ae[R]),this},p.insertPage=function(h){return this.addPage(),this.movePage(R,h),this},p.movePage=function(h,A){var F,$;if(h>A){F=Ae[h],$=Je[h];for(var ie=h;ie>A;ie--)Ae[ie]=Ae[ie-1],Je[ie]=Je[ie-1];Ae[A]=F,Je[A]=$,this.setPage(A)}else if(h<A){F=Ae[h],$=Je[h];for(var ge=h;ge<A;ge++)Ae[ge]=Ae[ge+1],Je[ge]=Je[ge+1];Ae[A]=F,Je[A]=$,this.setPage(A)}return this},p.deletePage=function(){return al.apply(this,arguments),this},p.__private__.text=p.text=function(h,A,F,$,ie){var ge,Ne,De,qe,et,Xe,ot,kt,It,Ut=($=$||{}).scope||this;if(typeof h=="number"&&typeof A=="number"&&(typeof F=="string"||Array.isArray(F))){var nr=F;F=A,A=h,h=nr}if(arguments[3]instanceof Ue?(M("The transform parameter of text() with a Matrix value"),It=ie):(De=arguments[4],qe=arguments[5],vt(ot=arguments[3])==="object"&&ot!==null||(typeof De=="string"&&(qe=De,De=null),typeof ot=="string"&&(qe=ot,ot=null),typeof ot=="number"&&(De=ot,ot=null),$={flags:ot,angle:De,align:qe})),isNaN(A)||isNaN(F)||h==null)throw new Error("Invalid arguments passed to jsPDF.text");if(h.length===0)return Ut;var Kt="",Jr=!1,Sr=typeof $.lineHeightFactor=="number"?$.lineHeightFactor:mi,mn=Ut.internal.scaleFactor;function za(jt){return jt=jt.split("	").join(Array($.TabLen||9).join(" ")),gr(jt,ot)}function Gs(jt){for(var At,Ft=jt.concat(),$t=[],On=Ft.length;On--;)typeof(At=Ft.shift())=="string"?$t.push(At):Array.isArray(jt)&&(At.length===1||At[1]===void 0&&At[2]===void 0)?$t.push(At[0]):$t.push([At[0],At[1],At[2]]);return $t}function $s(jt,At){var Ft;if(typeof jt=="string")Ft=At(jt)[0];else if(Array.isArray(jt)){for(var $t,On,ta=jt.concat(),is=[],Ga=ta.length;Ga--;)typeof($t=ta.shift())=="string"?is.push(At($t)[0]):Array.isArray($t)&&typeof $t[0]=="string"&&(On=At($t[0],$t[1],$t[2]),is.push([On[0],On[1],On[2]]));Ft=is}return Ft}var Yi=!1,Ks=!0;if(typeof h=="string")Yi=!0;else if(Array.isArray(h)){var Ys=h.concat();Ne=[];for(var Ji,Zt=Ys.length;Zt--;)(typeof(Ji=Ys.shift())!="string"||Array.isArray(Ji)&&typeof Ji[0]!="string")&&(Ks=!1);Yi=Ks}if(Yi===!1)throw new Error('Type of text must be string or Array. "'+h+'" is not recognized.');typeof h=="string"&&(h=h.match(/[\r?\n]/)?h.split(/\r\n|\r|\n/g):[h]);var Xi=Pe/Ut.internal.scaleFactor,Qi=Xi*(Sr-1);switch($.baseline){case"bottom":F-=Qi;break;case"top":F+=Xi-Qi;break;case"hanging":F+=Xi-2*Qi;break;case"middle":F+=Xi/2-Qi}if((Xe=$.maxWidth||0)>0&&(typeof h=="string"?h=Ut.splitTextToSize(h,Xe):Object.prototype.toString.call(h)==="[object Array]"&&(h=h.reduce(function(jt,At){return jt.concat(Ut.splitTextToSize(At,Xe))},[]))),ge={text:h,x:A,y:F,options:$,mutex:{pdfEscape:gr,activeFontKey:it,fonts:bt,activeFontSize:Pe}},pt.publish("preProcessText",ge),h=ge.text,De=($=ge.options).angle,!(It instanceof Ue)&&De&&typeof De=="number"){De*=Math.PI/180,$.rotationDirection===0&&(De=-De),T===S.ADVANCED&&(De=-De);var Zi=Math.cos(De),Js=Math.sin(De);It=new Ue(Zi,Js,-Js,Zi,0,0)}else De&&De instanceof Ue&&(It=De);T!==S.ADVANCED||It||(It=un),(et=$.charSpace||Gi)!==void 0&&(Kt+=H(_(et))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(kt=$.horizontalScale)!==void 0&&(Kt+=H(100*kt)+` Tz
`),$.lang;var vr=-1,jl=$.renderingMode!==void 0?$.renderingMode:$.stroke,Xs=Ut.internal.getCurrentPageInfo().pageContext;switch(jl){case 0:case!1:case"fill":vr=0;break;case 1:case!0:case"stroke":vr=1;break;case 2:case"fillThenStroke":vr=2;break;case 3:case"invisible":vr=3;break;case 4:case"fillAndAddForClipping":vr=4;break;case 5:case"strokeAndAddPathForClipping":vr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":vr=6;break;case 7:case"addToPathForClipping":vr=7}var Ua=Xs.usedRenderingMode!==void 0?Xs.usedRenderingMode:-1;vr!==-1?Kt+=vr+` Tr
`:Ua!==-1&&(Kt+=`0 Tr
`),vr!==-1&&(Xs.usedRenderingMode=vr),qe=$.align||"left";var Or,es=Pe*Sr,Va=Ut.internal.pageSize.getWidth(),Wa=bt[it];et=$.charSpace||Gi,Xe=$.maxWidth||0,ot=Object.assign({autoencode:!0,noBOM:!0},$.flags);var Gn=[],xi=function(jt){return Ut.getStringUnitWidth(jt,{font:Wa,charSpace:et,fontSize:Pe,doKerning:!1})*Pe/mn};if(Object.prototype.toString.call(h)==="[object Array]"){var xr;Ne=Gs(h),qe!=="left"&&(Or=Ne.map(xi));var ur,$n=0;if(qe==="right"){A-=Or[0],h=[],Zt=Ne.length;for(var Cn=0;Cn<Zt;Cn++)Cn===0?(ur=pn(A),xr=_n(F)):(ur=_($n-Or[Cn]),xr=-es),h.push([Ne[Cn],ur,xr]),$n=Or[Cn]}else if(qe==="center"){A-=Or[0]/2,h=[],Zt=Ne.length;for(var In=0;In<Zt;In++)In===0?(ur=pn(A),xr=_n(F)):(ur=_(($n-Or[In])/2),xr=-es),h.push([Ne[In],ur,xr]),$n=Or[In]}else if(qe==="left"){h=[],Zt=Ne.length;for(var ts=0;ts<Zt;ts++)h.push(Ne[ts])}else if(qe==="justify"&&Wa.encoding==="Identity-H"){h=[],Zt=Ne.length,Xe=Xe!==0?Xe:Va;for(var En=0,Rt=0;Rt<Zt;Rt++)if(xr=Rt===0?_n(F):-es,ur=Rt===0?pn(A):En,Rt<Zt-1){var Qs=_((Xe-Or[Rt])/(Ne[Rt].split(" ").length-1)),dr=Ne[Rt].split(" ");h.push([dr[0]+" ",ur,xr]),En=0;for(var Tr=1;Tr<dr.length;Tr++){var rs=(xi(dr[Tr-1]+" "+dr[Tr])-xi(dr[Tr]))*mn+Qs;Tr==dr.length-1?h.push([dr[Tr],rs,0]):h.push([dr[Tr]+" ",rs,0]),En-=rs}}else h.push([Ne[Rt],ur,xr]);h.push(["",En,0])}else{if(qe!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(h=[],Zt=Ne.length,Xe=Xe!==0?Xe:Va,Rt=0;Rt<Zt;Rt++)xr=Rt===0?_n(F):-es,ur=Rt===0?pn(A):0,Rt<Zt-1?Gn.push(H(_((Xe-Or[Rt])/(Ne[Rt].split(" ").length-1)))):Gn.push(0),h.push([Ne[Rt],ur,xr])}}var Ha=typeof $.R2L=="boolean"?$.R2L:Be;Ha===!0&&(h=$s(h,function(jt,At,Ft){return[jt.split("").reverse().join(""),At,Ft]})),ge={text:h,x:A,y:F,options:$,mutex:{pdfEscape:gr,activeFontKey:it,fonts:bt,activeFontSize:Pe}},pt.publish("postProcessText",ge),h=ge.text,Jr=ge.mutex.isHex||!1;var Zs=bt[it].encoding;Zs!=="WinAnsiEncoding"&&Zs!=="StandardEncoding"||(h=$s(h,function(jt,At,Ft){return[za(jt),At,Ft]})),Ne=Gs(h),h=[];for(var yi,bi,Kn,wi=0,ns=1,Ni=Array.isArray(Ne[0])?ns:wi,Yn="",ea=function(jt,At,Ft){var $t="";return Ft instanceof Ue?(Ft=typeof $.angle=="number"?Wr(Ft,new Ue(1,0,0,1,jt,At)):Wr(new Ue(1,0,0,1,jt,At),Ft),T===S.ADVANCED&&(Ft=Wr(new Ue(1,0,0,-1,0,0),Ft)),$t=Ft.join(" ")+` Tm
`):$t=H(jt)+" "+H(At)+` Td
`,$t},Dr=0;Dr<Ne.length;Dr++){switch(Yn="",Ni){case ns:Kn=(Jr?"<":"(")+Ne[Dr][0]+(Jr?">":")"),yi=parseFloat(Ne[Dr][1]),bi=parseFloat(Ne[Dr][2]);break;case wi:Kn=(Jr?"<":"(")+Ne[Dr]+(Jr?">":")"),yi=pn(A),bi=_n(F)}Gn!==void 0&&Gn[Dr]!==void 0&&(Yn=Gn[Dr]+` Tw
`),Dr===0?h.push(Yn+ea(yi,bi,It)+Kn):Ni===wi?h.push(Yn+Kn):Ni===ns&&h.push(Yn+ea(yi,bi,It)+Kn)}h=Ni===wi?h.join(` Tj
T* `):h.join(` Tj
`),h+=` Tj
`;var Rr=`BT
/`;return Rr+=it+" "+Pe+` Tf
`,Rr+=H(Pe*Sr)+` TL
`,Rr+=gi+`
`,Rr+=Kt,Rr+=h,U(Rr+="ET"),y[it]=!0,Ut};var pl=p.__private__.clip=p.clip=function(h){return U(h==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return pl("evenodd")},p.__private__.discardPath=p.discardPath=function(){return U("n"),this};var fn=p.__private__.isValidStyle=function(h){var A=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(h)!==-1&&(A=!0),A};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(h){return fn(h)&&(m=h),this};var Oa=p.__private__.getStyle=p.getStyle=function(h){var A=m;switch(h){case"D":case"S":A="S";break;case"F":A="f";break;case"FD":case"DF":A="B";break;case"f":case"f*":case"B":case"B*":A=h}return A},Ta=p.close=function(){return U("h"),this};p.stroke=function(){return U("S"),this},p.fill=function(h){return Wi("f",h),this},p.fillEvenOdd=function(h){return Wi("f*",h),this},p.fillStroke=function(h){return Wi("B",h),this},p.fillStrokeEvenOdd=function(h){return Wi("B*",h),this};var Wi=function(h,A){vt(A)==="object"?gl(A,h):U(h)},Rs=function(h){h===null||T===S.ADVANCED&&h===void 0||(h=Oa(h),U(h))};function ml(h,A,F,$,ie){var ge=new gs(A||this.boundingBox,F||this.xStep,$||this.yStep,this.gState,ie||this.matrix);ge.stream=this.stream;var Ne=h+"$$"+this.cloneIndex+++"$$";return mr(Ne,ge),ge}var gl=function(h,A){var F=di[h.key],$=ft[F];if($ instanceof Li)U("q"),U(vl(A)),$.gState&&p.setGState($.gState),U(h.matrix.toString()+" cm"),U("/"+F+" sh"),U("Q");else if($ instanceof gs){var ie=new Ue(1,0,0,-1,0,Hn());h.matrix&&(ie=ie.multiply(h.matrix||un),F=ml.call($,h.key,h.boundingBox,h.xStep,h.yStep,ie).id),U("q"),U("/Pattern cs"),U("/"+F+" scn"),$.gState&&p.setGState($.gState),U(A),U("Q")}},vl=function(h){switch(h){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Fs=p.moveTo=function(h,A){return U(H(_(h))+" "+H(q(A))+" m"),this},pi=p.lineTo=function(h,A){return U(H(_(h))+" "+H(q(A))+" l"),this},Vn=p.curveTo=function(h,A,F,$,ie,ge){return U([H(_(h)),H(q(A)),H(_(F)),H(q($)),H(_(ie)),H(q(ge)),"c"].join(" ")),this};p.__private__.line=p.line=function(h,A,F,$,ie){if(isNaN(h)||isNaN(A)||isNaN(F)||isNaN($)||!fn(ie))throw new Error("Invalid arguments passed to jsPDF.line");return T===S.COMPAT?this.lines([[F-h,$-A]],h,A,[1,1],ie||"S"):this.lines([[F-h,$-A]],h,A,[1,1]).stroke()},p.__private__.lines=p.lines=function(h,A,F,$,ie,ge){var Ne,De,qe,et,Xe,ot,kt,It,Ut,nr,Kt,Jr;if(typeof h=="number"&&(Jr=F,F=A,A=h,h=Jr),$=$||[1,1],ge=ge||!1,isNaN(A)||isNaN(F)||!Array.isArray(h)||!Array.isArray($)||!fn(ie)||typeof ge!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Fs(A,F),Ne=$[0],De=$[1],et=h.length,nr=A,Kt=F,qe=0;qe<et;qe++)(Xe=h[qe]).length===2?(nr=Xe[0]*Ne+nr,Kt=Xe[1]*De+Kt,pi(nr,Kt)):(ot=Xe[0]*Ne+nr,kt=Xe[1]*De+Kt,It=Xe[2]*Ne+nr,Ut=Xe[3]*De+Kt,nr=Xe[4]*Ne+nr,Kt=Xe[5]*De+Kt,Vn(ot,kt,It,Ut,nr,Kt));return ge&&Ta(),Rs(ie),this},p.path=function(h){for(var A=0;A<h.length;A++){var F=h[A],$=F.c;switch(F.op){case"m":Fs($[0],$[1]);break;case"l":pi($[0],$[1]);break;case"c":Vn.apply(this,$);break;case"h":Ta()}}return this},p.__private__.rect=p.rect=function(h,A,F,$,ie){if(isNaN(h)||isNaN(A)||isNaN(F)||isNaN($)||!fn(ie))throw new Error("Invalid arguments passed to jsPDF.rect");return T===S.COMPAT&&($=-$),U([H(_(h)),H(q(A)),H(_(F)),H(_($)),"re"].join(" ")),Rs(ie),this},p.__private__.triangle=p.triangle=function(h,A,F,$,ie,ge,Ne){if(isNaN(h)||isNaN(A)||isNaN(F)||isNaN($)||isNaN(ie)||isNaN(ge)||!fn(Ne))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[F-h,$-A],[ie-F,ge-$],[h-ie,A-ge]],h,A,[1,1],Ne,!0),this},p.__private__.roundedRect=p.roundedRect=function(h,A,F,$,ie,ge,Ne){if(isNaN(h)||isNaN(A)||isNaN(F)||isNaN($)||isNaN(ie)||isNaN(ge)||!fn(Ne))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var De=4/3*(Math.SQRT2-1);return ie=Math.min(ie,.5*F),ge=Math.min(ge,.5*$),this.lines([[F-2*ie,0],[ie*De,0,ie,ge-ge*De,ie,ge],[0,$-2*ge],[0,ge*De,-ie*De,ge,-ie,ge],[2*ie-F,0],[-ie*De,0,-ie,-ge*De,-ie,-ge],[0,2*ge-$],[0,-ge*De,ie*De,-ge,ie,-ge]],h+ie,A,[1,1],Ne,!0),this},p.__private__.ellipse=p.ellipse=function(h,A,F,$,ie){if(isNaN(h)||isNaN(A)||isNaN(F)||isNaN($)||!fn(ie))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ge=4/3*(Math.SQRT2-1)*F,Ne=4/3*(Math.SQRT2-1)*$;return Fs(h+F,A),Vn(h+F,A-Ne,h+ge,A-$,h,A-$),Vn(h-ge,A-$,h-F,A-Ne,h-F,A),Vn(h-F,A+Ne,h-ge,A+$,h,A+$),Vn(h+ge,A+$,h+F,A+Ne,h+F,A),Rs(ie),this},p.__private__.circle=p.circle=function(h,A,F,$){if(isNaN(h)||isNaN(A)||isNaN(F)||!fn($))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(h,A,F,F,$)},p.setFont=function(h,A,F){return F&&(A=te(A,F)),it=Ca(h,A,{disableWarning:!1}),this};var xl=p.__private__.getFont=p.getFont=function(){return bt[Ca.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var h,A,F={};for(h in Lt)if(Lt.hasOwnProperty(h))for(A in F[h]=[],Lt[h])Lt[h].hasOwnProperty(A)&&F[h].push(A);return F},p.addFont=function(h,A,F,$,ie){var ge=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ge.indexOf(arguments[3])!==-1?ie=arguments[3]:arguments[3]&&ge.indexOf(arguments[3])==-1&&(F=te(F,$)),ie=ie||"Identity-H",Os.call(this,h,A,F,ie)};var mi,Ms=r.lineWidth||.200025,Hi=p.__private__.getLineWidth=p.getLineWidth=function(){return Ms},Da=p.__private__.setLineWidth=p.setLineWidth=function(h){return Ms=h,U(H(_(h))+" w"),this};p.__private__.setLineDash=We.API.setLineDash=We.API.setLineDashPattern=function(h,A){if(h=h||[],A=A||0,isNaN(A)||!Array.isArray(h))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return h=h.map(function(F){return H(_(F))}).join(" "),A=H(_(A)),U("["+h+"] "+A+" d"),this};var Ra=p.__private__.getLineHeight=p.getLineHeight=function(){return Pe*mi};p.__private__.getLineHeight=p.getLineHeight=function(){return Pe*mi};var Fa=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(h){return typeof(h=h||1.15)=="number"&&(mi=h),this},Ma=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return mi};Fa(r.lineHeight);var pn=p.__private__.getHorizontalCoordinate=function(h){return _(h)},_n=p.__private__.getVerticalCoordinate=function(h){return T===S.ADVANCED?h:Je[R].mediaBox.topRightY-Je[R].mediaBox.bottomLeftY-_(h)},yl=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(h){return H(pn(h))},Wn=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(h){return H(_n(h))},Yr=r.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Gr(Yr)},p.__private__.setStrokeColor=p.setDrawColor=function(h,A,F,$){return Yr=$r({ch1:h,ch2:A,ch3:F,ch4:$,pdfColorType:"draw",precision:2}),U(Yr),this};var Bs=r.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Gr(Bs)},p.__private__.setFillColor=p.setFillColor=function(h,A,F,$){return Bs=$r({ch1:h,ch2:A,ch3:F,ch4:$,pdfColorType:"fill",precision:2}),U(Bs),this};var gi=r.textColor||"0 g",bl=p.__private__.getTextColor=p.getTextColor=function(){return Gr(gi)};p.__private__.setTextColor=p.setTextColor=function(h,A,F,$){return gi=$r({ch1:h,ch2:A,ch3:F,ch4:$,pdfColorType:"text",precision:3}),this};var Gi=r.charSpace,wl=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Gi||0)};p.__private__.setCharSpace=p.setCharSpace=function(h){if(isNaN(h))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Gi=h,this};var qs=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(h){var A=p.CapJoinStyles[h];if(A===void 0)throw new Error("Line cap style of '"+h+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return qs=A,U(A+" J"),this};var zs=0;p.__private__.setLineJoin=p.setLineJoin=function(h){var A=p.CapJoinStyles[h];if(A===void 0)throw new Error("Line join style of '"+h+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zs=A,U(A+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(h){if(h=h||0,isNaN(h))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return U(H(_(h))+" M"),this},p.GState=Ro,p.setGState=function(h){(h=typeof h=="string"?_t[Vr[h]]:Ba(null,h)).equals(Ln)||(U("/"+h.id+" gs"),Ln=h)};var Ba=function(h,A){if(!h||!Vr[h]){var F=!1;for(var $ in _t)if(_t.hasOwnProperty($)&&_t[$].equals(A)){F=!0;break}if(F)A=_t[$];else{var ie="GS"+(Object.keys(_t).length+1).toString(10);_t[ie]=A,A.id=ie}return h&&(Vr[h]=A.id),pt.publish("addGState",A),A}};p.addGState=function(h,A){return Ba(h,A),this},p.saveGraphicsState=function(){return U("q"),on.push({key:it,size:Pe,color:gi}),this},p.restoreGraphicsState=function(){U("Q");var h=on.pop();return it=h.key,Pe=h.size,gi=h.color,Ln=null,this},p.setCurrentTransformationMatrix=function(h){return U(h.toString()+" cm"),this},p.comment=function(h){return U("#"+h),this};var $i=function(h,A){var F=h||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return F},set:function(ge){isNaN(ge)||(F=parseFloat(ge))}});var $=A||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return $},set:function(ge){isNaN(ge)||($=parseFloat(ge))}});var ie="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ie},set:function(ge){ie=ge.toString()}}),this},Us=function(h,A,F,$){$i.call(this,h,A),this.type="rect";var ie=F||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ie},set:function(Ne){isNaN(Ne)||(ie=parseFloat(Ne))}});var ge=$||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ge},set:function(Ne){isNaN(Ne)||(ge=parseFloat(Ne))}}),this},Vs=function(){this.page=Ct,this.currentPage=R,this.pages=Ae.slice(0),this.pagesContext=Je.slice(0),this.x=tr,this.y=ut,this.matrix=Ur,this.width=vi(R),this.height=Hn(R),this.outputDestination=_e,this.id="",this.objectNumber=-1};Vs.prototype.restore=function(){Ct=this.page,R=this.currentPage,Je=this.pagesContext,Ae=this.pages,tr=this.x,ut=this.y,Ur=this.matrix,Ws(R,this.width),Hs(R,this.height),_e=this.outputDestination};var qa=function(h,A,F,$,ie){cn.push(new Vs),Ct=R=0,Ae=[],tr=h,ut=A,Ur=ie,Ts([F,$])},Nl=function(h){if(ln[h])cn.pop().restore();else{var A=new Vs,F="Xo"+(Object.keys(Qt).length+1).toString(10);A.id=F,ln[h]=F,Qt[F]=A,pt.publish("addFormObject",A),cn.pop().restore()}};for(var Ki in p.beginFormObject=function(h,A,F,$,ie){return qa(h,A,F,$,ie),this},p.endFormObject=function(h){return Nl(h),this},p.doFormObject=function(h,A){var F=Qt[ln[h]];return U("q"),U(A.toString()+" cm"),U("/"+F.id+" Do"),U("Q"),this},p.getFormObject=function(h){var A=Qt[ln[h]];return{x:A.x,y:A.y,width:A.width,height:A.height,matrix:A.matrix}},p.save=function(h,A){return h=h||"generated.pdf",(A=A||{}).returnPromise=A.returnPromise||!1,A.returnPromise===!1?(Si(Ui(kn()),h),typeof Si.unload=="function"&&He.setTimeout&&setTimeout(Si.unload,911),this):new Promise(function(F,$){try{var ie=Si(Ui(kn()),h);typeof Si.unload=="function"&&He.setTimeout&&setTimeout(Si.unload,911),F(ie)}catch(ge){$(ge.message)}})},We.API)We.API.hasOwnProperty(Ki)&&(Ki==="events"&&We.API.events.length?function(h,A){var F,$,ie;for(ie=A.length-1;ie!==-1;ie--)F=A[ie][0],$=A[ie][1],h.subscribe.apply(h,[F].concat(typeof $=="function"?[$]:$))}(pt,We.API.events):p[Ki]=We.API[Ki]);var vi=p.getPageWidth=function(h){return(Je[h=h||R].mediaBox.topRightX-Je[h].mediaBox.bottomLeftX)/Te},Ws=p.setPageWidth=function(h,A){Je[h].mediaBox.topRightX=A*Te+Je[h].mediaBox.bottomLeftX},Hn=p.getPageHeight=function(h){return(Je[h=h||R].mediaBox.topRightY-Je[h].mediaBox.bottomLeftY)/Te},Hs=p.setPageHeight=function(h,A){Je[h].mediaBox.topRightY=A*Te+Je[h].mediaBox.bottomLeftY};return p.internal={pdfEscape:gr,getStyle:Oa,getFont:xl,getFontSize:Ie,getCharSpace:wl,getTextColor:bl,getLineHeight:Ra,getLineHeightFactor:Ma,getLineWidth:Hi,write:Ze,getHorizontalCoordinate:pn,getVerticalCoordinate:_n,getCoordinateString:yl,getVerticalCoordinateString:Wn,collections:{},newObject:Gt,newAdditionalObject:Ti,newObjectDeferred:zt,newObjectDeferredBegin:Ar,getFilters:dn,putStream:Er,events:pt,scaleFactor:Te,pageSize:{getWidth:function(){return vi(R)},setWidth:function(h){Ws(R,h)},getHeight:function(){return Hn(R)},setHeight:function(h){Hs(R,h)}},encryptionOptions:g,encryption:rr,getEncryptor:hl,output:Vi,getNumberOfPages:ol,pages:Ae,out:U,f2:ce,f3:E,getPageInfo:Ea,getPageInfoByObjId:Ke,getCurrentPageInfo:fl,getPDFVersion:b,Point:$i,Rectangle:Us,Matrix:Ue,hasHotfix:Ia},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return vi(R)},set:function(h){Ws(R,h)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Hn(R)},set:function(h){Hs(R,h)},enumerable:!0,configurable:!0}),sl.call(p,je),it="F1",ka(i,t),pt.publish("initialized"),p}hs.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},hs.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},hs.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},hs.prototype.processOwnerPassword=function(r,e){return vc(gc(e).substr(0,5),r)},hs.prototype.encryptor=function(r,e){var t=gc(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return vc(t,n)}},Ro.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||vt(r)!==vt(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;n++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},We.API={events:[]},We.version="3.0.1";var Ot=We.API,zc=1,Oi=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},us=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Qe=function(r){return r.toFixed(2)},ii=function(r){return r.toFixed(5)};Ot.__acroform__={};var jr=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},Qu=function(r){return r*zc},xn=function(r){var e=new mh,t=Fe.internal.getHeight(r)||0,n=Fe.internal.getWidth(r)||0;return e.BBox=[0,0,Number(Qe(n)),Number(Qe(t))],e},S2=Ot.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<e},L2=Ot.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<e)},P2=Ot.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<e?1:0},Mt=Ot.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return P2(r,e-1)},Bt=Ot.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return S2(r,e-1)},qt=Ot.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return L2(r,e-1)},k2=Ot.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=r[0],s=r[1],l=r[2],u=r[3],d={};return d.lowerLeft_X=t(i)||0,d.lowerLeft_Y=n(s+u)||0,d.upperRight_X=t(i+l)||0,d.upperRight_Y=n(s)||0,[Number(Qe(d.lowerLeft_X)),Number(Qe(d.lowerLeft_Y)),Number(Qe(d.upperRight_X)),Number(Qe(d.upperRight_Y))]},_2=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,n=xc(r,t),i=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+i+" "+Qe(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=xn(r);return s.scope=r.scope,s.stream=e.join(`
`),s}},xc=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=r.multiline?i.map(function(E){return E.split(`
`)}):i.map(function(E){return[E]});var s=t,l=Fe.internal.getHeight(r)||0;l=l<0?-l:l;var u=Fe.internal.getWidth(r)||0;u=u<0?-u:u;var d=function(E,_,B){if(E+1<i.length){var q=_+" "+i[E+1][0];return go(q,r,B).width<=u-4}return!1};s++;e:for(;s>0;){e="",s--;var m,g,v=go("3",r,s).height,y=r.multiline?l-s:(l-v)/2,p=y+=2,N=0,b=0,I=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+go(e,r,s=12).width+", FieldWidth:"+u+`
`;break}for(var w="",S=0,T=0;T<i.length;T++)if(i.hasOwnProperty(T)){var W=!1;if(i[T].length!==1&&I!==i[T].length-1){if((v+2)*(S+2)+2>l)continue e;w+=i[T][I],W=!0,b=T,T--}else{w=(w+=i[T][I]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var G=parseInt(T),te=d(G,w,s),H=T>=i.length-1;if(te&&!H){w+=" ",I=0;continue}if(te||H){if(H)b=G;else if(r.multiline&&(v+2)*(S+2)+2>l)continue e}else{if(!r.multiline||(v+2)*(S+2)+2>l)continue e;b=G}}for(var M="",Q=N;Q<=b;Q++){var ce=i[Q];if(r.multiline){if(Q===b){M+=ce[I]+" ",I=(I+1)%ce.length;continue}if(Q===N){M+=ce[ce.length-1]+" ";continue}}M+=ce[0]+" "}switch(M=M.substr(M.length-1)==" "?M.substr(0,M.length-1):M,g=go(M,r,s).width,r.textAlign){case"right":m=u-g-2;break;case"center":m=(u-g)/2;break;case"left":default:m=2}e+=Qe(m)+" "+Qe(p)+` Td
`,e+="("+Oi(M)+`) Tj
`,e+=-Qe(m)+` 0 Td
`,p=-(s+2),g=0,N=W?b:b+1,S++,w=""}break}return n.text=e,n.fontSize=s,n},go=function(r,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:i}},C2={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},I2=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},E2=function(r,e){for(var t in r)if(r.hasOwnProperty(t)){var n=t,i=r[t];e.internal.newObjectDeferredBegin(i.objId,!0),vt(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete r[n]}},O2=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(sn.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(C2)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");zc=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new gh,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&I2(s,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(n,i){var s=!n;for(var l in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(l)){var u=n[l],d=[],m=u.Rect;if(u.Rect&&(u.Rect=k2(u.Rect,i)),i.internal.newObjectDeferredBegin(u.objId,!0),u.DA=Fe.createDefaultAppearanceStream(u),vt(u)==="object"&&typeof u.getKeyValueListForStream=="function"&&(d=u.getKeyValueListForStream()),u.Rect=m,u.hasAppearanceStream&&!u.appearanceStreamContent){var g=_2(u);d.push({key:"AP",value:"<</N "+g+">>"}),i.internal.acroformPlugin.xForms.push(g)}if(u.appearanceStreamContent){var v="";for(var y in u.appearanceStreamContent)if(u.appearanceStreamContent.hasOwnProperty(y)){var p=u.appearanceStreamContent[y];if(v+="/"+y+" ",v+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var l in p)if(p.hasOwnProperty(l)){var N=p[l];typeof N=="function"&&(N=N.call(i,u)),v+="/"+l+" "+N+" ",i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N)}}else typeof(N=p)=="function"&&(N=N.call(i,u)),v+="/"+l+" "+N,i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N);v+=">>"}d.push({key:"AP",value:`<<
`+v+">>"})}i.internal.putStream({additionalKeyValues:d,objectId:u.objId}),i.internal.out("endobj")}s&&E2(i.internal.acroformPlugin.xForms,i)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},ph=Ot.__acroform__.arrayToPdfArray=function(r,e,t){var n=function(l){return l};if(Array.isArray(r)){for(var i="[",s=0;s<r.length;s++)switch(s!==0&&(i+=" "),vt(r[s])){case"boolean":case"number":case"object":i+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),i+="("+Oi(n(r[s].toString()))+")"):i+=r[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Kl=function(r,e,t){var n=function(i){return i};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(r=r||"").toString(),r="("+Oi(n(r))+")"},yn=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};yn.prototype.toString=function(){return this.objId+" 0 R"},yn.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},yn.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],i=this[n];i&&(Array.isArray(i)?r.push({key:n,value:ph(i,this.objId,this.scope)}):i instanceof yn?(i.scope=this.scope,r.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&r.push({key:n,value:i}))}return r};var mh=function(){yn.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};jr(mh,yn);var gh=function(){yn.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Oi(t(r))+")"}},set:function(t){r=t}})};jr(gh,yn);var sn=function r(){yn.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Mt(e,3)},set:function(w){w?this.F=Bt(e,3):this.F=qt(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');t=w}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(w){n=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(w){n[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(w){n[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(w){n[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(w){n[3]=w}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Fo)return;s="FieldObject"+r.FieldNum++}var w=function(S){return S};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+Oi(w(s))+")"},set:function(w){s=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(w){s=w}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(w){l=w}});var u="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return u},set:function(w){u=w}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(w){d=w}});var m=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return m===void 0?50/zc:m},set:function(w){m=w}});var g="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return g},set:function(w){g=w}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof Fo||this instanceof _i))return Kl(v,this.objId,this.scope)},set:function(w){w=w.toString(),v=w}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof Xt?y:Kl(y,this.objId,this.scope)},set:function(w){w=w.toString(),y=this instanceof Xt?w:w.substr(0,1)==="("?us(w.substr(1,w.length-2)):us(w)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xt?us(y.substr(1,y.length-1)):y},set:function(w){w=w.toString(),y=this instanceof Xt?"/"+w:w}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Xt?p:Kl(p,this.objId,this.scope)},set:function(w){w=w.toString(),p=this instanceof Xt?w:w.substr(0,1)==="("?us(w.substr(1,w.length-2)):us(w)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xt?us(p.substr(1,p.length-1)):p},set:function(w){w=w.toString(),p=this instanceof Xt?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var N,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(w){w=!!w,b=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(N)return N},set:function(w){N=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,1)},set:function(w){w?this.Ff=Bt(this.Ff,1):this.Ff=qt(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,2)},set:function(w){w?this.Ff=Bt(this.Ff,2):this.Ff=qt(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,3)},set:function(w){w?this.Ff=Bt(this.Ff,3):this.Ff=qt(this.Ff,3)}});var I=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(I!==null)return I},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');I=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(I){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:I=2;break;case"center":case 1:I=1;break;case"left":case 0:default:I=0}}})};jr(sn,yn);var xs=function(){sn.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ph(e,this.objId,this.scope)},set:function(t){var n,i;i=[],typeof(n=t)=="string"&&(i=function(s,l,u){u||(u=1);for(var d,m=[];d=l.exec(s);)m.push(d[u]);return m}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,18)},set:function(t){t?this.Ff=Bt(this.Ff,18):this.Ff=qt(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Bt(this.Ff,19):this.Ff=qt(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,20)},set:function(t){t?(this.Ff=Bt(this.Ff,20),e.sort()):this.Ff=qt(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,22)},set:function(t){t?this.Ff=Bt(this.Ff,22):this.Ff=qt(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,23)},set:function(t){t?this.Ff=Bt(this.Ff,23):this.Ff=qt(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,27)},set:function(t){t?this.Ff=Bt(this.Ff,27):this.Ff=qt(this.Ff,27)}}),this.hasAppearanceStream=!1};jr(xs,sn);var ys=function(){xs.call(this),this.fontName="helvetica",this.combo=!1};jr(ys,xs);var bs=function(){ys.call(this),this.combo=!0};jr(bs,ys);var Ao=function(){bs.call(this),this.edit=!0};jr(Ao,bs);var Xt=function(){sn.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,15)},set:function(t){t?this.Ff=Bt(this.Ff,15):this.Ff=qt(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,16)},set:function(t){t?this.Ff=Bt(this.Ff,16):this.Ff=qt(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,17)},set:function(t){t?this.Ff=Bt(this.Ff,17):this.Ff=qt(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,26)},set:function(t){t?this.Ff=Bt(this.Ff,26):this.Ff=qt(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+Oi(t(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(t){vt(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};jr(Xt,sn);var So=function(){Xt.call(this),this.pushButton=!0};jr(So,Xt);var ws=function(){Xt.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};jr(ws,Xt);var Fo=function(){var r,e;sn.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(u){return u};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),n)l.push("/"+s+" ("+Oi(i(n[s]))+")");return l.push(">>"),l.join(`
`)},set:function(i){vt(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(i){t="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Fe.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};jr(Fo,sn),ws.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},ws.prototype.createOption=function(r){var e=new Fo;return e.Parent=this,e.optionName=r,this.Kids.push(e),T2.call(this.scope,e),e};var Lo=function(){Xt.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Fe.CheckBox.createAppearanceStream()};jr(Lo,Xt);var _i=function(){sn.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,13)},set:function(e){e?this.Ff=Bt(this.Ff,13):this.Ff=qt(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,21)},set:function(e){e?this.Ff=Bt(this.Ff,21):this.Ff=qt(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,23)},set:function(e){e?this.Ff=Bt(this.Ff,23):this.Ff=qt(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,24)},set:function(e){e?this.Ff=Bt(this.Ff,24):this.Ff=qt(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,25)},set:function(e){e?this.Ff=Bt(this.Ff,25):this.Ff=qt(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,26)},set:function(e){e?this.Ff=Bt(this.Ff,26):this.Ff=qt(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};jr(_i,sn);var Po=function(){_i.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Mt(this.Ff,14)},set:function(r){r?this.Ff=Bt(this.Ff,14):this.Ff=qt(this.Ff,14)}}),this.password=!0};jr(Po,_i);var Fe={CheckBox:{createAppearanceStream:function(){return{N:{On:Fe.CheckBox.YesNormal},D:{On:Fe.CheckBox.YesPushDown,Off:Fe.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=xn(r);e.scope=r.scope;var t=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,i=r.scope.__private__.encodeColorString(r.color),s=xc(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+Qe(Fe.internal.getWidth(r))+" "+Qe(Fe.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+Qe(s.fontSize)+" Tf "+i),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=xn(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),i=[],s=Fe.internal.getHeight(r),l=Fe.internal.getWidth(r),u=xc(r,r.caption);return i.push("1 g"),i.push("0 0 "+Qe(l)+" "+Qe(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Qe(l-1)+" "+Qe(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+t+" "+Qe(u.fontSize)+" Tf "+n),i.push(u.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(r){var e=xn(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Qe(Fe.internal.getWidth(r))+" "+Qe(Fe.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:Fe.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=Fe.RadioButton.Circle.YesNormal,e.D[r]=Fe.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=xn(r);e.scope=r.scope;var t=[],n=Fe.internal.getWidth(r)<=Fe.internal.getHeight(r)?Fe.internal.getWidth(r)/4:Fe.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Fe.internal.Bezier_C,s=Number((n*i).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+ii(Fe.internal.getWidth(r)/2)+" "+ii(Fe.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=xn(r);e.scope=r.scope;var t=[],n=Fe.internal.getWidth(r)<=Fe.internal.getHeight(r)?Fe.internal.getWidth(r)/4:Fe.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*Fe.internal.Bezier_C).toFixed(5)),l=Number((n*Fe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ii(Fe.internal.getWidth(r)/2)+" "+ii(Fe.internal.getHeight(r)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+ii(Fe.internal.getWidth(r)/2)+" "+ii(Fe.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+l+" "+l+" "+n+" 0 "+n+" c"),t.push("-"+l+" "+n+" -"+n+" "+l+" -"+n+" 0 c"),t.push("-"+n+" -"+l+" -"+l+" -"+n+" 0 -"+n+" c"),t.push(l+" -"+n+" "+n+" -"+l+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=xn(r);e.scope=r.scope;var t=[],n=Fe.internal.getWidth(r)<=Fe.internal.getHeight(r)?Fe.internal.getWidth(r)/4:Fe.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*Fe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ii(Fe.internal.getWidth(r)/2)+" "+ii(Fe.internal.getHeight(r)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:Fe.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=Fe.RadioButton.Cross.YesNormal,e.D[r]=Fe.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=xn(r);e.scope=r.scope;var t=[],n=Fe.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+Qe(Fe.internal.getWidth(r)-2)+" "+Qe(Fe.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(Qe(n.x1.x)+" "+Qe(n.x1.y)+" m"),t.push(Qe(n.x2.x)+" "+Qe(n.x2.y)+" l"),t.push(Qe(n.x4.x)+" "+Qe(n.x4.y)+" m"),t.push(Qe(n.x3.x)+" "+Qe(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=xn(r);e.scope=r.scope;var t=Fe.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+Qe(Fe.internal.getWidth(r))+" "+Qe(Fe.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Qe(Fe.internal.getWidth(r)-2)+" "+Qe(Fe.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(Qe(t.x1.x)+" "+Qe(t.x1.y)+" m"),n.push(Qe(t.x2.x)+" "+Qe(t.x2.y)+" l"),n.push(Qe(t.x4.x)+" "+Qe(t.x4.y)+" m"),n.push(Qe(t.x3.x)+" "+Qe(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=xn(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Qe(Fe.internal.getWidth(r))+" "+Qe(Fe.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};Fe.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=Fe.internal.getWidth(r),t=Fe.internal.getHeight(r),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},Fe.internal.getWidth=function(r){var e=0;return vt(r)==="object"&&(e=Qu(r.Rect[2])),e},Fe.internal.getHeight=function(r){var e=0;return vt(r)==="object"&&(e=Qu(r.Rect[3])),e};var T2=Ot.addField=function(r){if(O2(this,r),!(r instanceof sn))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};Ot.AcroFormChoiceField=xs,Ot.AcroFormListBox=ys,Ot.AcroFormComboBox=bs,Ot.AcroFormEditBox=Ao,Ot.AcroFormButton=Xt,Ot.AcroFormPushButton=So,Ot.AcroFormRadioButton=ws,Ot.AcroFormCheckBox=Lo,Ot.AcroFormTextField=_i,Ot.AcroFormPasswordField=Po,Ot.AcroFormAppearance=Fe,Ot.AcroForm={ChoiceField:xs,ListBox:ys,ComboBox:bs,EditBox:Ao,Button:Xt,PushButton:So,RadioButton:ws,CheckBox:Lo,TextField:_i,PasswordField:Po,Appearance:Fe},We.AcroForm={ChoiceField:xs,ListBox:ys,ComboBox:bs,EditBox:Ao,Button:Xt,PushButton:So,RadioButton:ws,CheckBox:Lo,TextField:_i,PasswordField:Po,Appearance:Fe};function vh(r){return r.reduce(function(e,t,n){return e[t]=n,e},{})}(function(r){r.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(E,_){var B,q,ae,K,fe,se=e;if((_=_||e)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(te(E))for(fe in t)for(ae=t[fe],B=0;B<ae.length;B+=1){for(K=!0,q=0;q<ae[B].length;q+=1)if(ae[B][q]!==void 0&&ae[B][q]!==E[q]){K=!1;break}if(K===!0){se=fe;break}}else for(fe in t)for(ae=t[fe],B=0;B<ae.length;B+=1){for(K=!0,q=0;q<ae[B].length;q+=1)if(ae[B][q]!==void 0&&ae[B][q]!==E.charCodeAt(q)){K=!1;break}if(K===!0){se=fe;break}}return se===e&&_!==e&&(se=_),se},i=function E(_){for(var B=this.internal.write,q=this.internal.putStream,ae=(0,this.internal.getFilters)();ae.indexOf("FlateEncode")!==-1;)ae.splice(ae.indexOf("FlateEncode"),1);_.objectId=this.internal.newObject();var K=[];if(K.push({key:"Type",value:"/XObject"}),K.push({key:"Subtype",value:"/Image"}),K.push({key:"Width",value:_.width}),K.push({key:"Height",value:_.height}),_.colorSpace===I.INDEXED?K.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(_.palette.length/3-1)+" "+("sMask"in _&&_.sMask!==void 0?_.objectId+2:_.objectId+1)+" 0 R]"}):(K.push({key:"ColorSpace",value:"/"+_.colorSpace}),_.colorSpace===I.DEVICE_CMYK&&K.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),K.push({key:"BitsPerComponent",value:_.bitsPerComponent}),"decodeParameters"in _&&_.decodeParameters!==void 0&&K.push({key:"DecodeParms",value:"<<"+_.decodeParameters+">>"}),"transparency"in _&&Array.isArray(_.transparency)){for(var fe="",se=0,me=_.transparency.length;se<me;se++)fe+=_.transparency[se]+" "+_.transparency[se]+" ";K.push({key:"Mask",value:"["+fe+"]"})}_.sMask!==void 0&&K.push({key:"SMask",value:_.objectId+1+" 0 R"});var ee=_.filter!==void 0?["/"+_.filter]:void 0;if(q({data:_.data,additionalKeyValues:K,alreadyAppliedFilters:ee,objectId:_.objectId}),B("endobj"),"sMask"in _&&_.sMask!==void 0){var Le="/Predictor "+_.predictor+" /Colors 1 /BitsPerComponent "+_.bitsPerComponent+" /Columns "+_.width,k={width:_.width,height:_.height,colorSpace:"DeviceGray",bitsPerComponent:_.bitsPerComponent,decodeParameters:Le,data:_.sMask};"filter"in _&&(k.filter=_.filter),E.call(this,k)}if(_.colorSpace===I.INDEXED){var R=this.internal.newObject();q({data:M(new Uint8Array(_.palette)),objectId:R}),B("endobj")}},s=function(){var E=this.internal.collections.addImage_images;for(var _ in E)i.call(this,E[_])},l=function(){var E,_=this.internal.collections.addImage_images,B=this.internal.write;for(var q in _)B("/I"+(E=_[q]).index,E.objectId,"0","R")},u=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var E=this.internal.collections.addImage_images;return u.call(this),E},m=function(){return Object.keys(this.internal.collections.addImage_images).length},g=function(E){return typeof r["process"+E.toUpperCase()]=="function"},v=function(E){return vt(E)==="object"&&E.nodeType===1},y=function(E,_){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var B=""+E.getAttribute("src");if(B.indexOf("data:image/")===0)return xa(unescape(B).split("base64,").pop());var q=r.loadFile(B,!0);if(q!==void 0)return q}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var ae;switch(_){case"PNG":ae="image/png";break;case"WEBP":ae="image/webp";break;case"JPEG":case"JPG":default:ae="image/jpeg"}return xa(E.toDataURL(ae,1).split("base64,").pop())}},p=function(E){var _=this.internal.collections.addImage_images;if(_){for(var B in _)if(E===_[B].alias)return _[B]}},N=function(E,_,B){return E||_||(E=-96,_=-96),E<0&&(E=-1*B.width*72/E/this.internal.scaleFactor),_<0&&(_=-1*B.height*72/_/this.internal.scaleFactor),E===0&&(E=_*B.width/B.height),_===0&&(_=E*B.height/B.width),[E,_]},b=function(E,_,B,q,ae,K){var fe=N.call(this,B,q,ae),se=this.internal.getCoordinateString,me=this.internal.getVerticalCoordinateString,ee=d.call(this);if(B=fe[0],q=fe[1],ee[ae.index]=ae,K){K*=Math.PI/180;var Le=Math.cos(K),k=Math.sin(K),R=function(Y){return Y.toFixed(4)},z=[R(Le),R(k),R(-1*k),R(Le),0,0,"cm"]}this.internal.write("q"),K?(this.internal.write([1,"0","0",1,se(E),me(_+q),"cm"].join(" ")),this.internal.write(z.join(" ")),this.internal.write([se(B),"0","0",se(q),"0","0","cm"].join(" "))):this.internal.write([se(B),"0","0",se(q),se(E),me(_+q),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ae.index+" Do"),this.internal.write("Q")},I=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=r.__addimage__.sHashCode=function(E){var _,B,q=0;if(typeof E=="string")for(B=E.length,_=0;_<B;_++)q=(q<<5)-q+E.charCodeAt(_),q|=0;else if(te(E))for(B=E.byteLength/2,_=0;_<B;_++)q=(q<<5)-q+E[_],q|=0;return q},T=r.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var _=!0;return E.length===0&&(_=!1),E.length%4!=0&&(_=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(_=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(_=!1),_},W=r.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var _=E.indexOf(",");return _<0?null:E.substring(0,_).trim().endsWith("base64")?E.substring(_+1):null},G=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(E){return G()&&E instanceof ArrayBuffer};var te=r.__addimage__.isArrayBufferView=function(E){return G()&&typeof Uint32Array<"u"&&(E instanceof Int8Array||E instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array)},H=r.__addimage__.binaryStringToUint8Array=function(E){for(var _=E.length,B=new Uint8Array(_),q=0;q<_;q++)B[q]=E.charCodeAt(q);return B},M=r.__addimage__.arrayBufferToBinaryString=function(E){for(var _="",B=te(E)?E:new Uint8Array(E),q=0;q<B.length;q+=8192)_+=String.fromCharCode.apply(null,B.subarray(q,q+8192));return _};r.addImage=function(){var E,_,B,q,ae,K,fe,se,me;if(typeof arguments[1]=="number"?(_=e,B=arguments[1],q=arguments[2],ae=arguments[3],K=arguments[4],fe=arguments[5],se=arguments[6],me=arguments[7]):(_=arguments[1],B=arguments[2],q=arguments[3],ae=arguments[4],K=arguments[5],fe=arguments[6],se=arguments[7],me=arguments[8]),vt(E=arguments[0])==="object"&&!v(E)&&"imageData"in E){var ee=E;E=ee.imageData,_=ee.format||_||e,B=ee.x||B||0,q=ee.y||q||0,ae=ee.w||ee.width||ae,K=ee.h||ee.height||K,fe=ee.alias||fe,se=ee.compression||se,me=ee.rotation||ee.angle||me}var Le=this.internal.getFilters();if(se===void 0&&Le.indexOf("FlateEncode")!==-1&&(se="SLOW"),isNaN(B)||isNaN(q))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var k=Q.call(this,E,_,fe,se);return b.call(this,B,q,ae,K,k,me),this};var Q=function(E,_,B,q){var ae,K,fe;if(typeof E=="string"&&n(E)===e){E=unescape(E);var se=ce(E,!1);(se!==""||(se=r.loadFile(E,!0))!==void 0)&&(E=se)}if(v(E)&&(E=y(E,_)),_=n(E,_),!g(_))throw new Error("addImage does not support files of type '"+_+"', please ensure that a plugin for '"+_+"' support is added.");if(((fe=B)==null||fe.length===0)&&(B=function(me){return typeof me=="string"||te(me)?S(me):te(me.data)?S(me.data):null}(E)),(ae=p.call(this,B))||(G()&&(E instanceof Uint8Array||_==="RGBA"||(K=E,E=H(E))),ae=this["process"+_.toUpperCase()](E,m.call(this),B,function(me){return me&&typeof me=="string"&&(me=me.toUpperCase()),me in r.image_compression?me:w.NONE}(q),K)),!ae)throw new Error("An unknown error occurred whilst processing the image.");return ae},ce=r.__addimage__.convertBase64ToBinaryString=function(E,_){_=typeof _!="boolean"||_;var B,q="";if(typeof E=="string"){var ae;B=(ae=W(E))!==null&&ae!==void 0?ae:E;try{q=xa(B)}catch(K){if(_)throw T(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+K.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return q};r.getImageProperties=function(E){var _,B,q="";if(v(E)&&(E=y(E)),typeof E=="string"&&n(E)===e&&((q=ce(E,!1))===""&&(q=r.loadFile(E)||""),E=q),B=n(E),!g(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(!G()||E instanceof Uint8Array||(E=H(E)),!(_=this["process"+B.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return _.fileType=B,_}})(We.API),function(r){var e=function(t){if(t!==void 0&&t!="")return!0};We.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var n,i,s,l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(t.objId),m=t.pageContext.annotations,g=!1,v=0;v<m.length&&!g;v++)switch((n=m[v]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(g=!0);break;case"reference":case"text":case"freetext":g=!0}if(g!=0){this.internal.write("/Annots [");for(var y=0;y<m.length;y++){n=m[y];var p=this.internal.pdfEscape,N=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),I=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(b.objId),S=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+l(n.bounds.x)+" "+u(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w)+" "+u(n.bounds.y)+"] ")+"/Contents ("+p(w(n.contents))+")",s+=" /Popup "+I.objId+" 0 R",s+=" /P "+d.objId+" 0 R",s+=" /T ("+p(w(S))+") >>",b.content=s;var T=b.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+l(n.bounds.x+30)+" "+u(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w+30)+" "+u(n.bounds.y)+"] ")+" /Parent "+T,n.open&&(s+=" /Open true"),s+=" >>",I.content=s,this.internal.write(b.objId,"0 R",I.objId,"0 R");break;case"freetext":i="/Rect ["+l(n.bounds.x)+" "+u(n.bounds.y)+" "+l(n.bounds.x+n.bounds.w)+" "+u(n.bounds.y+n.bounds.h)+"] ";var W=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(N(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+W+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var G=this.annotations._nameMap[n.options.name];n.options.pageNumber=G.page,n.options.top=G.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(N(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var te=u(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+te+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},r.link=function(t,n,i,s,l){var u=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString;u.pageContext.annotations.push({finalBounds:{x:d(t),y:m(n),w:d(t+i),h:m(n+s)},options:l,type:"link"})},r.textWithLink=function(t,n,i,s){var l,u,d=this.getTextWidth(t),m=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){u=s.maxWidth;var g=this.splitTextToSize(t,u).length;l=Math.ceil(m*g)}else u=d,l=m;return this.text(t,n,i,s),i+=.2*m,s.align==="center"&&(n-=d/2),s.align==="right"&&(n-=d),this.link(n,i-m,u,l,s),d},r.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(We.API),function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(b){return e[b.charCodeAt(0)]!==void 0},l=r.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},u=r.__arabicParser__.isArabicEndLetter=function(b){return l(b)&&s(b)&&e[b.charCodeAt(0)].length<=2},d=r.__arabicParser__.isArabicAlfLetter=function(b){return l(b)&&i.indexOf(b.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return l(b)&&s(b)&&e[b.charCodeAt(0)].length>=1};var m=r.__arabicParser__.arabicLetterHasFinalForm=function(b){return l(b)&&s(b)&&e[b.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(b){return l(b)&&s(b)&&e[b.charCodeAt(0)].length>=3};var g=r.__arabicParser__.arabicLetterHasMedialForm=function(b){return l(b)&&s(b)&&e[b.charCodeAt(0)].length==4},v=r.__arabicParser__.resolveLigatures=function(b){var I=0,w=t,S="",T=0;for(I=0;I<b.length;I+=1)w[b.charCodeAt(I)]!==void 0?(T++,typeof(w=w[b.charCodeAt(I)])=="number"&&(S+=String.fromCharCode(w),w=t,T=0),I===b.length-1&&(w=t,S+=b.charAt(I-(T-1)),I-=T-1,T=0)):(w=t,S+=b.charAt(I-T),I-=T,T=0);return S};r.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&n[b.charCodeAt(0)]!==void 0};var y=r.__arabicParser__.getCorrectForm=function(b,I,w){return l(b)?s(b)===!1?-1:!m(b)||!l(I)&&!l(w)||!l(w)&&u(I)||u(b)&&!l(I)||u(b)&&d(I)||u(b)&&u(I)?0:g(b)&&l(I)&&!u(I)&&l(w)&&m(w)?3:u(b)||!l(w)?1:2:-1},p=function(b){var I=0,w=0,S=0,T="",W="",G="",te=(b=b||"").split("\\s+"),H=[];for(I=0;I<te.length;I+=1){for(H.push(""),w=0;w<te[I].length;w+=1)T=te[I][w],W=te[I][w-1],G=te[I][w+1],l(T)?(S=y(T,W,G),H[I]+=S!==-1?String.fromCharCode(e[T.charCodeAt(0)][S]):T):H[I]+=T;H[I]=v(H[I])}return H.join(" ")},N=r.__arabicParser__.processArabic=r.processArabic=function(){var b,I=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(I)){var S=0;for(w=[],S=0;S<I.length;S+=1)Array.isArray(I[S])?w.push([p(I[S][0]),I[S][1],I[S][2]]):w.push([p(I[S])]);b=w}else b=p(I);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};r.events.push(["preProcessText",N])}(We.API),We.API.autoPrint=function(r){var e;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(u){t=u}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(u){n=isNaN(u)||Number.isInteger(u)===!1||u<0?150:u,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(u){i=isNaN(u)||Number.isInteger(u)===!1||u<0?300:u,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(u){s=u}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(u){l=u}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var i;if((t=t||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(We.API),function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(b){d=b}});var m=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return m},set:function(b){m=b}});var g=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return g},set:function(b){g=b}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(b){v=b}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(b){y=b}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(b){p=b}});var N=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return N},set:function(b){N=b}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(d){return n.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},r.getTextDimensions=function(d,m){n.call(this);var g=(m=m||{}).fontSize||this.getFontSize(),v=m.font||this.getFont(),y=m.scaleFactor||this.internal.scaleFactor,p=0,N=0,b=0,I=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var w=m.maxWidth;w>0?typeof d=="string"?d=this.splitTextToSize(d,w):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(T,W){return T.concat(I.splitTextToSize(W,w))},[])):d=Array.isArray(d)?d:[d];for(var S=0;S<d.length;S++)p<(b=this.getStringUnitWidth(d[S],{font:v})*g)&&(p=b);return p!==0&&(N=d.length),{w:p/=y,h:Math.max((N*g*this.getLineHeightFactor()-g*(this.getLineHeightFactor()-1))/y,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var d=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=r.cell=function(){var d;d=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var m=this.internal.__cell__.lastCell,g=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,y=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return m.lineNumber!==void 0&&(m.lineNumber===d.lineNumber?(d.x=(m.x||0)+(m.width||0),d.y=m.y||0):m.y+m.height+d.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=v.top,p&&y&&(this.printHeaderRow(d.lineNumber,!0),d.y+=y[0].height)):d.y=m.y+m.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,t===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-g,d.y+g,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+g,{align:"center",baseline:"top",maxWidth:d.width-g-g}):this.text(d.text,d.x+g,d.y+g,{align:"left",baseline:"top",maxWidth:d.width-g-g})),this.internal.__cell__.lastCell=d,this};r.table=function(d,m,g,v,y){if(n.call(this),!g)throw new Error("No data for PDF table.");var p,N,b,I,w=[],S=[],T=[],W={},G={},te=[],H=[],M=(y=y||{}).autoSize||!1,Q=y.printHeaders!==!1,ce=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,E=y.margins||Object.assign({width:this.getPageWidth()},e),_=typeof y.padding=="number"?y.padding:3,B=y.headerBackgroundColor||"#c8c8c8",q=y.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=Q,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=ce,this.internal.__cell__.padding=_,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=q,this.setFontSize(ce),v==null)S=w=Object.keys(g[0]),T=w.map(function(){return"left"});else if(Array.isArray(v)&&vt(v[0])==="object")for(w=v.map(function(ee){return ee.name}),S=v.map(function(ee){return ee.prompt||ee.name||""}),T=v.map(function(ee){return ee.align||"left"}),p=0;p<v.length;p+=1)G[v[p].name]=v[p].width*(19.049976/25.4);else Array.isArray(v)&&typeof v[0]=="string"&&(S=w=v,T=w.map(function(){return"left"}));if(M||Array.isArray(v)&&typeof v[0]=="string")for(p=0;p<w.length;p+=1){for(W[I=w[p]]=g.map(function(ee){return ee[I]}),this.setFont(void 0,"bold"),te.push(this.getTextDimensions(S[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),N=W[I],this.setFont(void 0,"normal"),b=0;b<N.length;b+=1)te.push(this.getTextDimensions(N[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);G[I]=Math.max.apply(null,te)+_+_,te=[]}if(Q){var ae={};for(p=0;p<w.length;p+=1)ae[w[p]]={},ae[w[p]].text=S[p],ae[w[p]].align=T[p];var K=u.call(this,ae,G);H=w.map(function(ee){return new s(d,m,G[ee],K,ae[ee].text,void 0,ae[ee].align)}),this.setTableHeaderRow(H),this.printHeaderRow(1,!1)}var fe=v.reduce(function(ee,Le){return ee[Le.name]=Le.align,ee},{});for(p=0;p<g.length;p+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:p,data:g[p]},this);var se=u.call(this,g[p],G);for(b=0;b<w.length;b+=1){var me=g[p][w[b]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:p,col:b,data:me},this),l.call(this,new s(d,m,G[w[b]],se,me,p+2,fe[w[b]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=m,this};var u=function(d,m){var g=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(d).map(function(p){var N=d[p];return this.splitTextToSize(N.hasOwnProperty("text")?N.text:N,m[p]-g-g)},this).map(function(p){return this.getLineHeightFactor()*p.length*v/y+g+g},this).reduce(function(p,N){return Math.max(p,N)},0)};r.setTableHeaderRow=function(d){n.call(this),this.internal.__cell__.tableHeaderRow=d},r.printHeaderRow=function(d,m){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var g;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){g=this.internal.__cell__.tableHeaderRow[p].clone(),m&&(g.y=this.internal.__cell__.margins.top||0,y.push(g)),g.lineNumber=d;var N=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,g),this.setTextColor(N)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),t=!1}}(We.API);var xh={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},yh=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],yc=vh(yh),bh=[100,200,300,400,500,600,700,800,900],D2=vh(bh);function bc(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=function(s){return xh[s=s||"normal"]?s:"normal"}(r.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(r.weight),i=function(s){return typeof yc[s=s||"normal"]=="number"?s:"normal"}(r.stretch);return{family:e,style:t,weight:n,stretch:i,src:r.src||[],ref:r.ref||{name:e,style:[i,t,n].join(" ")}}}function Zu(r,e,t,n){var i;for(i=t;i>=0&&i<e.length;i+=n)if(r[e[i]])return r[e[i]];for(i=t;i>=0&&i<e.length;i-=n)if(r[e[i]])return r[e[i]]}var R2={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},ed={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function td(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function F2(r,e,t){for(var n=(t=t||{}).defaultFontFamily||"times",i=Object.assign({},R2,t.genericFontFamilies||{}),s=null,l=null,u=0;u<e.length;++u)if(i[(s=bc(e[u])).family]&&(s.family=i[s.family]),r.hasOwnProperty(s.family)){l=r[s.family];break}if(!(l=l||r[n]))throw new Error("Could not find a font-family for the rule '"+td(s)+"' and default family '"+n+"'.");if(l=function(d,m){if(m[d])return m[d];var g=yc[d],v=g<=yc.normal?-1:1,y=Zu(m,yh,g,v);if(!y)throw new Error("Could not find a matching font-stretch value for "+d);return y}(s.stretch,l),l=function(d,m){if(m[d])return m[d];for(var g=xh[d],v=0;v<g.length;++v)if(m[g[v]])return m[g[v]];throw new Error("Could not find a matching font-style for "+d)}(s.style,l),!(l=function(d,m){if(m[d])return m[d];if(d===400&&m[500])return m[500];if(d===500&&m[400])return m[400];var g=D2[d],v=Zu(m,bh,g,d<400?-1:1);if(!v)throw new Error("Could not find a matching font-weight for value "+d);return v}(s.weight,l)))throw new Error("Failed to resolve a font for the rule '"+td(s)+"'.");return l}function rd(r){return r.trimLeft()}function M2(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function B2(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var vo,nd,id,Yl=["times"];(function(r){var e,t,n,i,s,l,u,d,m,g=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new d,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new l,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new l,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,u=this.internal.Rectangle,d=this.internal.Matrix,m=new g}]);var v=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var R=k;Object.defineProperty(this,"pdf",{get:function(){return R}});var z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return z},set:function(ve){z=!!ve}});var Y=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Y},set:function(ve){Y=!!ve}});var ne=0;Object.defineProperty(this,"posX",{get:function(){return ne},set:function(ve){isNaN(ve)||(ne=ve)}});var ue=0;Object.defineProperty(this,"posY",{get:function(){return ue},set:function(ve){isNaN(ve)||(ue=ve)}}),Object.defineProperty(this,"margin",{get:function(){return m.margin},set:function(ve){var U;typeof ve=="number"?U=[ve,ve,ve,ve]:((U=new Array(4))[0]=ve[0],U[1]=ve.length>=2?ve[1]:U[0],U[2]=ve.length>=3?ve[2]:U[0],U[3]=ve.length>=4?ve[3]:U[1]),m.margin=U}});var de=!1;Object.defineProperty(this,"autoPaging",{get:function(){return de},set:function(ve){de=ve}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(ve){he=ve}});var Se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Se},set:function(ve){Se=ve}}),Object.defineProperty(this,"ctx",{get:function(){return m},set:function(ve){ve instanceof g&&(m=ve)}}),Object.defineProperty(this,"path",{get:function(){return m.path},set:function(ve){m.path=ve}});var Ae=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ae},set:function(ve){Ae=ve}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ve){var U;U=y(ve),this.ctx.fillStyle=U.style,this.ctx.isFillTransparent=U.a===0,this.ctx.fillOpacity=U.a,this.pdf.setFillColor(U.r,U.g,U.b,{a:U.a}),this.pdf.setTextColor(U.r,U.g,U.b,{a:U.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ve){var U=y(ve);this.ctx.strokeStyle=U.style,this.ctx.isStrokeTransparent=U.a===0,this.ctx.strokeOpacity=U.a,U.a===0?this.pdf.setDrawColor(255,255,255):(U.a,this.pdf.setDrawColor(U.r,U.g,U.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ve){["butt","round","square"].indexOf(ve)!==-1&&(this.ctx.lineCap=ve,this.pdf.setLineCap(ve))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ve){isNaN(ve)||(this.ctx.lineWidth=ve,this.pdf.setLineWidth(ve))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ve){["bevel","round","miter"].indexOf(ve)!==-1&&(this.ctx.lineJoin=ve,this.pdf.setLineJoin(ve))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ve){isNaN(ve)||(this.ctx.miterLimit=ve,this.pdf.setMiterLimit(ve))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ve){this.ctx.textBaseline=ve}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ve){["right","end","center","left","start"].indexOf(ve)!==-1&&(this.ctx.textAlign=ve)}});var Ee=null;function _e(ve,U){if(Ee===null){var Ze=function(Me){var je=[];return Object.keys(Me).forEach(function(Pe){Me[Pe].forEach(function(Oe){var Ie=null;switch(Oe){case"bold":Ie={family:Pe,weight:"bold"};break;case"italic":Ie={family:Pe,style:"italic"};break;case"bolditalic":Ie={family:Pe,weight:"bold",style:"italic"};break;case"":case"normal":Ie={family:Pe}}Ie!==null&&(Ie.ref={name:Pe,style:Oe},je.push(Ie))})}),je}(ve.getFontList());Ee=function(Me){for(var je={},Pe=0;Pe<Me.length;++Pe){var Oe=bc(Me[Pe]),Ie=Oe.family,Be=Oe.stretch,Ye=Oe.style,rt=Oe.weight;je[Ie]=je[Ie]||{},je[Ie][Be]=je[Ie][Be]||{},je[Ie][Be][Ye]=je[Ie][Be][Ye]||{},je[Ie][Be][Ye][rt]=Oe}return je}(Ze.concat(U))}return Ee}var Ve=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ve},set:function(ve){Ee=null,Ve=ve}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ve){var U;if(this.ctx.font=ve,(U=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ve))!==null){var Ze=U[1];U[2];var Me=U[3],je=U[4];U[5];var Pe=U[6],Oe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(je)[2];je=Math.floor(Oe==="px"?parseFloat(je)*this.pdf.internal.scaleFactor:Oe==="em"?parseFloat(je)*this.pdf.getFontSize():parseFloat(je)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(je);var Ie=function(Ge){var it,Te,tr=[],ut=Ge.trim();if(ut==="")return Yl;if(ut in ed)return[ed[ut]];for(;ut!=="";){switch(Te=null,it=(ut=rd(ut)).charAt(0)){case'"':case"'":Te=M2(ut.substring(1),it);break;default:Te=B2(ut)}if(Te===null||(tr.push(Te[0]),(ut=rd(Te[1]))!==""&&ut.charAt(0)!==","))return Yl;ut=ut.replace(/^,/,"")}return tr}(Pe);if(this.fontFaces){var Be=F2(_e(this.pdf,this.fontFaces),Ie.map(function(Ge){return{family:Ge,stretch:"normal",weight:Me,style:Ze}}));this.pdf.setFont(Be.ref.name,Be.ref.style)}else{var Ye="";(Me==="bold"||parseInt(Me,10)>=700||Ze==="bold")&&(Ye="bold"),Ze==="italic"&&(Ye+="italic"),Ye.length===0&&(Ye="normal");for(var rt="",nt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},lt=0;lt<Ie.length;lt++){if(this.pdf.internal.getFont(Ie[lt],Ye,{noFallback:!0,disableWarning:!0})!==void 0){rt=Ie[lt];break}if(Ye==="bolditalic"&&this.pdf.internal.getFont(Ie[lt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)rt=Ie[lt],Ye="bold";else if(this.pdf.internal.getFont(Ie[lt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){rt=Ie[lt],Ye="normal";break}}if(rt===""){for(var xt=0;xt<Ie.length;xt++)if(nt[Ie[xt]]){rt=nt[Ie[xt]];break}}rt=rt===""?"Times":rt,this.pdf.setFont(rt,Ye)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ve){this.ctx.globalCompositeOperation=ve}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ve){this.ctx.globalAlpha=ve}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ve){this.ctx.lineDashOffset=ve,Le.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ve){this.ctx.lineDash=ve,Le.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ve){this.ctx.ignoreClearRect=!!ve}})};v.prototype.setLineDash=function(k){this.lineDash=k},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){W.call(this,"fill",!1)},v.prototype.stroke=function(){W.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(k,R){if(isNaN(k)||isNaN(R))throw Nt.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var z=this.ctx.transform.applyToPoint(new l(k,R));this.path.push({type:"mt",x:z.x,y:z.y}),this.ctx.lastPoint=new l(k,R)},v.prototype.closePath=function(){var k=new l(0,0),R=0;for(R=this.path.length-1;R!==-1;R--)if(this.path[R].type==="begin"&&vt(this.path[R+1])==="object"&&typeof this.path[R+1].x=="number"){k=new l(this.path[R+1].x,this.path[R+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(k.x,k.y)},v.prototype.lineTo=function(k,R){if(isNaN(k)||isNaN(R))throw Nt.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var z=this.ctx.transform.applyToPoint(new l(k,R));this.path.push({type:"lt",x:z.x,y:z.y}),this.ctx.lastPoint=new l(z.x,z.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),W.call(this,null,!0)},v.prototype.quadraticCurveTo=function(k,R,z,Y){if(isNaN(z)||isNaN(Y)||isNaN(k)||isNaN(R))throw Nt.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ne=this.ctx.transform.applyToPoint(new l(z,Y)),ue=this.ctx.transform.applyToPoint(new l(k,R));this.path.push({type:"qct",x1:ue.x,y1:ue.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new l(ne.x,ne.y)},v.prototype.bezierCurveTo=function(k,R,z,Y,ne,ue){if(isNaN(ne)||isNaN(ue)||isNaN(k)||isNaN(R)||isNaN(z)||isNaN(Y))throw Nt.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var de=this.ctx.transform.applyToPoint(new l(ne,ue)),he=this.ctx.transform.applyToPoint(new l(k,R)),Se=this.ctx.transform.applyToPoint(new l(z,Y));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:Se.x,y2:Se.y,x:de.x,y:de.y}),this.ctx.lastPoint=new l(de.x,de.y)},v.prototype.arc=function(k,R,z,Y,ne,ue){if(isNaN(k)||isNaN(R)||isNaN(z)||isNaN(Y)||isNaN(ne))throw Nt.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ue=!!ue,!this.ctx.transform.isIdentity){var de=this.ctx.transform.applyToPoint(new l(k,R));k=de.x,R=de.y;var he=this.ctx.transform.applyToPoint(new l(0,z)),Se=this.ctx.transform.applyToPoint(new l(0,0));z=Math.sqrt(Math.pow(he.x-Se.x,2)+Math.pow(he.y-Se.y,2))}Math.abs(ne-Y)>=2*Math.PI&&(Y=0,ne=2*Math.PI),this.path.push({type:"arc",x:k,y:R,radius:z,startAngle:Y,endAngle:ne,counterclockwise:ue})},v.prototype.arcTo=function(k,R,z,Y,ne){throw new Error("arcTo not implemented.")},v.prototype.rect=function(k,R,z,Y){if(isNaN(k)||isNaN(R)||isNaN(z)||isNaN(Y))throw Nt.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,R),this.lineTo(k+z,R),this.lineTo(k+z,R+Y),this.lineTo(k,R+Y),this.lineTo(k,R),this.lineTo(k+z,R),this.lineTo(k,R)},v.prototype.fillRect=function(k,R,z,Y){if(isNaN(k)||isNaN(R)||isNaN(z)||isNaN(Y))throw Nt.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var ne={};this.lineCap!=="butt"&&(ne.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ne.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,R,z,Y),this.fill(),ne.hasOwnProperty("lineCap")&&(this.lineCap=ne.lineCap),ne.hasOwnProperty("lineJoin")&&(this.lineJoin=ne.lineJoin)}},v.prototype.strokeRect=function(k,R,z,Y){if(isNaN(k)||isNaN(R)||isNaN(z)||isNaN(Y))throw Nt.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");N.call(this)||(this.beginPath(),this.rect(k,R,z,Y),this.stroke())},v.prototype.clearRect=function(k,R,z,Y){if(isNaN(k)||isNaN(R)||isNaN(z)||isNaN(Y))throw Nt.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,R,z,Y))},v.prototype.save=function(k){k=typeof k!="boolean"||k;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("q");if(this.pdf.setPage(R),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var Y=new g(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Y}},v.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("Q");this.pdf.setPage(R),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(k){var R,z,Y,ne;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))R=0,z=0,Y=0,ne=0;else{var ue=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(ue!==null)R=parseInt(ue[1]),z=parseInt(ue[2]),Y=parseInt(ue[3]),ne=1;else if((ue=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)R=parseInt(ue[1]),z=parseInt(ue[2]),Y=parseInt(ue[3]),ne=parseFloat(ue[4]);else{if(ne=1,typeof k=="string"&&k.charAt(0)!=="#"){var de=new dh(k);k=de.ok?de.toHex():"#000000"}k.length===4?(R=k.substring(1,2),R+=R,z=k.substring(2,3),z+=z,Y=k.substring(3,4),Y+=Y):(R=k.substring(1,3),z=k.substring(3,5),Y=k.substring(5,7)),R=parseInt(R,16),z=parseInt(z,16),Y=parseInt(Y,16)}}return{r:R,g:z,b:Y,a:ne,style:k}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},N=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(k,R,z,Y){if(isNaN(R)||isNaN(z)||typeof k!="string")throw Nt.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Y=isNaN(Y)?void 0:Y,!p.call(this)){var ne=se(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;_.call(this,{text:k,x:R,y:z,scale:ue,angle:ne,align:this.textAlign,maxWidth:Y})}},v.prototype.strokeText=function(k,R,z,Y){if(isNaN(R)||isNaN(z)||typeof k!="string")throw Nt.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!N.call(this)){Y=isNaN(Y)?void 0:Y;var ne=se(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;_.call(this,{text:k,x:R,y:z,scale:ue,renderingMode:"stroke",angle:ne,align:this.textAlign,maxWidth:Y})}},v.prototype.measureText=function(k){if(typeof k!="string")throw Nt.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var R=this.pdf,z=this.pdf.internal.scaleFactor,Y=R.internal.getFontSize(),ne=R.getStringUnitWidth(k)*Y/R.internal.scaleFactor,ue=function(de){var he=(de=de||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this};return new ue({width:ne*=Math.round(96*z/72*1e4)/1e4})},v.prototype.scale=function(k,R){if(isNaN(k)||isNaN(R))throw Nt.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var z=new d(k,0,0,R,0,0);this.ctx.transform=this.ctx.transform.multiply(z)},v.prototype.rotate=function(k){if(isNaN(k))throw Nt.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var R=new d(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(R)},v.prototype.translate=function(k,R){if(isNaN(k)||isNaN(R))throw Nt.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var z=new d(1,0,0,1,k,R);this.ctx.transform=this.ctx.transform.multiply(z)},v.prototype.transform=function(k,R,z,Y,ne,ue){if(isNaN(k)||isNaN(R)||isNaN(z)||isNaN(Y)||isNaN(ne)||isNaN(ue))throw Nt.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var de=new d(k,R,z,Y,ne,ue);this.ctx.transform=this.ctx.transform.multiply(de)},v.prototype.setTransform=function(k,R,z,Y,ne,ue){k=isNaN(k)?1:k,R=isNaN(R)?0:R,z=isNaN(z)?0:z,Y=isNaN(Y)?1:Y,ne=isNaN(ne)?0:ne,ue=isNaN(ue)?0:ue,this.ctx.transform=new d(k,R,z,Y,ne,ue)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(k,R,z,Y,ne,ue,de,he,Se){var Ae=this.pdf.getImageProperties(k),Ee=1,_e=1,Ve=1,ve=1;Y!==void 0&&he!==void 0&&(Ve=he/Y,ve=Se/ne,Ee=Ae.width/Y*he/Y,_e=Ae.height/ne*Se/ne),ue===void 0&&(ue=R,de=z,R=0,z=0),Y!==void 0&&he===void 0&&(he=Y,Se=ne),Y===void 0&&he===void 0&&(he=Ae.width,Se=Ae.height);for(var U,Ze=this.ctx.transform.decompose(),Me=se(Ze.rotate.shx),je=new d,Pe=(je=(je=(je=je.multiply(Ze.translate)).multiply(Ze.skew)).multiply(Ze.scale)).applyToRectangle(new u(ue-R*Ve,de-z*ve,Y*Ee,ne*_e)),Oe=I.call(this,Pe),Ie=[],Be=0;Be<Oe.length;Be+=1)Ie.indexOf(Oe[Be])===-1&&Ie.push(Oe[Be]);if(T(Ie),this.autoPaging)for(var Ye=Ie[0],rt=Ie[Ie.length-1],nt=Ye;nt<rt+1;nt++){this.pdf.setPage(nt);var lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=nt===1?this.posY+this.margin[0]:this.margin[0],Ge=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],it=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Te=nt===1?0:Ge+(nt-2)*it;if(this.ctx.clip_path.length!==0){var tr=this.path;U=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(U,this.posX+this.margin[3],-Te+xt+this.ctx.prevPageLastElemOffset),G.call(this,"fill",!0),this.path=tr}var ut=JSON.parse(JSON.stringify(Pe));ut=S([ut],this.posX+this.margin[3],-Te+xt+this.ctx.prevPageLastElemOffset)[0];var Ur=(nt>Ye||nt<rt)&&b.call(this);Ur&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,it,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",ut.x,ut.y,ut.w,ut.h,null,null,Me),Ur&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",Pe.x,Pe.y,Pe.w,Pe.h,null,null,Me)};var I=function(k,R,z){var Y=[];R=R||this.pdf.internal.pageSize.width,z=z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ne=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":Y.push(Math.floor((k.y+ne)/z)+1);break;case"arc":Y.push(Math.floor((k.y+ne-k.radius)/z)+1),Y.push(Math.floor((k.y+ne+k.radius)/z)+1);break;case"qct":var ue=me(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);Y.push(Math.floor((ue.y+ne)/z)+1),Y.push(Math.floor((ue.y+ue.h+ne)/z)+1);break;case"bct":var de=ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);Y.push(Math.floor((de.y+ne)/z)+1),Y.push(Math.floor((de.y+de.h+ne)/z)+1);break;case"rect":Y.push(Math.floor((k.y+ne)/z)+1),Y.push(Math.floor((k.y+k.h+ne)/z)+1)}for(var he=0;he<Y.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<Y[he];)w.call(this);return Y},w=function(){var k=this.fillStyle,R=this.strokeStyle,z=this.font,Y=this.lineCap,ne=this.lineWidth,ue=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=R,this.font=z,this.lineCap=Y,this.lineWidth=ne,this.lineJoin=ue},S=function(k,R,z){for(var Y=0;Y<k.length;Y++)switch(k[Y].type){case"bct":k[Y].x2+=R,k[Y].y2+=z;case"qct":k[Y].x1+=R,k[Y].y1+=z;case"mt":case"lt":case"arc":default:k[Y].x+=R,k[Y].y+=z}return k},T=function(k){return k.sort(function(R,z){return R-z})},W=function(k,R){for(var z,Y,ne=this.fillStyle,ue=this.strokeStyle,de=this.lineCap,he=this.lineWidth,Se=Math.abs(he*this.ctx.transform.scaleX),Ae=this.lineJoin,Ee=JSON.parse(JSON.stringify(this.path)),_e=JSON.parse(JSON.stringify(this.path)),Ve=[],ve=0;ve<_e.length;ve++)if(_e[ve].x!==void 0)for(var U=I.call(this,_e[ve]),Ze=0;Ze<U.length;Ze+=1)Ve.indexOf(U[Ze])===-1&&Ve.push(U[Ze]);for(var Me=0;Me<Ve.length;Me++)for(;this.pdf.internal.getNumberOfPages()<Ve[Me];)w.call(this);if(T(Ve),this.autoPaging)for(var je=Ve[0],Pe=Ve[Ve.length-1],Oe=je;Oe<Pe+1;Oe++){this.pdf.setPage(Oe),this.fillStyle=ne,this.strokeStyle=ue,this.lineCap=de,this.lineWidth=Se,this.lineJoin=Ae;var Ie=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Be=Oe===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],rt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],nt=Oe===1?0:Ye+(Oe-2)*rt;if(this.ctx.clip_path.length!==0){var lt=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(z,this.posX+this.margin[3],-nt+Be+this.ctx.prevPageLastElemOffset),G.call(this,k,!0),this.path=lt}if(Y=JSON.parse(JSON.stringify(Ee)),this.path=S(Y,this.posX+this.margin[3],-nt+Be+this.ctx.prevPageLastElemOffset),R===!1||Oe===0){var xt=(Oe>je||Oe<Pe)&&b.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ie,rt,null).clip().discardPath()),G.call(this,k,R),xt&&this.pdf.restoreGraphicsState()}this.lineWidth=he}else this.lineWidth=Se,G.call(this,k,R),this.lineWidth=he;this.path=Ee},G=function(k,R){if((k!=="stroke"||R||!N.call(this))&&(k==="stroke"||R||!p.call(this))){for(var z,Y,ne=[],ue=this.path,de=0;de<ue.length;de++){var he=ue[de];switch(he.type){case"begin":ne.push({begin:!0});break;case"close":ne.push({close:!0});break;case"mt":ne.push({start:he,deltas:[],abs:[]});break;case"lt":var Se=ne.length;if(ue[de-1]&&!isNaN(ue[de-1].x)&&(z=[he.x-ue[de-1].x,he.y-ue[de-1].y],Se>0)){for(;Se>=0;Se--)if(ne[Se-1].close!==!0&&ne[Se-1].begin!==!0){ne[Se-1].deltas.push(z),ne[Se-1].abs.push(he);break}}break;case"bct":z=[he.x1-ue[de-1].x,he.y1-ue[de-1].y,he.x2-ue[de-1].x,he.y2-ue[de-1].y,he.x-ue[de-1].x,he.y-ue[de-1].y],ne[ne.length-1].deltas.push(z);break;case"qct":var Ae=ue[de-1].x+2/3*(he.x1-ue[de-1].x),Ee=ue[de-1].y+2/3*(he.y1-ue[de-1].y),_e=he.x+2/3*(he.x1-he.x),Ve=he.y+2/3*(he.y1-he.y),ve=he.x,U=he.y;z=[Ae-ue[de-1].x,Ee-ue[de-1].y,_e-ue[de-1].x,Ve-ue[de-1].y,ve-ue[de-1].x,U-ue[de-1].y],ne[ne.length-1].deltas.push(z);break;case"arc":ne.push({deltas:[],abs:[],arc:!0}),Array.isArray(ne[ne.length-1].abs)&&ne[ne.length-1].abs.push(he)}}Y=R?null:k==="stroke"?"stroke":"fill";for(var Ze=!1,Me=0;Me<ne.length;Me++)if(ne[Me].arc)for(var je=ne[Me].abs,Pe=0;Pe<je.length;Pe++){var Oe=je[Pe];Oe.type==="arc"?M.call(this,Oe.x,Oe.y,Oe.radius,Oe.startAngle,Oe.endAngle,Oe.counterclockwise,void 0,R,!Ze):B.call(this,Oe.x,Oe.y),Ze=!0}else if(ne[Me].close===!0)this.pdf.internal.out("h"),Ze=!1;else if(ne[Me].begin!==!0){var Ie=ne[Me].start.x,Be=ne[Me].start.y;q.call(this,ne[Me].deltas,Ie,Be),Ze=!0}Y&&Q.call(this,Y),R&&ce.call(this)}},te=function(k){var R=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,z=R*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-z;case"top":return k+R-z;case"hanging":return k+R-2*z;case"middle":return k+R/2-z;case"ideographic":return k;case"alphabetic":default:return k}},H=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(R,z){this.colorStops.push([R,z])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var M=function(k,R,z,Y,ne,ue,de,he,Se){for(var Ae=K.call(this,z,Y,ne,ue),Ee=0;Ee<Ae.length;Ee++){var _e=Ae[Ee];Ee===0&&(Se?E.call(this,_e.x1+k,_e.y1+R):B.call(this,_e.x1+k,_e.y1+R)),ae.call(this,k,R,_e.x2,_e.y2,_e.x3,_e.y3,_e.x4,_e.y4)}he?ce.call(this):Q.call(this,de)},Q=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ce=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(k,R){this.pdf.internal.out(t(k)+" "+n(R)+" m")},_=function(k){var R;switch(k.align){case"right":case"end":R="right";break;case"center":R="center";break;case"left":case"start":default:R="left"}var z=this.pdf.getTextDimensions(k.text),Y=te.call(this,k.y),ne=H.call(this,Y)-z.h,ue=this.ctx.transform.applyToPoint(new l(k.x,Y)),de=this.ctx.transform.decompose(),he=new d;he=(he=(he=he.multiply(de.translate)).multiply(de.skew)).multiply(de.scale);for(var Se,Ae,Ee,_e=this.ctx.transform.applyToRectangle(new u(k.x,Y,z.w,z.h)),Ve=he.applyToRectangle(new u(k.x,ne,z.w,z.h)),ve=I.call(this,Ve),U=[],Ze=0;Ze<ve.length;Ze+=1)U.indexOf(ve[Ze])===-1&&U.push(ve[Ze]);if(T(U),this.autoPaging)for(var Me=U[0],je=U[U.length-1],Pe=Me;Pe<je+1;Pe++){this.pdf.setPage(Pe);var Oe=Pe===1?this.posY+this.margin[0]:this.margin[0],Ie=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Be=this.pdf.internal.pageSize.height-this.margin[2],Ye=Be-this.margin[0],rt=this.pdf.internal.pageSize.width-this.margin[1],nt=rt-this.margin[3],lt=Pe===1?0:Ie+(Pe-2)*Ye;if(this.ctx.clip_path.length!==0){var xt=this.path;Se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(Se,this.posX+this.margin[3],-1*lt+Oe),G.call(this,"fill",!0),this.path=xt}var Ge=S([JSON.parse(JSON.stringify(Ve))],this.posX+this.margin[3],-lt+Oe+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(Ae=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ae*k.scale),Ee=this.lineWidth,this.lineWidth=Ee*k.scale);var it=this.autoPaging!=="text";if(it||Ge.y+Ge.h<=Be){if(it||Ge.y>=Oe&&Ge.x<=rt){var Te=it?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||rt-Ge.x)[0],tr=S([JSON.parse(JSON.stringify(_e))],this.posX+this.margin[3],-lt+Oe+this.ctx.prevPageLastElemOffset)[0],ut=it&&(Pe>Me||Pe<je)&&b.call(this);ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],nt,Ye,null).clip().discardPath()),this.pdf.text(Te,tr.x,tr.y,{angle:k.angle,align:R,renderingMode:k.renderingMode}),ut&&this.pdf.restoreGraphicsState()}}else Ge.y<Be&&(this.ctx.prevPageLastElemOffset+=Be-Ge.y);k.scale>=.01&&(this.pdf.setFontSize(Ae),this.lineWidth=Ee)}else k.scale>=.01&&(Ae=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ae*k.scale),Ee=this.lineWidth,this.lineWidth=Ee*k.scale),this.pdf.text(k.text,ue.x+this.posX,ue.y+this.posY,{angle:k.angle,align:R,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(Ae),this.lineWidth=Ee)},B=function(k,R,z,Y){z=z||0,Y=Y||0,this.pdf.internal.out(t(k+z)+" "+n(R+Y)+" l")},q=function(k,R,z){return this.pdf.lines(k,R,z,null,null)},ae=function(k,R,z,Y,ne,ue,de,he){this.pdf.internal.out([e(i(z+k)),e(s(Y+R)),e(i(ne+k)),e(s(ue+R)),e(i(de+k)),e(s(he+R)),"c"].join(" "))},K=function(k,R,z,Y){for(var ne=2*Math.PI,ue=Math.PI/2;R>z;)R-=ne;var de=Math.abs(z-R);de<ne&&Y&&(de=ne-de);for(var he=[],Se=Y?-1:1,Ae=R;de>1e-5;){var Ee=Ae+Se*Math.min(de,ue);he.push(fe.call(this,k,Ae,Ee)),de-=Math.abs(Ee-Ae),Ae=Ee}return he},fe=function(k,R,z){var Y=(z-R)/2,ne=k*Math.cos(Y),ue=k*Math.sin(Y),de=ne,he=-ue,Se=de*de+he*he,Ae=Se+de*ne+he*ue,Ee=4/3*(Math.sqrt(2*Se*Ae)-Ae)/(de*ue-he*ne),_e=de-Ee*he,Ve=he+Ee*de,ve=_e,U=-Ve,Ze=Y+R,Me=Math.cos(Ze),je=Math.sin(Ze);return{x1:k*Math.cos(R),y1:k*Math.sin(R),x2:_e*Me-Ve*je,y2:_e*je+Ve*Me,x3:ve*Me-U*je,y3:ve*je+U*Me,x4:k*Math.cos(z),y4:k*Math.sin(z)}},se=function(k){return 180*k/Math.PI},me=function(k,R,z,Y,ne,ue){var de=k+.5*(z-k),he=R+.5*(Y-R),Se=ne+.5*(z-ne),Ae=ue+.5*(Y-ue),Ee=Math.min(k,ne,de,Se),_e=Math.max(k,ne,de,Se),Ve=Math.min(R,ue,he,Ae),ve=Math.max(R,ue,he,Ae);return new u(Ee,Ve,_e-Ee,ve-Ve)},ee=function(k,R,z,Y,ne,ue,de,he){var Se,Ae,Ee,_e,Ve,ve,U,Ze,Me,je,Pe,Oe,Ie,Be,Ye=z-k,rt=Y-R,nt=ne-z,lt=ue-Y,xt=de-ne,Ge=he-ue;for(Ae=0;Ae<41;Ae++)Me=(U=(Ee=k+(Se=Ae/40)*Ye)+Se*((Ve=z+Se*nt)-Ee))+Se*(Ve+Se*(ne+Se*xt-Ve)-U),je=(Ze=(_e=R+Se*rt)+Se*((ve=Y+Se*lt)-_e))+Se*(ve+Se*(ue+Se*Ge-ve)-Ze),Ae==0?(Pe=Me,Oe=je,Ie=Me,Be=je):(Pe=Math.min(Pe,Me),Oe=Math.min(Oe,je),Ie=Math.max(Ie,Me),Be=Math.max(Be,je));return new u(Math.round(Pe),Math.round(Oe),Math.round(Ie-Pe),Math.round(Be-Oe))},Le=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,R,z=(k=this.ctx.lineDash,R=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:R}));this.prevLineDash!==z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=z)}}})(We.API),function(r){var e=function(s){var l,u,d,m,g,v,y,p,N,b;for(u=[],d=0,m=(s+=l="\0\0\0\0".slice(s.length%4||4)).length;m>d;d+=4)(g=(s.charCodeAt(d)<<24)+(s.charCodeAt(d+1)<<16)+(s.charCodeAt(d+2)<<8)+s.charCodeAt(d+3))!==0?(v=(g=((g=((g=((g=(g-(b=g%85))/85)-(N=g%85))/85)-(p=g%85))/85)-(y=g%85))/85)%85,u.push(v+33,y+33,p+33,N+33,b+33)):u.push(122);return function(I,w){for(var S=w;S>0;S--)I.pop()}(u,l.length),String.fromCharCode.apply(String,u)+"~>"},t=function(s){var l,u,d,m,g,v=String,y="length",p=255,N="charCodeAt",b="slice",I="replace";for(s[b](-2),s=s[b](0,-2)[I](/\s/g,"")[I]("z","!!!!!"),d=[],m=0,g=(s+=l="uuuuu"[b](s[y]%5||5))[y];g>m;m+=5)u=52200625*(s[N](m)-33)+614125*(s[N](m+1)-33)+7225*(s[N](m+2)-33)+85*(s[N](m+3)-33)+(s[N](m+4)-33),d.push(p&u>>24,p&u>>16,p&u>>8,p&u);return function(w,S){for(var T=S;T>0;T--)w.pop()}(d,l[y]),v.fromCharCode.apply(v,d)},n=function(s){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),l.test(s)===!1)return"";for(var u="",d=0;d<s.length;d+=2)u+=String.fromCharCode("0x"+(s[d]+s[d+1]));return u},i=function(s){for(var l=new Uint8Array(s.length),u=s.length;u--;)l[u]=s.charCodeAt(u);return s=(l=pc(l)).reduce(function(d,m){return d+String.fromCharCode(m)},"")};r.processDataByFilters=function(s,l){var u=0,d=s||"",m=[];for(typeof(l=l||[])=="string"&&(l=[l]),u=0;u<l.length;u+=1)switch(l[u]){case"ASCII85Decode":case"/ASCII85Decode":d=t(d),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=e(d),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=n(d),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=d.split("").map(function(g){return("0"+g.charCodeAt().toString(16)).slice(-2)}).join("")+">",m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[u]+'" is not implemented')}return{data:d,reverseChain:m.reverse().join(" ")}}}(We.API),function(r){r.loadFile=function(e,t,n){return function(i,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var u=void 0;try{u=function(d,m,g){var v=new XMLHttpRequest,y=0,p=function(N){var b=N.length,I=[],w=String.fromCharCode;for(y=0;y<b;y+=1)I.push(w(255&N.charCodeAt(y)));return I.join("")};if(v.open("GET",d,!m),v.overrideMimeType("text/plain; charset=x-user-defined"),m===!1&&(v.onload=function(){v.status===200?g(p(this.responseText)):g(void 0)}),v.send(null),m&&v.status===200)return p(v.responseText)}(i,s,l)}catch{}return u}(e,t,n)},r.loadImageFile=r.loadFile}(We.API),function(r){function e(){return(He.html2canvas?Promise.resolve(He.html2canvas):Ns(()=>import("./html2canvas.esm-e0a7d97b.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function t(){return(He.DOMPurify?Promise.resolve(He.DOMPurify):Ns(()=>import("./purify.es-31816194.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var u=vt(l);return u==="undefined"?"undefined":u==="string"||l instanceof String?"string":u==="number"||l instanceof Number?"number":u==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(l,u){var d=document.createElement(l);for(var m in u.className&&(d.className=u.className),u.innerHTML&&u.dompurify&&(d.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)d.style[m]=u.style[m];return d},s=function l(u){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),m=l.convert(Promise.resolve(),d);return m=(m=m.setProgress(1,l,1,[l])).set(u)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(l,u){return l.__proto__=u||s.prototype,l},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(l,u){return this.then(function(){switch(u=u||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l)){case"string":return this.then(t).then(function(d){return this.set({src:i("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},s.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=function d(m,g){for(var v=m.nodeType===3?document.createTextNode(m.nodeValue):m.cloneNode(!1),y=m.firstChild;y;y=y.nextSibling)g!==!0&&y.nodeType===1&&y.nodeName==="SCRIPT"||v.appendChild(d(y,g));return m.nodeType===1&&(m.nodeName==="CANVAS"?(v.width=m.width,v.height=m.height,v.getContext("2d").drawImage(m,0,0)):m.nodeName!=="TEXTAREA"&&m.nodeName!=="SELECT"||(v.value=m.value),v.addEventListener("load",function(){v.scrollTop=m.scrollTop,v.scrollLeft=m.scrollLeft},!0)),v}(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(u){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,u(this.prop.container,d)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(u){var d=this.opt.jsPDF,m=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,v=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete v.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=m,m)for(var y=0;y<m.length;++y){var p=m[y],N=p.src.find(function(b){return b.format==="truetype"});N&&d.addFont(N.url,p.ref.name,p.ref.style)}return v.windowHeight=v.windowHeight||0,v.windowHeight=v.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):v.windowHeight,d.context2d.save(!0),u(this.prop.container,v)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(l,u,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,u):this.outputPdf(l,u)},s.prototype.outputPdf=function(l,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,u)})},s.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},s.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(l){if(n(l)!=="object")return this;var u=Object.keys(l||{}).map(function(d){if(d in s.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(u)})},s.prototype.get=function(l,u){return this.then(function(){var d=l in s.template.prop?this.prop[l]:this.opt[l];return u?u(d):d})},s.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},s.prototype.setPageSize=function(l){function u(d,m){return Math.floor(d*m/72*96)}return this.then(function(){(l=l||We.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:u(l.inner.width,l.k),height:u(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},s.prototype.setProgress=function(l,u,d,m){return l!=null&&(this.progress.val=l),u!=null&&(this.progress.state=u),d!=null&&(this.progress.n=d),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(l,u,d,m){return this.setProgress(l?this.progress.val+l:null,u||null,d?this.progress.n+d:null,m?this.progress.stack.concat(m):null)},s.prototype.then=function(l,u){var d=this;return this.thenCore(l,u,function(m,g){return d.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(v){return d.updateProgress(null,m),v}).then(m,g).then(function(v){return d.updateProgress(1),v})})},s.prototype.thenCore=function(l,u,d){d=d||Promise.prototype.then,l&&(l=l.bind(this)),u&&(u=u.bind(this));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),g=d.call(m,l,u);return s.convert(g,this.__proto__)},s.prototype.thenExternal=function(l,u){return Promise.prototype.then.call(this,l,u)},s.prototype.thenList=function(l){var u=this;return l.forEach(function(d){u=u.thenCore(d)}),u},s.prototype.catch=function(l){l&&(l=l.bind(this));var u=Promise.prototype.catch.call(this,l);return s.convert(u,this)},s.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},s.prototype.error=function(l){return this.then(function(){throw new Error(l)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,We.getPageSize=function(l,u,d){if(vt(l)==="object"){var m=l;l=m.orientation,u=m.unit||u,d=m.format||d}u=u||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var g,v=(""+d).toLowerCase(),y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+u}var p,N=0,b=0;if(y.hasOwnProperty(v))N=y[v][1]/g,b=y[v][0]/g;else try{N=d[1],b=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",b>N&&(p=b,b=N,N=p);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",N>b&&(p=b,b=N,N=p)}return{width:b,height:N,unit:u,k:g,orientation:l}},r.html=function(l,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(bc):null;var d=new s(u);return u.worker?d:d.from(l).doCallback()}}(We.API),We.API.addJS=function(r){return id=r,this.internal.events.subscribe("postPutResources",function(){vo=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(vo+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),nd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+id+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){vo!==void 0&&nd!==void 0&&this.internal.out("/Names <</JavaScript "+vo+" 0 R>>")}),this},function(r){var e;r.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=t.outline.render().split(/\r\n/),s=0;s<i.length;s++){var l=i[s],u=n.exec(l);if(u!=null){var d=u[1];t.internal.newObjectDeferredBegin(d,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var m=this.internal.pages.length,g=[];for(s=0;s<m;s++){var v=t.internal.newObject();g.push(v);var y=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<g.length;s++)t.internal.write("(page_"+(s+1)+")"+g[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,i,s){var l={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var l=n.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var u=this.count=this.count_r({count:0},l);if(u>0&&this.line("/Count "+u),l.options&&l.options.pageNumber){var d=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var m=0;m<n.children.length;m++)this.renderItems(n.children[m])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(We.API),function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,n,i,s,l,u){var d,m=this.decode.DCT_DECODE,g=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(d=function(v){for(var y,p=256*v.charCodeAt(4)+v.charCodeAt(5),N=v.length,b={width:0,height:0,numcomponents:1},I=4;I<N;I+=2){if(I+=p,e.indexOf(v.charCodeAt(I+1))!==-1){y=256*v.charCodeAt(I+5)+v.charCodeAt(I+6),b={width:256*v.charCodeAt(I+7)+v.charCodeAt(I+8),height:y,numcomponents:v.charCodeAt(I+9)};break}p=256*v.charCodeAt(I+2)+v.charCodeAt(I+3)}return b}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:u=this.color_spaces.DEVICE_GRAY;break;case 4:u=this.color_spaces.DEVICE_CMYK;break;case 3:u=this.color_spaces.DEVICE_RGB}g={data:t,width:d.width,height:d.height,colorSpace:u,bitsPerComponent:8,filter:m,index:n,alias:i}}return g}}(We.API);var ds,xo,sd,ad,od,q2=function(){var r,e,t;function n(s){var l,u,d,m,g,v,y,p,N,b,I,w,S,T;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},v=null;;){switch(l=this.readUInt32(),N=(function(){var W,G;for(G=[],W=0;W<4;++W)G.push(String.fromCharCode(this.data[this.pos++]));return G}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":v&&this.animation.frames.push(v),this.pos+=4,v={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},g=this.readUInt16(),m=this.readUInt16()||100,v.delay=1e3*g/m,v.disposeOp=this.data[this.pos++],v.blendOp=this.data[this.pos++],v.data=[];break;case"IDAT":case"fdAT":for(N==="fdAT"&&(this.pos+=4,l-=4),s=(v!=null?v.data:void 0)||this.imgData,w=0;0<=l?w<l:w>l;0<=l?++w:--w)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(d=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>d)throw new Error("More transparent colors than palette size");if((b=d-this.transparency.indexed.length)>0)for(S=0;0<=b?S<b:S>b;0<=b?++S:--S)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":y=(I=this.read(l)).indexOf(0),p=String.fromCharCode.apply(String,I.slice(0,y)),this.text[p]=String.fromCharCode.apply(String,I.slice(y+1));break;case"IEND":return v&&this.animation.frames.push(v),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(T=this.colorType)===4||T===6,u=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*u,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var l,u;for(u=[],l=0;0<=s?l<s:l>s;0<=s?++l:--l)u.push(this.data[this.pos++]);return u},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var l=this.pixelBitlength/8,u=new Uint8Array(this.width*this.height*l),d=0,m=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function g(v,y,p,N){var b,I,w,S,T,W,G,te,H,M,Q,ce,E,_,B,q,ae,K,fe,se,me,ee=Math.ceil((m.width-v)/p),Le=Math.ceil((m.height-y)/N),k=m.width==ee&&m.height==Le;for(_=l*ee,ce=k?u:new Uint8Array(_*Le),W=s.length,E=0,I=0;E<Le&&d<W;){switch(s[d++]){case 0:for(S=ae=0;ae<_;S=ae+=1)ce[I++]=s[d++];break;case 1:for(S=K=0;K<_;S=K+=1)b=s[d++],T=S<l?0:ce[I-l],ce[I++]=(b+T)%256;break;case 2:for(S=fe=0;fe<_;S=fe+=1)b=s[d++],w=(S-S%l)/l,B=E&&ce[(E-1)*_+w*l+S%l],ce[I++]=(B+b)%256;break;case 3:for(S=se=0;se<_;S=se+=1)b=s[d++],w=(S-S%l)/l,T=S<l?0:ce[I-l],B=E&&ce[(E-1)*_+w*l+S%l],ce[I++]=(b+Math.floor((T+B)/2))%256;break;case 4:for(S=me=0;me<_;S=me+=1)b=s[d++],w=(S-S%l)/l,T=S<l?0:ce[I-l],E===0?B=q=0:(B=ce[(E-1)*_+w*l+S%l],q=w&&ce[(E-1)*_+(w-1)*l+S%l]),G=T+B-q,te=Math.abs(G-T),M=Math.abs(G-B),Q=Math.abs(G-q),H=te<=M&&te<=Q?T:M<=Q?B:q,ce[I++]=(b+H)%256;break;default:throw new Error("Invalid filter algorithm: "+s[d-1])}if(!k){var R=((y+E*N)*m.width+v)*l,z=E*_;for(S=0;S<ee;S+=1){for(var Y=0;Y<l;Y+=1)u[R++]=ce[z++];R+=(p-1)*l}}E++}}return s=x2(s),m.interlaceMethod==1?(g(0,0,8,8),g(4,0,8,8),g(0,4,4,8),g(2,0,4,4),g(0,2,2,4),g(1,0,2,2),g(0,1,1,2)):g(0,0,1,1),u},n.prototype.decodePalette=function(){var s,l,u,d,m,g,v,y,p;for(u=this.palette,g=this.transparency.indexed||[],m=new Uint8Array((g.length||0)+u.length),d=0,s=0,l=v=0,y=u.length;v<y;l=v+=3)m[d++]=u[l],m[d++]=u[l+1],m[d++]=u[l+2],m[d++]=(p=g[s++])!=null?p:255;return m},n.prototype.copyToImageData=function(s,l){var u,d,m,g,v,y,p,N,b,I,w;if(d=this.colors,b=null,u=this.hasAlphaChannel,this.palette.length&&(b=(w=this._decodedPalette)!=null?w:this._decodedPalette=this.decodePalette(),d=4,u=!0),N=(m=s.data||s).length,v=b||l,g=y=0,d===1)for(;g<N;)p=b?4*l[g/4]:y,I=v[p++],m[g++]=I,m[g++]=I,m[g++]=I,m[g++]=u?v[p++]:255,y=p;else for(;g<N;)p=b?4*l[g/4]:y,m[g++]=v[p++],m[g++]=v[p++],m[g++]=v[p++],m[g++]=u?v[p++]:255,y=p},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(He)==="[object Window]"){try{e=He.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),r=function(s){var l;if(i()===!0)return t.width=s.width,t.height=s.height,t.clearRect(0,0,s.width,s.height),t.putImageData(s,0,0),(l=new Image).src=e.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var l,u,d,m,g,v,y,p;if(this.animation){for(p=[],u=g=0,v=(y=this.animation.frames).length;g<v;u=++g)l=y[u],d=s.createImageData(l.width,l.height),m=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(d,m),l.imageData=d,p.push(l.image=r(d));return p}},n.prototype.renderFrame=function(s,l){var u,d,m;return u=(d=this.animation.frames)[l],m=d[l-1],l===0&&s.clearRect(0,0,this.width,this.height),(m!=null?m.disposeOp:void 0)===1?s.clearRect(m.xOffset,m.yOffset,m.width,m.height):(m!=null?m.disposeOp:void 0)===2&&s.putImageData(m.imageData,m.xOffset,m.yOffset),u.blendOp===0&&s.clearRect(u.xOffset,u.yOffset,u.width,u.height),s.drawImage(u.image,u.xOffset,u.yOffset)},n.prototype.animate=function(s){var l,u,d,m,g,v,y=this;return u=0,v=this.animation,m=v.numFrames,d=v.frames,g=v.numPlays,(l=function(){var p,N;if(p=u++%m,N=d[p],y.renderFrame(s,p),m>1&&u/m<g)return y.animation._timeout=setTimeout(l,N.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var l,u;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,l=s.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(u=l.createImageData(this.width,this.height),this.copyToImageData(u,this.decodePixels()),l.putImageData(u,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function z2(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,n=r[e++]|r[e++]<<8,i=r[e++],s=i>>7,l=1<<(7&i)+1;r[e++],r[e++];var u=null,d=null;s&&(u=e,d=l,e+=3*l);var m=!0,g=[],v=0,y=null,p=0,N=null;for(this.width=t,this.height=n;m&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,N=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((E=r[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var b=r[e++];v=r[e++]|r[e++]<<8,y=r[e++],!(1&b)&&(y=null),p=b>>2&7,e++;break;case 254:for(;;){if(!((E=r[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var I=r[e++]|r[e++]<<8,w=r[e++]|r[e++]<<8,S=r[e++]|r[e++]<<8,T=r[e++]|r[e++]<<8,W=r[e++],G=W>>6&1,te=1<<(7&W)+1,H=u,M=d,Q=!1;W>>7&&(Q=!0,H=e,M=te,e+=3*te);var ce=e;for(e++;;){var E;if(!((E=r[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}g.push({x:I,y:w,width:S,height:T,has_local_palette:Q,palette_offset:H,palette_size:M,data_offset:ce,data_length:e-ce,transparent_index:y,interlaced:!!G,delay:v,disposal:p});break;case 59:m=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return g.length},this.loopCount=function(){return N},this.frameInfo=function(_){if(_<0||_>=g.length)throw new Error("Frame index out of range.");return g[_]},this.decodeAndBlitFrameBGRA=function(_,B){var q=this.frameInfo(_),ae=q.width*q.height,K=new Uint8Array(ae);ld(r,q.data_offset,K,ae);var fe=q.palette_offset,se=q.transparent_index;se===null&&(se=256);var me=q.width,ee=t-me,Le=me,k=4*(q.y*t+q.x),R=4*((q.y+q.height)*t+q.x),z=k,Y=4*ee;q.interlaced===!0&&(Y+=4*t*7);for(var ne=8,ue=0,de=K.length;ue<de;++ue){var he=K[ue];if(Le===0&&(Le=me,(z+=Y)>=R&&(Y=4*ee+4*t*(ne-1),z=k+(me+ee)*(ne<<1),ne>>=1)),he===se)z+=4;else{var Se=r[fe+3*he],Ae=r[fe+3*he+1],Ee=r[fe+3*he+2];B[z++]=Ee,B[z++]=Ae,B[z++]=Se,B[z++]=255}--Le}},this.decodeAndBlitFrameRGBA=function(_,B){var q=this.frameInfo(_),ae=q.width*q.height,K=new Uint8Array(ae);ld(r,q.data_offset,K,ae);var fe=q.palette_offset,se=q.transparent_index;se===null&&(se=256);var me=q.width,ee=t-me,Le=me,k=4*(q.y*t+q.x),R=4*((q.y+q.height)*t+q.x),z=k,Y=4*ee;q.interlaced===!0&&(Y+=4*t*7);for(var ne=8,ue=0,de=K.length;ue<de;++ue){var he=K[ue];if(Le===0&&(Le=me,(z+=Y)>=R&&(Y=4*ee+4*t*(ne-1),z=k+(me+ee)*(ne<<1),ne>>=1)),he===se)z+=4;else{var Se=r[fe+3*he],Ae=r[fe+3*he+1],Ee=r[fe+3*he+2];B[z++]=Se,B[z++]=Ae,B[z++]=Ee,B[z++]=255}--Le}}}function ld(r,e,t,n){for(var i=r[e++],s=1<<i,l=s+1,u=l+1,d=i+1,m=(1<<d)-1,g=0,v=0,y=0,p=r[e++],N=new Int32Array(4096),b=null;;){for(;g<16&&p!==0;)v|=r[e++]<<g,g+=8,p===1?p=r[e++]:--p;if(g<d)break;var I=v&m;if(v>>=d,g-=d,I!==s){if(I===l)break;for(var w=I<u?I:b,S=0,T=w;T>s;)T=N[T]>>8,++S;var W=T;if(y+S+(w!==I?1:0)>n)return void Nt.log("Warning, gif stream longer than expected.");t[y++]=W;var G=y+=S;for(w!==I&&(t[y++]=W),T=w;S--;)T=N[T],t[--G]=255&T,T>>=8;b!==null&&u<4096&&(N[u++]=b<<8|W,u>=m+1&&d<12&&(++d,m=m<<1|1)),b=I}else u=l+1,m=(1<<(d=i+1))-1,b=null}return y!==n&&Nt.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Jl(r){var e,t,n,i,s,l=Math.floor,u=new Array(64),d=new Array(64),m=new Array(64),g=new Array(64),v=new Array(65535),y=new Array(65535),p=new Array(64),N=new Array(64),b=[],I=0,w=7,S=new Array(64),T=new Array(64),W=new Array(64),G=new Array(256),te=new Array(2048),H=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],M=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Q=[0,1,2,3,4,5,6,7,8,9,10,11],ce=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],_=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ae=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function K(k,R){for(var z=0,Y=0,ne=new Array,ue=1;ue<=16;ue++){for(var de=1;de<=k[ue];de++)ne[R[Y]]=[],ne[R[Y]][0]=z,ne[R[Y]][1]=ue,Y++,z++;z*=2}return ne}function fe(k){for(var R=k[0],z=k[1]-1;z>=0;)R&1<<z&&(I|=1<<w),z--,--w<0&&(I==255?(se(255),se(0)):se(I),w=7,I=0)}function se(k){b.push(k)}function me(k){se(k>>8&255),se(255&k)}function ee(k,R,z,Y,ne){for(var ue,de=ne[0],he=ne[240],Se=function(je,Pe){var Oe,Ie,Be,Ye,rt,nt,lt,xt,Ge,it,Te=0;for(Ge=0;Ge<8;++Ge){Oe=je[Te],Ie=je[Te+1],Be=je[Te+2],Ye=je[Te+3],rt=je[Te+4],nt=je[Te+5],lt=je[Te+6];var tr=Oe+(xt=je[Te+7]),ut=Oe-xt,Ur=Ie+lt,bt=Ie-lt,Lt=Be+nt,on=Be-nt,ft=Ye+rt,di=Ye-rt,_t=tr+ft,Vr=tr-ft,Ln=Ur+Lt,Ct=Ur-Lt;je[Te]=_t+Ln,je[Te+4]=_t-Ln;var Je=.707106781*(Ct+Vr);je[Te+2]=Vr+Je,je[Te+6]=Vr-Je;var pt=.382683433*((_t=di+on)-(Ct=bt+ut)),hi=.5411961*_t+pt,Qt=1.306562965*Ct+pt,ln=.707106781*(Ln=on+bt),cn=ut+ln,Ue=ut-ln;je[Te+5]=Ue+hi,je[Te+3]=Ue-hi,je[Te+1]=cn+Qt,je[Te+7]=cn-Qt,Te+=8}for(Te=0,Ge=0;Ge<8;++Ge){Oe=je[Te],Ie=je[Te+8],Be=je[Te+16],Ye=je[Te+24],rt=je[Te+32],nt=je[Te+40],lt=je[Te+48];var Wr=Oe+(xt=je[Te+56]),un=Oe-xt,mr=Ie+lt,Gt=Ie-lt,zt=Be+nt,Ar=Be-nt,Ti=Ye+rt,Pn=Ye-rt,Hr=Wr+Ti,Gr=Wr-Ti,$r=mr+zt,dn=mr-zt;je[Te]=Hr+$r,je[Te+32]=Hr-$r;var Er=.707106781*(dn+Gr);je[Te+16]=Gr+Er,je[Te+48]=Gr-Er;var hn=.382683433*((Hr=Pn+Ar)-(dn=Gt+un)),fi=.5411961*Hr+hn,Di=1.306562965*dn+hn,Ri=.707106781*($r=Ar+Gt),Fi=un+Ri,Mi=un-Ri;je[Te+40]=Mi+fi,je[Te+24]=Mi-fi,je[Te+8]=Fi+Di,je[Te+56]=Fi-Di,Te++}for(Ge=0;Ge<64;++Ge)it=je[Ge]*Pe[Ge],p[Ge]=it>0?it+.5|0:it-.5|0;return p}(k,R),Ae=0;Ae<64;++Ae)N[H[Ae]]=Se[Ae];var Ee=N[0]-z;z=N[0],Ee==0?fe(Y[0]):(fe(Y[y[ue=32767+Ee]]),fe(v[ue]));for(var _e=63;_e>0&&N[_e]==0;)_e--;if(_e==0)return fe(de),z;for(var Ve,ve=1;ve<=_e;){for(var U=ve;N[ve]==0&&ve<=_e;)++ve;var Ze=ve-U;if(Ze>=16){Ve=Ze>>4;for(var Me=1;Me<=Ve;++Me)fe(he);Ze&=15}ue=32767+N[ve],fe(ne[(Ze<<4)+y[ue]]),fe(v[ue]),ve++}return _e!=63&&fe(de),z}function Le(k){k=Math.min(Math.max(k,1),100),s!=k&&(function(R){for(var z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Y=0;Y<64;Y++){var ne=l((z[Y]*R+50)/100);ne=Math.min(Math.max(ne,1),255),u[H[Y]]=ne}for(var ue=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],de=0;de<64;de++){var he=l((ue[de]*R+50)/100);he=Math.min(Math.max(he,1),255),d[H[de]]=he}for(var Se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ae=0,Ee=0;Ee<8;Ee++)for(var _e=0;_e<8;_e++)m[Ae]=1/(u[H[Ae]]*Se[Ee]*Se[_e]*8),g[Ae]=1/(d[H[Ae]]*Se[Ee]*Se[_e]*8),Ae++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),s=k)}this.encode=function(k,R){R&&Le(R),b=new Array,I=0,w=7,me(65496),me(65504),me(16),se(74),se(70),se(73),se(70),se(0),se(1),se(1),se(0),me(1),me(1),se(0),se(0),function(){me(65499),me(132),se(0);for(var Ie=0;Ie<64;Ie++)se(u[Ie]);se(1);for(var Be=0;Be<64;Be++)se(d[Be])}(),function(Ie,Be){me(65472),me(17),se(8),me(Be),me(Ie),se(3),se(1),se(17),se(0),se(2),se(17),se(1),se(3),se(17),se(1)}(k.width,k.height),function(){me(65476),me(418),se(0);for(var Ie=0;Ie<16;Ie++)se(M[Ie+1]);for(var Be=0;Be<=11;Be++)se(Q[Be]);se(16);for(var Ye=0;Ye<16;Ye++)se(ce[Ye+1]);for(var rt=0;rt<=161;rt++)se(E[rt]);se(1);for(var nt=0;nt<16;nt++)se(_[nt+1]);for(var lt=0;lt<=11;lt++)se(B[lt]);se(17);for(var xt=0;xt<16;xt++)se(q[xt+1]);for(var Ge=0;Ge<=161;Ge++)se(ae[Ge])}(),me(65498),me(12),se(3),se(1),se(0),se(2),se(17),se(3),se(17),se(0),se(63),se(0);var z=0,Y=0,ne=0;I=0,w=7,this.encode.displayName="_encode_";for(var ue,de,he,Se,Ae,Ee,_e,Ve,ve,U=k.data,Ze=k.width,Me=k.height,je=4*Ze,Pe=0;Pe<Me;){for(ue=0;ue<je;){for(Ae=je*Pe+ue,_e=-1,Ve=0,ve=0;ve<64;ve++)Ee=Ae+(Ve=ve>>3)*je+(_e=4*(7&ve)),Pe+Ve>=Me&&(Ee-=je*(Pe+1+Ve-Me)),ue+_e>=je&&(Ee-=ue+_e-je+4),de=U[Ee++],he=U[Ee++],Se=U[Ee++],S[ve]=(te[de]+te[he+256>>0]+te[Se+512>>0]>>16)-128,T[ve]=(te[de+768>>0]+te[he+1024>>0]+te[Se+1280>>0]>>16)-128,W[ve]=(te[de+1280>>0]+te[he+1536>>0]+te[Se+1792>>0]>>16)-128;z=ee(S,m,z,e,n),Y=ee(T,g,Y,t,i),ne=ee(W,g,ne,t,i),ue+=32}Pe+=8}if(w>=0){var Oe=[];Oe[1]=w+1,Oe[0]=(1<<w+1)-1,fe(Oe)}return me(65497),new Uint8Array(b)},r=r||50,function(){for(var k=String.fromCharCode,R=0;R<256;R++)G[R]=k(R)}(),e=K(M,Q),t=K(_,B),n=K(ce,E),i=K(q,ae),function(){for(var k=1,R=2,z=1;z<=15;z++){for(var Y=k;Y<R;Y++)y[32767+Y]=z,v[32767+Y]=[],v[32767+Y][1]=z,v[32767+Y][0]=Y;for(var ne=-(R-1);ne<=-k;ne++)y[32767+ne]=z,v[32767+ne]=[],v[32767+ne][1]=z,v[32767+ne][0]=R-1+ne;k<<=1,R<<=1}}(),function(){for(var k=0;k<256;k++)te[k]=19595*k,te[k+256>>0]=38470*k,te[k+512>>0]=7471*k+32768,te[k+768>>0]=-11059*k,te[k+1024>>0]=-21709*k,te[k+1280>>0]=32768*k+8421375,te[k+1536>>0]=-27439*k,te[k+1792>>0]=-5329*k}(),Le(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function en(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function cd(r){function e(M){if(!M)throw Error("assert :P")}function t(M,Q,ce){for(var E=0;4>E;E++)if(M[Q+E]!=ce.charCodeAt(E))return!0;return!1}function n(M,Q,ce,E,_){for(var B=0;B<_;B++)M[Q+B]=ce[E+B]}function i(M,Q,ce,E){for(var _=0;_<E;_++)M[Q+_]=ce}function s(M){return new Int32Array(M)}function l(M,Q){for(var ce=[],E=0;E<M;E++)ce.push(new Q);return ce}function u(M,Q){var ce=[];return function E(_,B,q){for(var ae=q[B],K=0;K<ae&&(_.push(q.length>B+1?[]:new Q),!(q.length<B+1));K++)E(_[K],B+1,q)}(ce,0,M),ce}var d=function(){var M=this;function Q(a,c){for(var f=1<<c-1>>>0;a&f;)f>>>=1;return f?(a&f-1)+f:a}function ce(a,c,f,x,j){e(!(x%f));do a[c+(x-=f)]=j;while(0<x)}function E(a,c,f,x,j){if(e(2328>=j),512>=j)var L=s(512);else if((L=s(j))==null)return 0;return function(P,C,O,D,J,oe){var le,re,be=C,pe=1<<O,X=s(16),Z=s(16);for(e(J!=0),e(D!=null),e(P!=null),e(0<O),re=0;re<J;++re){if(15<D[re])return 0;++X[D[re]]}if(X[0]==J)return 0;for(Z[1]=0,le=1;15>le;++le){if(X[le]>1<<le)return 0;Z[le+1]=Z[le]+X[le]}for(re=0;re<J;++re)le=D[re],0<D[re]&&(oe[Z[le]++]=re);if(Z[15]==1)return(D=new _).g=0,D.value=oe[0],ce(P,be,1,pe,D),pe;var xe,we=-1,ye=pe-1,Re=0,ke=1,ze=1,Ce=1<<O;for(re=0,le=1,J=2;le<=O;++le,J<<=1){if(ke+=ze<<=1,0>(ze-=X[le]))return 0;for(;0<X[le];--X[le])(D=new _).g=le,D.value=oe[re++],ce(P,be+Re,J,Ce,D),Re=Q(Re,le)}for(le=O+1,J=2;15>=le;++le,J<<=1){if(ke+=ze<<=1,0>(ze-=X[le]))return 0;for(;0<X[le];--X[le]){if(D=new _,(Re&ye)!=we){for(be+=Ce,xe=1<<(we=le)-O;15>we&&!(0>=(xe-=X[we]));)++we,xe<<=1;pe+=Ce=1<<(xe=we-O),P[C+(we=Re&ye)].g=xe+O,P[C+we].value=be-C-we}D.g=le-O,D.value=oe[re++],ce(P,be+(Re>>O),J,Ce,D),Re=Q(Re,le)}}return ke!=2*Z[15]-1?0:pe}(a,c,f,x,j,L)}function _(){this.value=this.g=0}function B(){this.value=this.g=0}function q(){this.G=l(5,_),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(Zt,B)}function ae(a,c,f,x){e(a!=null),e(c!=null),e(2147483648>x),a.Ca=254,a.I=0,a.b=-8,a.Ka=0,a.oa=c,a.pa=f,a.Jd=c,a.Yc=f+x,a.Zc=4<=x?f+x-4+1:f,ue(a)}function K(a,c){for(var f=0;0<c--;)f|=he(a,128)<<c;return f}function fe(a,c){var f=K(a,c);return de(a)?-f:f}function se(a,c,f,x){var j,L=0;for(e(a!=null),e(c!=null),e(4294967288>x),a.Sb=x,a.Ra=0,a.u=0,a.h=0,4<x&&(x=4),j=0;j<x;++j)L+=c[f+j]<<8*j;a.Ra=L,a.bb=x,a.oa=c,a.pa=f}function me(a){for(;8<=a.u&&a.bb<a.Sb;)a.Ra>>>=8,a.Ra+=a.oa[a.pa+a.bb]<<Zi-8>>>0,++a.bb,a.u-=8;z(a)&&(a.h=1,a.u=0)}function ee(a,c){if(e(0<=c),!a.h&&c<=Qi){var f=R(a)&Xi[c];return a.u+=c,me(a),f}return a.h=1,a.u=0}function Le(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function R(a){return a.Ra>>>(a.u&Zi-1)>>>0}function z(a){return e(a.bb<=a.Sb),a.h||a.bb==a.Sb&&a.u>Zi}function Y(a,c){a.u=c,a.h=z(a)}function ne(a){a.u>=Js&&(e(a.u>=Js),me(a))}function ue(a){e(a!=null&&a.oa!=null),a.pa<a.Zc?(a.I=(a.oa[a.pa++]|a.I<<8)>>>0,a.b+=8):(e(a!=null&&a.oa!=null),a.pa<a.Yc?(a.b+=8,a.I=a.oa[a.pa++]|a.I<<8):a.Ka?a.b=0:(a.I<<=8,a.b+=8,a.Ka=1))}function de(a){return K(a,1)}function he(a,c){var f=a.Ca;0>a.b&&ue(a);var x=a.b,j=f*c>>>8,L=(a.I>>>x>j)+0;for(L?(f-=j,a.I-=j+1<<x>>>0):f=j+1,x=f,j=0;256<=x;)j+=8,x>>=8;return x=7^j+vr[x],a.b-=x,a.Ca=(f<<x)-1,L}function Se(a,c,f){a[c+0]=f>>24&255,a[c+1]=f>>16&255,a[c+2]=f>>8&255,a[c+3]=f>>0&255}function Ae(a,c){return a[c+0]<<0|a[c+1]<<8}function Ee(a,c){return Ae(a,c)|a[c+2]<<16}function _e(a,c){return Ae(a,c)|Ae(a,c+2)<<16}function Ve(a,c){var f=1<<c;return e(a!=null),e(0<c),a.X=s(f),a.X==null?0:(a.Mb=32-c,a.Xa=c,1)}function ve(a,c){e(a!=null),e(c!=null),e(a.Xa==c.Xa),n(c.X,0,a.X,0,1<<c.Xa)}function U(){this.X=[],this.Xa=this.Mb=0}function Ze(a,c,f,x){e(f!=null),e(x!=null);var j=f[0],L=x[0];return j==0&&(j=(a*L+c/2)/c),L==0&&(L=(c*j+a/2)/a),0>=j||0>=L?0:(f[0]=j,x[0]=L,1)}function Me(a,c){return a+(1<<c)-1>>>c}function je(a,c){return((4278255360&a)+(4278255360&c)>>>0&4278255360)+((16711935&a)+(16711935&c)>>>0&16711935)>>>0}function Pe(a,c){M[c]=function(f,x,j,L,P,C,O){var D;for(D=0;D<P;++D){var J=M[a](C[O+D-1],j,L+D);C[O+D]=je(f[x+D],J)}}}function Oe(){this.ud=this.hd=this.jd=0}function Ie(a,c){return((4278124286&(a^c))>>>1)+(a&c)>>>0}function Be(a){return 0<=a&&256>a?a:0>a?0:255<a?255:void 0}function Ye(a,c){return Be(a+(a-c+.5>>1))}function rt(a,c,f){return Math.abs(c-f)-Math.abs(a-f)}function nt(a,c,f,x,j,L,P){for(x=L[P-1],f=0;f<j;++f)L[P+f]=x=je(a[c+f],x)}function lt(a,c,f,x,j){var L;for(L=0;L<f;++L){var P=a[c+L],C=P>>8&255,O=16711935&(O=(O=16711935&P)+((C<<16)+C));x[j+L]=(4278255360&P)+O>>>0}}function xt(a,c){c.jd=a>>0&255,c.hd=a>>8&255,c.ud=a>>16&255}function Ge(a,c,f,x,j,L){var P;for(P=0;P<x;++P){var C=c[f+P],O=C>>>8,D=C,J=255&(J=(J=C>>>16)+((a.jd<<24>>24)*(O<<24>>24)>>>5));D=255&(D=(D=D+((a.hd<<24>>24)*(O<<24>>24)>>>5))+((a.ud<<24>>24)*(J<<24>>24)>>>5)),j[L+P]=(4278255360&C)+(J<<16)+D}}function it(a,c,f,x,j){M[c]=function(L,P,C,O,D,J,oe,le,re){for(O=oe;O<le;++O)for(oe=0;oe<re;++oe)D[J++]=j(C[x(L[P++])])},M[a]=function(L,P,C,O,D,J,oe){var le=8>>L.b,re=L.Ea,be=L.K[0],pe=L.w;if(8>le)for(L=(1<<L.b)-1,pe=(1<<le)-1;P<C;++P){var X,Z=0;for(X=0;X<re;++X)X&L||(Z=x(O[D++])),J[oe++]=j(be[Z&pe]),Z>>=le}else M["VP8LMapColor"+f](O,D,be,pe,J,oe,P,C,re)}}function Te(a,c,f,x,j){for(f=c+f;c<f;){var L=a[c++];x[j++]=L>>16&255,x[j++]=L>>8&255,x[j++]=L>>0&255}}function tr(a,c,f,x,j){for(f=c+f;c<f;){var L=a[c++];x[j++]=L>>16&255,x[j++]=L>>8&255,x[j++]=L>>0&255,x[j++]=L>>24&255}}function ut(a,c,f,x,j){for(f=c+f;c<f;){var L=(P=a[c++])>>16&240|P>>12&15,P=P>>0&240|P>>28&15;x[j++]=L,x[j++]=P}}function Ur(a,c,f,x,j){for(f=c+f;c<f;){var L=(P=a[c++])>>16&248|P>>13&7,P=P>>5&224|P>>3&31;x[j++]=L,x[j++]=P}}function bt(a,c,f,x,j){for(f=c+f;c<f;){var L=a[c++];x[j++]=L>>0&255,x[j++]=L>>8&255,x[j++]=L>>16&255}}function Lt(a,c,f,x,j,L){if(L==0)for(f=c+f;c<f;)Se(x,((L=a[c++])[0]>>24|L[1]>>8&65280|L[2]<<8&16711680|L[3]<<24)>>>0),j+=32;else n(x,j,a,c,f)}function on(a,c){M[c][0]=M[a+"0"],M[c][1]=M[a+"1"],M[c][2]=M[a+"2"],M[c][3]=M[a+"3"],M[c][4]=M[a+"4"],M[c][5]=M[a+"5"],M[c][6]=M[a+"6"],M[c][7]=M[a+"7"],M[c][8]=M[a+"8"],M[c][9]=M[a+"9"],M[c][10]=M[a+"10"],M[c][11]=M[a+"11"],M[c][12]=M[a+"12"],M[c][13]=M[a+"13"],M[c][14]=M[a+"0"],M[c][15]=M[a+"0"]}function ft(a){return a==Ll||a==Pl||a==Qa||a==kl}function di(){this.eb=[],this.size=this.A=this.fb=0}function _t(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Vr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new di,this.f.kb=new _t,this.sd=null}function Ln(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ct(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Je(a){return alert("todo:WebPSamplerProcessPlane"),a.T}function pt(a,c){var f=a.T,x=c.ba.f.RGBA,j=x.eb,L=x.fb+a.ka*x.A,P=Mr[c.ba.S],C=a.y,O=a.O,D=a.f,J=a.N,oe=a.ea,le=a.W,re=c.cc,be=c.dc,pe=c.Mc,X=c.Nc,Z=a.ka,xe=a.ka+a.T,we=a.U,ye=we+1>>1;for(Z==0?P(C,O,null,null,D,J,oe,le,D,J,oe,le,j,L,null,null,we):(P(c.ec,c.fc,C,O,re,be,pe,X,D,J,oe,le,j,L-x.A,j,L,we),++f);Z+2<xe;Z+=2)re=D,be=J,pe=oe,X=le,J+=a.Rc,le+=a.Rc,L+=2*x.A,P(C,(O+=2*a.fa)-a.fa,C,O,re,be,pe,X,D,J,oe,le,j,L-x.A,j,L,we);return O+=a.fa,a.j+xe<a.o?(n(c.ec,c.fc,C,O,we),n(c.cc,c.dc,D,J,ye),n(c.Mc,c.Nc,oe,le,ye),f--):1&xe||P(C,O,null,null,D,J,oe,le,D,J,oe,le,j,L+x.A,null,null,we),f}function hi(a,c,f){var x=a.F,j=[a.J];if(x!=null){var L=a.U,P=c.ba.S,C=P==Xa||P==Qa;c=c.ba.f.RGBA;var O=[0],D=a.ka;O[0]=a.T,a.Kb&&(D==0?--O[0]:(--D,j[0]-=a.width),a.j+a.ka+a.T==a.o&&(O[0]=a.o-a.j-D));var J=c.eb;D=c.fb+D*c.A,a=At(x,j[0],a.width,L,O,J,D+(C?0:3),c.A),e(f==O),a&&ft(P)&&Rr(J,D,C,L,O,c.A)}return 0}function Qt(a){var c=a.ma,f=c.ba.S,x=11>f,j=f==Ya||f==Ja||f==Xa||f==Sl||f==12||ft(f);if(c.memory=null,c.Ib=null,c.Jb=null,c.Nd=null,!Ks(c.Oa,a,j?11:12))return 0;if(j&&ft(f)&&Ne(),a.da)alert("todo:use_scaling");else{if(x){if(c.Ib=Je,a.Kb){if(f=a.U+1>>1,c.memory=s(a.U+2*f),c.memory==null)return 0;c.ec=c.memory,c.fc=0,c.cc=c.ec,c.dc=c.fc+a.U,c.Mc=c.cc,c.Nc=c.dc+f,c.Ib=pt,Ne()}}else alert("todo:EmitYUV");j&&(c.Jb=hi,x&&ie())}if(x&&!nu){for(a=0;256>a;++a)rf[a]=89858*(a-128)+eo>>Za,af[a]=-22014*(a-128)+eo,sf[a]=-45773*(a-128),nf[a]=113618*(a-128)+eo>>Za;for(a=na;a<Il;++a)c=76283*(a-16)+eo>>Za,of[a-na]=Sr(c,255),lf[a-na]=Sr(c+8>>4,15);nu=1}return 1}function ln(a){var c=a.ma,f=a.U,x=a.T;return e(!(1&a.ka)),0>=f||0>=x?0:(f=c.Ib(a,c),c.Jb!=null&&c.Jb(a,c,f),c.Dc+=f,1)}function cn(a){a.ma.memory=null}function Ue(a,c,f,x){return ee(a,8)!=47?0:(c[0]=ee(a,14)+1,f[0]=ee(a,14)+1,x[0]=ee(a,1),ee(a,3)!=0?0:!a.h)}function Wr(a,c){if(4>a)return a+1;var f=a-2>>1;return(2+(1&a)<<f)+ee(c,f)+1}function un(a,c){return 120<c?c-120:1<=(f=((f=Uh[c-1])>>4)*a+(8-(15&f)))?f:1;var f}function mr(a,c,f){var x=R(f),j=a[c+=255&x].g-8;return 0<j&&(Y(f,f.u+8),x=R(f),c+=a[c].value,c+=x&(1<<j)-1),Y(f,f.u+a[c].g),a[c].value}function Gt(a,c,f){return f.g+=a.g,f.value+=a.value<<c>>>0,e(8>=f.g),a.g}function zt(a,c,f){var x=a.xc;return e((c=x==0?0:a.vc[a.md*(f>>x)+(c>>x)])<a.Wb),a.Ya[c]}function Ar(a,c,f,x){var j=a.ab,L=a.c*c,P=a.C;c=P+c;var C=f,O=x;for(x=a.Ta,f=a.Ua;0<j--;){var D=a.gc[j],J=P,oe=c,le=C,re=O,be=(O=x,C=f,D.Ea);switch(e(J<oe),e(oe<=D.nc),D.hc){case 2:Ua(le,re,(oe-J)*be,O,C);break;case 0:var pe=J,X=oe,Z=O,xe=C,we=(Ce=D).Ea;pe==0&&(jl(le,re,null,null,1,Z,xe),nt(le,re+1,0,0,we-1,Z,xe+1),re+=we,xe+=we,++pe);for(var ye=1<<Ce.b,Re=ye-1,ke=Me(we,Ce.b),ze=Ce.K,Ce=Ce.w+(pe>>Ce.b)*ke;pe<X;){var ht=ze,mt=Ce,ct=1;for(Xs(le,re,Z,xe-we,1,Z,xe);ct<we;){var st=(ct&~Re)+ye;st>we&&(st=we),(0,Gn[ht[mt++]>>8&15])(le,re+ +ct,Z,xe+ct-we,st-ct,Z,xe+ct),ct=st}re+=we,xe+=we,++pe&Re||(Ce+=ke)}oe!=D.nc&&n(O,C-be,O,C+(oe-J-1)*be,be);break;case 1:for(be=le,X=re,we=(le=D.Ea)-(xe=le&~(Z=(re=1<<D.b)-1)),pe=Me(le,D.b),ye=D.K,D=D.w+(J>>D.b)*pe;J<oe;){for(Re=ye,ke=D,ze=new Oe,Ce=X+xe,ht=X+le;X<Ce;)xt(Re[ke++],ze),xi(ze,be,X,re,O,C),X+=re,C+=re;X<ht&&(xt(Re[ke++],ze),xi(ze,be,X,we,O,C),X+=we,C+=we),++J&Z||(D+=pe)}break;case 3:if(le==O&&re==C&&0<D.b){for(X=O,le=be=C+(oe-J)*be-(xe=(oe-J)*Me(D.Ea,D.b)),re=O,Z=C,pe=[],xe=(we=xe)-1;0<=xe;--xe)pe[xe]=re[Z+xe];for(xe=we-1;0<=xe;--xe)X[le+xe]=pe[xe];Or(D,J,oe,O,be,O,C)}else Or(D,J,oe,le,re,O,C)}C=x,O=f}O!=f&&n(x,f,C,O,L)}function Ti(a,c){var f=a.V,x=a.Ba+a.c*a.C,j=c-a.C;if(e(c<=a.l.o),e(16>=j),0<j){var L=a.l,P=a.Ta,C=a.Ua,O=L.width;if(Ar(a,j,f,x),j=C=[C],e((f=a.C)<(x=c)),e(L.v<L.va),x>L.o&&(x=L.o),f<L.j){var D=L.j-f;f=L.j,j[0]+=D*O}if(f>=x?f=0:(j[0]+=4*L.v,L.ka=f-L.j,L.U=L.va-L.v,L.T=x-f,f=1),f){if(C=C[0],11>(f=a.ca).S){var J=f.f.RGBA,oe=(x=f.S,j=L.U,L=L.T,D=J.eb,J.A),le=L;for(J=J.fb+a.Ma*J.A;0<le--;){var re=P,be=C,pe=j,X=D,Z=J;switch(x){case Ka:xr(re,be,pe,X,Z);break;case Ya:ur(re,be,pe,X,Z);break;case Ll:ur(re,be,pe,X,Z),Rr(X,Z,0,pe,1,0);break;case $c:In(re,be,pe,X,Z);break;case Ja:Lt(re,be,pe,X,Z,1);break;case Pl:Lt(re,be,pe,X,Z,1),Rr(X,Z,0,pe,1,0);break;case Xa:Lt(re,be,pe,X,Z,0);break;case Qa:Lt(re,be,pe,X,Z,0),Rr(X,Z,1,pe,1,0);break;case Sl:$n(re,be,pe,X,Z);break;case kl:$n(re,be,pe,X,Z),jt(X,Z,pe,1,0);break;case Kc:Cn(re,be,pe,X,Z);break;default:e(0)}C+=O,J+=oe}a.Ma+=L}else alert("todo:EmitRescaledRowsYUVA");e(a.Ma<=f.height)}}a.C=c,e(a.C<=a.i)}function Pn(a){var c;if(0<a.ua)return 0;for(c=0;c<a.Wb;++c){var f=a.Ya[c].G,x=a.Ya[c].H;if(0<f[1][x[1]+0].g||0<f[2][x[2]+0].g||0<f[3][x[3]+0].g)return 0}return 1}function Hr(a,c,f,x,j,L){if(a.Z!=0){var P=a.qd,C=a.rd;for(e(Xn[a.Z]!=null);c<f;++c)Xn[a.Z](P,C,x,j,x,j,L),P=x,C=j,j+=L;a.qd=P,a.rd=C}}function Gr(a,c){var f=a.l.ma,x=f.Z==0||f.Z==1?a.l.j:a.C;if(x=a.C<x?x:a.C,e(c<=a.l.o),c>x){var j=a.l.width,L=f.ca,P=f.tb+j*x,C=a.V,O=a.Ba+a.c*x,D=a.gc;e(a.ab==1),e(D[0].hc==3),Va(D[0],x,c,C,O,L,P),Hr(f,x,c,L,P,j)}a.C=a.Ma=c}function $r(a,c,f,x,j,L,P){var C=a.$/x,O=a.$%x,D=a.m,J=a.s,oe=f+a.$,le=oe;j=f+x*j;var re=f+x*L,be=280+J.ua,pe=a.Pb?C:16777216,X=0<J.ua?J.Wa:null,Z=J.wc,xe=oe<re?zt(J,O,C):null;e(a.C<L),e(re<=j);var we=!1;e:for(;;){for(;we||oe<re;){var ye=0;if(C>=pe){var Re=oe-f;e((pe=a).Pb),pe.wd=pe.m,pe.xd=Re,0<pe.s.ua&&ve(pe.s.Wa,pe.s.vb),pe=C+Wh}if(O&Z||(xe=zt(J,O,C)),e(xe!=null),xe.Qb&&(c[oe]=xe.qb,we=!0),!we)if(ne(D),xe.jc){ye=D,Re=c;var ke=oe,ze=xe.pd[R(ye)&Zt-1];e(xe.jc),256>ze.g?(Y(ye,ye.u+ze.g),Re[ke]=ze.value,ye=0):(Y(ye,ye.u+ze.g-256),e(256<=ze.value),ye=ze.value),ye==0&&(we=!0)}else ye=mr(xe.G[0],xe.H[0],D);if(D.h)break;if(we||256>ye){if(!we)if(xe.nd)c[oe]=(xe.qb|ye<<8)>>>0;else{if(ne(D),we=mr(xe.G[1],xe.H[1],D),ne(D),Re=mr(xe.G[2],xe.H[2],D),ke=mr(xe.G[3],xe.H[3],D),D.h)break;c[oe]=(ke<<24|we<<16|ye<<8|Re)>>>0}if(we=!1,++oe,++O>=x&&(O=0,++C,P!=null&&C<=L&&!(C%16)&&P(a,C),X!=null))for(;le<oe;)ye=c[le++],X.X[(506832829*ye&4294967295)>>>X.Mb]=ye}else if(280>ye){if(ye=Wr(ye-256,D),Re=mr(xe.G[4],xe.H[4],D),ne(D),Re=un(x,Re=Wr(Re,D)),D.h)break;if(oe-f<Re||j-oe<ye)break e;for(ke=0;ke<ye;++ke)c[oe+ke]=c[oe+ke-Re];for(oe+=ye,O+=ye;O>=x;)O-=x,++C,P!=null&&C<=L&&!(C%16)&&P(a,C);if(e(oe<=j),O&Z&&(xe=zt(J,O,C)),X!=null)for(;le<oe;)ye=c[le++],X.X[(506832829*ye&4294967295)>>>X.Mb]=ye}else{if(!(ye<be))break e;for(we=ye-280,e(X!=null);le<oe;)ye=c[le++],X.X[(506832829*ye&4294967295)>>>X.Mb]=ye;ye=oe,e(!(we>>>(Re=X).Xa)),c[ye]=Re.X[we],we=!0}we||e(D.h==z(D))}if(a.Pb&&D.h&&oe<j)e(a.m.h),a.a=5,a.m=a.wd,a.$=a.xd,0<a.s.ua&&ve(a.s.vb,a.s.Wa);else{if(D.h)break e;P!=null&&P(a,C>L?L:C),a.a=0,a.$=oe-f}return 1}return a.a=3,0}function dn(a){e(a!=null),a.vc=null,a.yc=null,a.Ya=null;var c=a.Wa;c!=null&&(c.X=null),a.vb=null,e(a!=null)}function Er(){var a=new Nl;return a==null?null:(a.a=0,a.xb=Xc,on("Predictor","VP8LPredictors"),on("Predictor","VP8LPredictors_C"),on("PredictorAdd","VP8LPredictorsAdd"),on("PredictorAdd","VP8LPredictorsAdd_C"),Ua=lt,xi=Ge,xr=Te,ur=tr,$n=ut,Cn=Ur,In=bt,M.VP8LMapColor32b=es,M.VP8LMapColor8b=Wa,a)}function hn(a,c,f,x,j){var L=1,P=[a],C=[c],O=x.m,D=x.s,J=null,oe=0;e:for(;;){if(f)for(;L&&ee(O,1);){var le=P,re=C,be=x,pe=1,X=be.m,Z=be.gc[be.ab],xe=ee(X,2);if(be.Oc&1<<xe)L=0;else{switch(be.Oc|=1<<xe,Z.hc=xe,Z.Ea=le[0],Z.nc=re[0],Z.K=[null],++be.ab,e(4>=be.ab),xe){case 0:case 1:Z.b=ee(X,3)+2,pe=hn(Me(Z.Ea,Z.b),Me(Z.nc,Z.b),0,be,Z.K),Z.K=Z.K[0];break;case 3:var we,ye=ee(X,8)+1,Re=16<ye?0:4<ye?1:2<ye?2:3;if(le[0]=Me(Z.Ea,Re),Z.b=Re,we=pe=hn(ye,1,0,be,Z.K)){var ke,ze=ye,Ce=Z,ht=1<<(8>>Ce.b),mt=s(ht);if(mt==null)we=0;else{var ct=Ce.K[0],st=Ce.w;for(mt[0]=Ce.K[0][0],ke=1;ke<1*ze;++ke)mt[ke]=je(ct[st+ke],mt[ke-1]);for(;ke<4*ht;++ke)mt[ke]=0;Ce.K[0]=null,Ce.K[0]=mt,we=1}}pe=we;break;case 2:break;default:e(0)}L=pe}}if(P=P[0],C=C[0],L&&ee(O,1)&&!(L=1<=(oe=ee(O,4))&&11>=oe)){x.a=3;break e}var wt;if(wt=L)t:{var yt,tt,Vt,yr=x,Wt=P,br=C,gt=oe,Pr=f,kr=yr.m,Yt=yr.s,er=[null],hr=1,Br=0,gn=Vh[gt];r:for(;;){if(Pr&&ee(kr,1)){var Jt=ee(kr,3)+2,Dn=Me(Wt,Jt),ji=Me(br,Jt),ss=Dn*ji;if(!hn(Dn,ji,0,yr,er))break r;for(er=er[0],Yt.xc=Jt,yt=0;yt<ss;++yt){var Qn=er[yt]>>8&65535;er[yt]=Qn,Qn>=hr&&(hr=Qn+1)}}if(kr.h)break r;for(tt=0;5>tt;++tt){var Et=Yc[tt];!tt&&0<gt&&(Et+=1<<gt),Br<Et&&(Br=Et)}var El=l(hr*gn,_),au=hr,ou=l(au,q);if(ou==null)var ro=null;else e(65536>=au),ro=ou;var ia=s(Br);if(ro==null||ia==null||El==null){yr.a=1;break r}var no=El;for(yt=Vt=0;yt<hr;++yt){var Qr=ro[yt],as=Qr.G,os=Qr.H,lu=0,io=1,cu=0;for(tt=0;5>tt;++tt){Et=Yc[tt],as[tt]=no,os[tt]=Vt,!tt&&0<gt&&(Et+=1<<gt);i:{var so,Ol=Et,ao=yr,sa=ia,df=no,hf=Vt,Tl=0,Zn=ao.m,ff=ee(Zn,1);if(i(sa,0,0,Ol),ff){var pf=ee(Zn,1)+1,mf=ee(Zn,1),uu=ee(Zn,mf==0?1:8);sa[uu]=1,pf==2&&(sa[uu=ee(Zn,8)]=1);var oo=1}else{var du=s(19),hu=ee(Zn,4)+4;if(19<hu){ao.a=3;var lo=0;break i}for(so=0;so<hu;++so)du[zh[so]]=ee(Zn,3);var Dl=void 0,aa=void 0,fu=ao,gf=du,co=Ol,pu=sa,Rl=0,ei=fu.m,mu=8,gu=l(128,_);n:for(;E(gu,0,7,gf,19);){if(ee(ei,1)){var vf=2+2*ee(ei,3);if((Dl=2+ee(ei,vf))>co)break n}else Dl=co;for(aa=0;aa<co&&Dl--;){ne(ei);var vu=gu[0+(127&R(ei))];Y(ei,ei.u+vu.g);var ls=vu.value;if(16>ls)pu[aa++]=ls,ls!=0&&(mu=ls);else{var xf=ls==16,xu=ls-16,yf=Bh[xu],yu=ee(ei,Mh[xu])+yf;if(aa+yu>co)break n;for(var bf=xf?mu:0;0<yu--;)pu[aa++]=bf}}Rl=1;break n}Rl||(fu.a=3),oo=Rl}(oo=oo&&!Zn.h)&&(Tl=E(df,hf,8,sa,Ol)),oo&&Tl!=0?lo=Tl:(ao.a=3,lo=0)}if(lo==0)break r;if(io&&qh[tt]==1&&(io=no[Vt].g==0),lu+=no[Vt].g,Vt+=lo,3>=tt){var oa,Fl=ia[0];for(oa=1;oa<Et;++oa)ia[oa]>Fl&&(Fl=ia[oa]);cu+=Fl}}if(Qr.nd=io,Qr.Qb=0,io&&(Qr.qb=(as[3][os[3]+0].value<<24|as[1][os[1]+0].value<<16|as[2][os[2]+0].value)>>>0,lu==0&&256>as[0][os[0]+0].value&&(Qr.Qb=1,Qr.qb+=as[0][os[0]+0].value<<8)),Qr.jc=!Qr.Qb&&6>cu,Qr.jc){var uo,Rn=Qr;for(uo=0;uo<Zt;++uo){var ti=uo,ri=Rn.pd[ti],ho=Rn.G[0][Rn.H[0]+ti];256<=ho.value?(ri.g=ho.g+256,ri.value=ho.value):(ri.g=0,ri.value=0,ti>>=Gt(ho,8,ri),ti>>=Gt(Rn.G[1][Rn.H[1]+ti],16,ri),ti>>=Gt(Rn.G[2][Rn.H[2]+ti],0,ri),Gt(Rn.G[3][Rn.H[3]+ti],24,ri))}}}Yt.vc=er,Yt.Wb=hr,Yt.Ya=ro,Yt.yc=El,wt=1;break t}wt=0}if(!(L=wt)){x.a=3;break e}if(0<oe){if(D.ua=1<<oe,!Ve(D.Wa,oe)){x.a=1,L=0;break e}}else D.ua=0;var Ml=x,bu=P,wf=C,Bl=Ml.s,ql=Bl.xc;if(Ml.c=bu,Ml.i=wf,Bl.md=Me(bu,ql),Bl.wc=ql==0?-1:(1<<ql)-1,f){x.xb=Xh;break e}if((J=s(P*C))==null){x.a=1,L=0;break e}L=(L=$r(x,J,0,P,C,C,null))&&!O.h;break e}return L?(j!=null?j[0]=J:(e(J==null),e(f)),x.$=0,f||dn(D)):dn(D),L}function fi(a,c){var f=a.c*a.i,x=f+c+16*c;return e(a.c<=c),a.V=s(x),a.V==null?(a.Ta=null,a.Ua=0,a.a=1,0):(a.Ta=a.V,a.Ua=a.Ba+f+c,1)}function Di(a,c){var f=a.C,x=c-f,j=a.V,L=a.Ba+a.c*f;for(e(c<=a.l.o);0<x;){var P=16<x?16:x,C=a.l.ma,O=a.l.width,D=O*P,J=C.ca,oe=C.tb+O*f,le=a.Ta,re=a.Ua;Ar(a,P,j,L),Ft(le,re,J,oe,D),Hr(C,f,f+P,J,oe,O),x-=P,j+=P*a.c,f+=P}e(f==c),a.C=a.Ma=c}function Ri(){this.ub=this.yd=this.td=this.Rb=0}function Fi(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Mi(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Na(){this.Yb=function(){var a=[];return function c(f,x,j){for(var L=j[x],P=0;P<L&&(f.push(j.length>x+1?[]:0),!(j.length<x+1));P++)c(f[P],x+1,j)}(a,0,[3,11]),a}()}function Zo(){this.jb=s(3),this.Wc=u([4,8],Na),this.Xc=u([4,17],Na)}function el(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Bi(){this.ld=this.La=this.dd=this.tc=0}function ja(){this.Na=this.la=0}function tl(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Es(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function rl(){this.uc=this.M=this.Nb=0,this.wa=Array(new Bi),this.Y=0,this.ya=Array(new Es),this.aa=0,this.l=new qi}function Aa(){this.y=s(16),this.f=s(8),this.ea=s(8)}function nl(){this.cb=this.a=0,this.sc="",this.m=new Le,this.Od=new Ri,this.Kc=new Fi,this.ed=new el,this.Qa=new Mi,this.Ic=this.$c=this.Aa=0,this.D=new rl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,Le),this.ia=0,this.pb=l(4,tl),this.Pa=new Zo,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Aa),this.Hd=0,this.rb=Array(new ja),this.sb=0,this.wa=Array(new Bi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Es),this.L=this.aa=0,this.gd=u([4,2],Bi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function qi(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function il(){var a=new nl;return a!=null&&(a.a=0,a.sc="OK",a.cb=0,a.Xb=0,ra||(ra=Pa)),a}function Dt(a,c,f){return a.a==0&&(a.a=c,a.sc=f,a.cb=0),0}function Sa(a,c,f){return 3<=f&&a[c+0]==157&&a[c+1]==1&&a[c+2]==42}function La(a,c){if(a==null)return 0;if(a.a=0,a.sc="OK",c==null)return Dt(a,2,"null VP8Io passed to VP8GetHeaders()");var f=c.data,x=c.w,j=c.ha;if(4>j)return Dt(a,7,"Truncated header.");var L=f[x+0]|f[x+1]<<8|f[x+2]<<16,P=a.Od;if(P.Rb=!(1&L),P.td=L>>1&7,P.yd=L>>4&1,P.ub=L>>5,3<P.td)return Dt(a,3,"Incorrect keyframe parameters.");if(!P.yd)return Dt(a,4,"Frame not displayable.");x+=3,j-=3;var C=a.Kc;if(P.Rb){if(7>j)return Dt(a,7,"cannot parse picture header");if(!Sa(f,x,j))return Dt(a,3,"Bad code word");C.c=16383&(f[x+4]<<8|f[x+3]),C.Td=f[x+4]>>6,C.i=16383&(f[x+6]<<8|f[x+5]),C.Ud=f[x+6]>>6,x+=7,j-=7,a.za=C.c+15>>4,a.Ub=C.i+15>>4,c.width=C.c,c.height=C.i,c.Da=0,c.j=0,c.v=0,c.va=c.width,c.o=c.height,c.da=0,c.ib=c.width,c.hb=c.height,c.U=c.width,c.T=c.height,i((L=a.Pa).jb,0,255,L.jb.length),e((L=a.Qa)!=null),L.Cb=0,L.Bb=0,L.Fb=1,i(L.Zb,0,0,L.Zb.length),i(L.Lb,0,0,L.Lb)}if(P.ub>j)return Dt(a,7,"bad partition length");ae(L=a.m,f,x,P.ub),x+=P.ub,j-=P.ub,P.Rb&&(C.Ld=de(L),C.Kd=de(L)),C=a.Qa;var O,D=a.Pa;if(e(L!=null),e(C!=null),C.Cb=de(L),C.Cb){if(C.Bb=de(L),de(L)){for(C.Fb=de(L),O=0;4>O;++O)C.Zb[O]=de(L)?fe(L,7):0;for(O=0;4>O;++O)C.Lb[O]=de(L)?fe(L,6):0}if(C.Bb)for(O=0;3>O;++O)D.jb[O]=de(L)?K(L,8):255}else C.Bb=0;if(L.Ka)return Dt(a,3,"cannot parse segment header");if((C=a.ed).zd=de(L),C.Tb=K(L,6),C.wb=K(L,3),C.Pc=de(L),C.Pc&&de(L)){for(D=0;4>D;++D)de(L)&&(C.vd[D]=fe(L,6));for(D=0;4>D;++D)de(L)&&(C.od[D]=fe(L,6))}if(a.L=C.Tb==0?0:C.zd?1:2,L.Ka)return Dt(a,3,"cannot parse filter header");var J=j;if(j=O=x,x=O+J,C=J,a.Xb=(1<<K(a.m,2))-1,J<3*(D=a.Xb))f=7;else{for(O+=3*D,C-=3*D,J=0;J<D;++J){var oe=f[j+0]|f[j+1]<<8|f[j+2]<<16;oe>C&&(oe=C),ae(a.Jc[+J],f,O,oe),O+=oe,C-=oe,j+=3}ae(a.Jc[+D],f,O,C),f=O<x?0:5}if(f!=0)return Dt(a,f,"cannot parse partitions");for(f=K(O=a.m,7),j=de(O)?fe(O,4):0,x=de(O)?fe(O,4):0,C=de(O)?fe(O,4):0,D=de(O)?fe(O,4):0,O=de(O)?fe(O,4):0,J=a.Qa,oe=0;4>oe;++oe){if(J.Cb){var le=J.Zb[oe];J.Fb||(le+=f)}else{if(0<oe){a.pb[oe]=a.pb[0];continue}le=f}var re=a.pb[oe];re.Sc[0]=_l[Sr(le+j,127)],re.Sc[1]=Cl[Sr(le+0,127)],re.Eb[0]=2*_l[Sr(le+x,127)],re.Eb[1]=101581*Cl[Sr(le+C,127)]>>16,8>re.Eb[1]&&(re.Eb[1]=8),re.Qc[0]=_l[Sr(le+D,117)],re.Qc[1]=Cl[Sr(le+O,127)],re.lc=le+O}if(!P.Rb)return Dt(a,4,"Not a key frame.");for(de(L),P=a.Pa,f=0;4>f;++f){for(j=0;8>j;++j)for(x=0;3>x;++x)for(C=0;11>C;++C)D=he(L,Yh[f][j][x][C])?K(L,8):$h[f][j][x][C],P.Wc[f][j].Yb[x][C]=D;for(j=0;17>j;++j)P.Xc[f][j]=P.Wc[f][Jh[j]]}return a.kc=de(L),a.kc&&(a.Bd=K(L,8)),a.cb=1}function Pa(a,c,f,x,j,L,P){var C=c[j].Yb[f];for(f=0;16>j;++j){if(!he(a,C[f+0]))return j;for(;!he(a,C[f+1]);)if(C=c[++j].Yb[0],f=0,j==16)return 16;var O=c[j+1].Yb;if(he(a,C[f+2])){var D=a,J=0;if(he(D,(le=C)[(oe=f)+3]))if(he(D,le[oe+6])){for(C=0,oe=2*(J=he(D,le[oe+8]))+(le=he(D,le[oe+9+J])),J=0,le=Hh[oe];le[C];++C)J+=J+he(D,le[C]);J+=3+(8<<oe)}else he(D,le[oe+7])?(J=7+2*he(D,165),J+=he(D,145)):J=5+he(D,159);else J=he(D,le[oe+4])?3+he(D,le[oe+5]):2;C=O[2]}else J=1,C=O[1];O=P+Gh[j],0>(D=a).b&&ue(D);var oe,le=D.b,re=(oe=D.Ca>>1)-(D.I>>le)>>31;--D.b,D.Ca+=re,D.Ca|=1,D.I-=(oe+1&re)<<le,L[O]=((J^re)-re)*x[(0<j)+0]}return 16}function Os(a){var c=a.rb[a.sb-1];c.la=0,c.Na=0,i(a.zc,0,0,a.zc.length),a.ja=0}function sl(a,c){if(a==null)return 0;if(c==null)return Dt(a,2,"NULL VP8Io parameter in VP8Decode().");if(!a.cb&&!La(a,c))return 0;if(e(a.cb),c.ac==null||c.ac(c)){c.ob&&(a.L=0);var f=to[a.L];if(a.L==2?(a.yb=0,a.zb=0):(a.yb=c.v-f>>4,a.zb=c.j-f>>4,0>a.yb&&(a.yb=0),0>a.zb&&(a.zb=0)),a.Va=c.o+15+f>>4,a.Hb=c.va+15+f>>4,a.Hb>a.za&&(a.Hb=a.za),a.Va>a.Ub&&(a.Va=a.Ub),0<a.L){var x=a.ed;for(f=0;4>f;++f){var j;if(a.Qa.Cb){var L=a.Qa.Lb[f];a.Qa.Fb||(L+=x.Tb)}else L=x.Tb;for(j=0;1>=j;++j){var P=a.gd[f][j],C=L;if(x.Pc&&(C+=x.vd[0],j&&(C+=x.od[0])),0<(C=0>C?0:63<C?63:C)){var O=C;0<x.wb&&(O=4<x.wb?O>>2:O>>1)>9-x.wb&&(O=9-x.wb),1>O&&(O=1),P.dd=O,P.tc=2*C+O,P.ld=40<=C?2:15<=C?1:0}else P.tc=0;P.La=j}}}f=0}else Dt(a,6,"Frame setup failed"),f=a.a;if(f=f==0){if(f){a.$c=0,0<a.Aa||(a.Ic=uf);e:{f=a.Ic,x=4*(O=a.za);var D=32*O,J=O+1,oe=0<a.L?O*(0<a.Aa?2:1):0,le=(a.Aa==2?2:1)*O;if((P=x+832+(j=3*(16*f+to[a.L])/2*D)+(L=a.Fa!=null&&0<a.Fa.length?a.Kc.c*a.Kc.i:0))!=P)f=0;else{if(P>a.Vb){if(a.Vb=0,a.Ec=s(P),a.Fc=0,a.Ec==null){f=Dt(a,1,"no memory during frame initialization.");break e}a.Vb=P}P=a.Ec,C=a.Fc,a.Ac=P,a.Bc=C,C+=x,a.Gd=l(D,Aa),a.Hd=0,a.rb=l(J+1,ja),a.sb=1,a.wa=oe?l(oe,Bi):null,a.Y=0,a.D.Nb=0,a.D.wa=a.wa,a.D.Y=a.Y,0<a.Aa&&(a.D.Y+=O),e(!0),a.oc=P,a.pc=C,C+=832,a.ya=l(le,Es),a.aa=0,a.D.ya=a.ya,a.D.aa=a.aa,a.Aa==2&&(a.D.aa+=O),a.R=16*O,a.B=8*O,O=(D=to[a.L])*a.R,D=D/2*a.B,a.sa=P,a.ta=C+O,a.qa=a.sa,a.ra=a.ta+16*f*a.R+D,a.Ha=a.qa,a.Ia=a.ra+8*f*a.B+D,a.$c=0,C+=j,a.mb=L?P:null,a.nb=L?C:null,e(C+L<=a.Fc+a.Vb),Os(a),i(a.Ac,a.Bc,0,x),f=1}}if(f){if(c.ka=0,c.y=a.sa,c.O=a.ta,c.f=a.qa,c.N=a.ra,c.ea=a.Ha,c.Vd=a.Ia,c.fa=a.R,c.Rc=a.B,c.F=null,c.J=0,!Ga){for(f=-255;255>=f;++f)$t[255+f]=0>f?-f:f;for(f=-1020;1020>=f;++f)On[1020+f]=-128>f?-128:127<f?127:f;for(f=-112;112>=f;++f)ta[112+f]=-16>f?-16:15<f?15:f;for(f=-255;510>=f;++f)is[255+f]=0>f?0:255<f?255:f;Ga=1}ts=ll,En=al,Qs=_a,dr=ol,Tr=Ca,Rt=ka,rs=Bs,Ha=gi,Zs=wl,yi=qs,bi=bl,Kn=Gi,wi=zs,ns=Ba,Ni=Ma,Yn=pn,ea=_n,Dr=yl,Xr[0]=fn,Xr[1]=cl,Xr[2]=fl,Xr[3]=pl,Xr[4]=Oa,Xr[5]=Wi,Xr[6]=Ta,Xr[7]=Rs,Xr[8]=gl,Xr[9]=ml,Jn[0]=Ia,Jn[1]=dl,Jn[2]=kn,Jn[3]=Ui,Jn[4]=rr,Jn[5]=hl,Jn[6]=Ea,Tn[0]=Vn,Tn[1]=ul,Tn[2]=vl,Tn[3]=Fs,Tn[4]=mi,Tn[5]=xl,Tn[6]=Ms,f=1}else f=0}f&&(f=function(re,be){for(re.M=0;re.M<re.Va;++re.M){var pe,X=re.Jc[re.M&re.Xb],Z=re.m,xe=re;for(pe=0;pe<xe.za;++pe){var we=Z,ye=xe,Re=ye.Ac,ke=ye.Bc+4*pe,ze=ye.zc,Ce=ye.ya[ye.aa+pe];if(ye.Qa.Bb?Ce.$b=he(we,ye.Pa.jb[0])?2+he(we,ye.Pa.jb[2]):he(we,ye.Pa.jb[1]):Ce.$b=0,ye.kc&&(Ce.Ad=he(we,ye.Bd)),Ce.Za=!he(we,145)+0,Ce.Za){var ht=Ce.Ob,mt=0;for(ye=0;4>ye;++ye){var ct,st=ze[0+ye];for(ct=0;4>ct;++ct){st=Kh[Re[ke+ct]][st];for(var wt=Jc[he(we,st[0])];0<wt;)wt=Jc[2*wt+he(we,st[wt])];st=-wt,Re[ke+ct]=st}n(ht,mt,Re,ke,4),mt+=4,ze[0+ye]=st}}else st=he(we,156)?he(we,128)?1:3:he(we,163)?2:0,Ce.Ob[0]=st,i(Re,ke,st,4),i(ze,0,st,4);Ce.Dd=he(we,142)?he(we,114)?he(we,183)?1:3:2:0}if(xe.m.Ka)return Dt(re,7,"Premature end-of-partition0 encountered.");for(;re.ja<re.za;++re.ja){if(xe=X,we=(Z=re).rb[Z.sb-1],Re=Z.rb[Z.sb+Z.ja],pe=Z.ya[Z.aa+Z.ja],ke=Z.kc?pe.Ad:0)we.la=Re.la=0,pe.Za||(we.Na=Re.Na=0),pe.Hc=0,pe.Gc=0,pe.ia=0;else{var yt,tt;if(we=Re,Re=xe,ke=Z.Pa.Xc,ze=Z.ya[Z.aa+Z.ja],Ce=Z.pb[ze.$b],ye=ze.ad,ht=0,mt=Z.rb[Z.sb-1],st=ct=0,i(ye,ht,0,384),ze.Za)var Vt=0,yr=ke[3];else{wt=s(16);var Wt=we.Na+mt.Na;if(Wt=ra(Re,ke[1],Wt,Ce.Eb,0,wt,0),we.Na=mt.Na=(0<Wt)+0,1<Wt)ts(wt,0,ye,ht);else{var br=wt[0]+3>>3;for(wt=0;256>wt;wt+=16)ye[ht+wt]=br}Vt=1,yr=ke[0]}var gt=15&we.la,Pr=15&mt.la;for(wt=0;4>wt;++wt){var kr=1&Pr;for(br=tt=0;4>br;++br)gt=gt>>1|(kr=(Wt=ra(Re,yr,Wt=kr+(1&gt),Ce.Sc,Vt,ye,ht))>Vt)<<7,tt=tt<<2|(3<Wt?3:1<Wt?2:ye[ht+0]!=0),ht+=16;gt>>=4,Pr=Pr>>1|kr<<7,ct=(ct<<8|tt)>>>0}for(yr=gt,Vt=Pr>>4,yt=0;4>yt;yt+=2){for(tt=0,gt=we.la>>4+yt,Pr=mt.la>>4+yt,wt=0;2>wt;++wt){for(kr=1&Pr,br=0;2>br;++br)Wt=kr+(1&gt),gt=gt>>1|(kr=0<(Wt=ra(Re,ke[2],Wt,Ce.Qc,0,ye,ht)))<<3,tt=tt<<2|(3<Wt?3:1<Wt?2:ye[ht+0]!=0),ht+=16;gt>>=2,Pr=Pr>>1|kr<<5}st|=tt<<4*yt,yr|=gt<<4<<yt,Vt|=(240&Pr)<<yt}we.la=yr,mt.la=Vt,ze.Hc=ct,ze.Gc=st,ze.ia=43690&st?0:Ce.ia,ke=!(ct|st)}if(0<Z.L&&(Z.wa[Z.Y+Z.ja]=Z.gd[pe.$b][pe.Za],Z.wa[Z.Y+Z.ja].La|=!ke),xe.Ka)return Dt(re,7,"Premature end-of-file encountered.")}if(Os(re),Z=be,xe=1,pe=(X=re).D,we=0<X.L&&X.M>=X.zb&&X.M<=X.Va,X.Aa==0)e:{if(pe.M=X.M,pe.uc=we,$s(X,pe),xe=1,pe=(tt=X.D).Nb,we=(st=to[X.L])*X.R,Re=st/2*X.B,wt=16*pe*X.R,br=8*pe*X.B,ke=X.sa,ze=X.ta-we+wt,Ce=X.qa,ye=X.ra-Re+br,ht=X.Ha,mt=X.Ia-Re+br,Pr=(gt=tt.M)==0,ct=gt>=X.Va-1,X.Aa==2&&$s(X,tt),tt.uc)for(kr=(Wt=X).D.M,e(Wt.D.uc),tt=Wt.yb;tt<Wt.Hb;++tt){Vt=tt,yr=kr;var Yt=(er=(Et=Wt).D).Nb;yt=Et.R;var er=er.wa[er.Y+Vt],hr=Et.sa,Br=Et.ta+16*Yt*yt+16*Vt,gn=er.dd,Jt=er.tc;if(Jt!=0)if(e(3<=Jt),Et.L==1)0<Vt&&Yn(hr,Br,yt,Jt+4),er.La&&Dr(hr,Br,yt,Jt),0<yr&&Ni(hr,Br,yt,Jt+4),er.La&&ea(hr,Br,yt,Jt);else{var Dn=Et.B,ji=Et.qa,ss=Et.ra+8*Yt*Dn+8*Vt,Qn=Et.Ha,Et=Et.Ia+8*Yt*Dn+8*Vt;Yt=er.ld,0<Vt&&(Ha(hr,Br,yt,Jt+4,gn,Yt),yi(ji,ss,Qn,Et,Dn,Jt+4,gn,Yt)),er.La&&(Kn(hr,Br,yt,Jt,gn,Yt),ns(ji,ss,Qn,Et,Dn,Jt,gn,Yt)),0<yr&&(rs(hr,Br,yt,Jt+4,gn,Yt),Zs(ji,ss,Qn,Et,Dn,Jt+4,gn,Yt)),er.La&&(bi(hr,Br,yt,Jt,gn,Yt),wi(ji,ss,Qn,Et,Dn,Jt,gn,Yt))}}if(X.ia&&alert("todo:DitherRow"),Z.put!=null){if(tt=16*gt,gt=16*(gt+1),Pr?(Z.y=X.sa,Z.O=X.ta+wt,Z.f=X.qa,Z.N=X.ra+br,Z.ea=X.Ha,Z.W=X.Ia+br):(tt-=st,Z.y=ke,Z.O=ze,Z.f=Ce,Z.N=ye,Z.ea=ht,Z.W=mt),ct||(gt-=st),gt>Z.o&&(gt=Z.o),Z.F=null,Z.J=null,X.Fa!=null&&0<X.Fa.length&&tt<gt&&(Z.J=Hs(X,Z,tt,gt-tt),Z.F=X.mb,Z.F==null&&Z.F.length==0)){xe=Dt(X,3,"Could not decode alpha data.");break e}tt<Z.j&&(st=Z.j-tt,tt=Z.j,e(!(1&st)),Z.O+=X.R*st,Z.N+=X.B*(st>>1),Z.W+=X.B*(st>>1),Z.F!=null&&(Z.J+=Z.width*st)),tt<gt&&(Z.O+=Z.v,Z.N+=Z.v>>1,Z.W+=Z.v>>1,Z.F!=null&&(Z.J+=Z.v),Z.ka=tt-Z.j,Z.U=Z.va-Z.v,Z.T=gt-tt,xe=Z.put(Z))}pe+1!=X.Ic||ct||(n(X.sa,X.ta-we,ke,ze+16*X.R,we),n(X.qa,X.ra-Re,Ce,ye+8*X.B,Re),n(X.Ha,X.Ia-Re,ht,mt+8*X.B,Re))}if(!xe)return Dt(re,6,"Output aborted.")}return 1}(a,c)),c.bc!=null&&c.bc(c),f&=1}return f?(a.cb=0,f):0}function Kr(a,c,f,x,j){j=a[c+f+32*x]+(j>>3),a[c+f+32*x]=-256&j?0>j?0:255:j}function zi(a,c,f,x,j,L){Kr(a,c,0,f,x+j),Kr(a,c,1,f,x+L),Kr(a,c,2,f,x-L),Kr(a,c,3,f,x-j)}function gr(a){return(20091*a>>16)+a}function Ts(a,c,f,x){var j,L=0,P=s(16);for(j=0;4>j;++j){var C=a[c+0]+a[c+8],O=a[c+0]-a[c+8],D=(35468*a[c+4]>>16)-gr(a[c+12]),J=gr(a[c+4])+(35468*a[c+12]>>16);P[L+0]=C+J,P[L+1]=O+D,P[L+2]=O-D,P[L+3]=C-J,L+=4,c++}for(j=L=0;4>j;++j)C=(a=P[L+0]+4)+P[L+8],O=a-P[L+8],D=(35468*P[L+4]>>16)-gr(P[L+12]),Kr(f,x,0,0,C+(J=gr(P[L+4])+(35468*P[L+12]>>16))),Kr(f,x,1,0,O+D),Kr(f,x,2,0,O-D),Kr(f,x,3,0,C-J),L++,x+=32}function ka(a,c,f,x){var j=a[c+0]+4,L=35468*a[c+4]>>16,P=gr(a[c+4]),C=35468*a[c+1]>>16;zi(f,x,0,j+P,a=gr(a[c+1]),C),zi(f,x,1,j+L,a,C),zi(f,x,2,j-L,a,C),zi(f,x,3,j-P,a,C)}function al(a,c,f,x,j){Ts(a,c,f,x),j&&Ts(a,c+16,f,x+4)}function _a(a,c,f,x){En(a,c+0,f,x,1),En(a,c+32,f,x+128,1)}function ol(a,c,f,x){var j;for(a=a[c+0]+4,j=0;4>j;++j)for(c=0;4>c;++c)Kr(f,x,c,j,a)}function Ca(a,c,f,x){a[c+0]&&dr(a,c+0,f,x),a[c+16]&&dr(a,c+16,f,x+4),a[c+32]&&dr(a,c+32,f,x+128),a[c+48]&&dr(a,c+48,f,x+128+4)}function ll(a,c,f,x){var j,L=s(16);for(j=0;4>j;++j){var P=a[c+0+j]+a[c+12+j],C=a[c+4+j]+a[c+8+j],O=a[c+4+j]-a[c+8+j],D=a[c+0+j]-a[c+12+j];L[0+j]=P+C,L[8+j]=P-C,L[4+j]=D+O,L[12+j]=D-O}for(j=0;4>j;++j)P=(a=L[0+4*j]+3)+L[3+4*j],C=L[1+4*j]+L[2+4*j],O=L[1+4*j]-L[2+4*j],D=a-L[3+4*j],f[x+0]=P+C>>3,f[x+16]=D+O>>3,f[x+32]=P-C>>3,f[x+48]=D-O>>3,x+=64}function Ds(a,c,f){var x,j=c-32,L=Lr,P=255-a[j-1];for(x=0;x<f;++x){var C,O=L,D=P+a[c-1];for(C=0;C<f;++C)a[c+C]=O[D+a[j+C]];c+=32}}function cl(a,c){Ds(a,c,4)}function ul(a,c){Ds(a,c,8)}function dl(a,c){Ds(a,c,16)}function kn(a,c){var f;for(f=0;16>f;++f)n(a,c+32*f,a,c-32,16)}function Ui(a,c){var f;for(f=16;0<f;--f)i(a,c,a[c-1],16),c+=32}function Vi(a,c,f){var x;for(x=0;16>x;++x)i(c,f+32*x,a,16)}function Ia(a,c){var f,x=16;for(f=0;16>f;++f)x+=a[c-1+32*f]+a[c+f-32];Vi(x>>5,a,c)}function rr(a,c){var f,x=8;for(f=0;16>f;++f)x+=a[c-1+32*f];Vi(x>>4,a,c)}function hl(a,c){var f,x=8;for(f=0;16>f;++f)x+=a[c+f-32];Vi(x>>4,a,c)}function Ea(a,c){Vi(128,a,c)}function Ke(a,c,f){return a+2*c+f+2>>2}function fl(a,c){var f,x=c-32;for(x=new Uint8Array([Ke(a[x-1],a[x+0],a[x+1]),Ke(a[x+0],a[x+1],a[x+2]),Ke(a[x+1],a[x+2],a[x+3]),Ke(a[x+2],a[x+3],a[x+4])]),f=0;4>f;++f)n(a,c+32*f,x,0,x.length)}function pl(a,c){var f=a[c-1],x=a[c-1+32],j=a[c-1+64],L=a[c-1+96];Se(a,c+0,16843009*Ke(a[c-1-32],f,x)),Se(a,c+32,16843009*Ke(f,x,j)),Se(a,c+64,16843009*Ke(x,j,L)),Se(a,c+96,16843009*Ke(j,L,L))}function fn(a,c){var f,x=4;for(f=0;4>f;++f)x+=a[c+f-32]+a[c-1+32*f];for(x>>=3,f=0;4>f;++f)i(a,c+32*f,x,4)}function Oa(a,c){var f=a[c-1+0],x=a[c-1+32],j=a[c-1+64],L=a[c-1-32],P=a[c+0-32],C=a[c+1-32],O=a[c+2-32],D=a[c+3-32];a[c+0+96]=Ke(x,j,a[c-1+96]),a[c+1+96]=a[c+0+64]=Ke(f,x,j),a[c+2+96]=a[c+1+64]=a[c+0+32]=Ke(L,f,x),a[c+3+96]=a[c+2+64]=a[c+1+32]=a[c+0+0]=Ke(P,L,f),a[c+3+64]=a[c+2+32]=a[c+1+0]=Ke(C,P,L),a[c+3+32]=a[c+2+0]=Ke(O,C,P),a[c+3+0]=Ke(D,O,C)}function Ta(a,c){var f=a[c+1-32],x=a[c+2-32],j=a[c+3-32],L=a[c+4-32],P=a[c+5-32],C=a[c+6-32],O=a[c+7-32];a[c+0+0]=Ke(a[c+0-32],f,x),a[c+1+0]=a[c+0+32]=Ke(f,x,j),a[c+2+0]=a[c+1+32]=a[c+0+64]=Ke(x,j,L),a[c+3+0]=a[c+2+32]=a[c+1+64]=a[c+0+96]=Ke(j,L,P),a[c+3+32]=a[c+2+64]=a[c+1+96]=Ke(L,P,C),a[c+3+64]=a[c+2+96]=Ke(P,C,O),a[c+3+96]=Ke(C,O,O)}function Wi(a,c){var f=a[c-1+0],x=a[c-1+32],j=a[c-1+64],L=a[c-1-32],P=a[c+0-32],C=a[c+1-32],O=a[c+2-32],D=a[c+3-32];a[c+0+0]=a[c+1+64]=L+P+1>>1,a[c+1+0]=a[c+2+64]=P+C+1>>1,a[c+2+0]=a[c+3+64]=C+O+1>>1,a[c+3+0]=O+D+1>>1,a[c+0+96]=Ke(j,x,f),a[c+0+64]=Ke(x,f,L),a[c+0+32]=a[c+1+96]=Ke(f,L,P),a[c+1+32]=a[c+2+96]=Ke(L,P,C),a[c+2+32]=a[c+3+96]=Ke(P,C,O),a[c+3+32]=Ke(C,O,D)}function Rs(a,c){var f=a[c+0-32],x=a[c+1-32],j=a[c+2-32],L=a[c+3-32],P=a[c+4-32],C=a[c+5-32],O=a[c+6-32],D=a[c+7-32];a[c+0+0]=f+x+1>>1,a[c+1+0]=a[c+0+64]=x+j+1>>1,a[c+2+0]=a[c+1+64]=j+L+1>>1,a[c+3+0]=a[c+2+64]=L+P+1>>1,a[c+0+32]=Ke(f,x,j),a[c+1+32]=a[c+0+96]=Ke(x,j,L),a[c+2+32]=a[c+1+96]=Ke(j,L,P),a[c+3+32]=a[c+2+96]=Ke(L,P,C),a[c+3+64]=Ke(P,C,O),a[c+3+96]=Ke(C,O,D)}function ml(a,c){var f=a[c-1+0],x=a[c-1+32],j=a[c-1+64],L=a[c-1+96];a[c+0+0]=f+x+1>>1,a[c+2+0]=a[c+0+32]=x+j+1>>1,a[c+2+32]=a[c+0+64]=j+L+1>>1,a[c+1+0]=Ke(f,x,j),a[c+3+0]=a[c+1+32]=Ke(x,j,L),a[c+3+32]=a[c+1+64]=Ke(j,L,L),a[c+3+64]=a[c+2+64]=a[c+0+96]=a[c+1+96]=a[c+2+96]=a[c+3+96]=L}function gl(a,c){var f=a[c-1+0],x=a[c-1+32],j=a[c-1+64],L=a[c-1+96],P=a[c-1-32],C=a[c+0-32],O=a[c+1-32],D=a[c+2-32];a[c+0+0]=a[c+2+32]=f+P+1>>1,a[c+0+32]=a[c+2+64]=x+f+1>>1,a[c+0+64]=a[c+2+96]=j+x+1>>1,a[c+0+96]=L+j+1>>1,a[c+3+0]=Ke(C,O,D),a[c+2+0]=Ke(P,C,O),a[c+1+0]=a[c+3+32]=Ke(f,P,C),a[c+1+32]=a[c+3+64]=Ke(x,f,P),a[c+1+64]=a[c+3+96]=Ke(j,x,f),a[c+1+96]=Ke(L,j,x)}function vl(a,c){var f;for(f=0;8>f;++f)n(a,c+32*f,a,c-32,8)}function Fs(a,c){var f;for(f=0;8>f;++f)i(a,c,a[c-1],8),c+=32}function pi(a,c,f){var x;for(x=0;8>x;++x)i(c,f+32*x,a,8)}function Vn(a,c){var f,x=8;for(f=0;8>f;++f)x+=a[c+f-32]+a[c-1+32*f];pi(x>>4,a,c)}function xl(a,c){var f,x=4;for(f=0;8>f;++f)x+=a[c+f-32];pi(x>>3,a,c)}function mi(a,c){var f,x=4;for(f=0;8>f;++f)x+=a[c-1+32*f];pi(x>>3,a,c)}function Ms(a,c){pi(128,a,c)}function Hi(a,c,f){var x=a[c-f],j=a[c+0],L=3*(j-x)+Al[1020+a[c-2*f]-a[c+f]],P=$a[112+(L+4>>3)];a[c-f]=Lr[255+x+$a[112+(L+3>>3)]],a[c+0]=Lr[255+j-P]}function Da(a,c,f,x){var j=a[c+0],L=a[c+f];return Fr[255+a[c-2*f]-a[c-f]]>x||Fr[255+L-j]>x}function Ra(a,c,f,x){return 4*Fr[255+a[c-f]-a[c+0]]+Fr[255+a[c-2*f]-a[c+f]]<=x}function Fa(a,c,f,x,j){var L=a[c-3*f],P=a[c-2*f],C=a[c-f],O=a[c+0],D=a[c+f],J=a[c+2*f],oe=a[c+3*f];return 4*Fr[255+C-O]+Fr[255+P-D]>x?0:Fr[255+a[c-4*f]-L]<=j&&Fr[255+L-P]<=j&&Fr[255+P-C]<=j&&Fr[255+oe-J]<=j&&Fr[255+J-D]<=j&&Fr[255+D-O]<=j}function Ma(a,c,f,x){var j=2*x+1;for(x=0;16>x;++x)Ra(a,c+x,f,j)&&Hi(a,c+x,f)}function pn(a,c,f,x){var j=2*x+1;for(x=0;16>x;++x)Ra(a,c+x*f,1,j)&&Hi(a,c+x*f,1)}function _n(a,c,f,x){var j;for(j=3;0<j;--j)Ma(a,c+=4*f,f,x)}function yl(a,c,f,x){var j;for(j=3;0<j;--j)pn(a,c+=4,f,x)}function Wn(a,c,f,x,j,L,P,C){for(L=2*L+1;0<j--;){if(Fa(a,c,f,L,P))if(Da(a,c,f,C))Hi(a,c,f);else{var O=a,D=c,J=f,oe=O[D-2*J],le=O[D-J],re=O[D+0],be=O[D+J],pe=O[D+2*J],X=27*(xe=Al[1020+3*(re-le)+Al[1020+oe-be]])+63>>7,Z=18*xe+63>>7,xe=9*xe+63>>7;O[D-3*J]=Lr[255+O[D-3*J]+xe],O[D-2*J]=Lr[255+oe+Z],O[D-J]=Lr[255+le+X],O[D+0]=Lr[255+re-X],O[D+J]=Lr[255+be-Z],O[D+2*J]=Lr[255+pe-xe]}c+=x}}function Yr(a,c,f,x,j,L,P,C){for(L=2*L+1;0<j--;){if(Fa(a,c,f,L,P))if(Da(a,c,f,C))Hi(a,c,f);else{var O=a,D=c,J=f,oe=O[D-J],le=O[D+0],re=O[D+J],be=$a[112+((pe=3*(le-oe))+4>>3)],pe=$a[112+(pe+3>>3)],X=be+1>>1;O[D-2*J]=Lr[255+O[D-2*J]+X],O[D-J]=Lr[255+oe+pe],O[D+0]=Lr[255+le-be],O[D+J]=Lr[255+re-X]}c+=x}}function Bs(a,c,f,x,j,L){Wn(a,c,f,1,16,x,j,L)}function gi(a,c,f,x,j,L){Wn(a,c,1,f,16,x,j,L)}function bl(a,c,f,x,j,L){var P;for(P=3;0<P;--P)Yr(a,c+=4*f,f,1,16,x,j,L)}function Gi(a,c,f,x,j,L){var P;for(P=3;0<P;--P)Yr(a,c+=4,1,f,16,x,j,L)}function wl(a,c,f,x,j,L,P,C){Wn(a,c,j,1,8,L,P,C),Wn(f,x,j,1,8,L,P,C)}function qs(a,c,f,x,j,L,P,C){Wn(a,c,1,j,8,L,P,C),Wn(f,x,1,j,8,L,P,C)}function zs(a,c,f,x,j,L,P,C){Yr(a,c+4*j,j,1,8,L,P,C),Yr(f,x+4*j,j,1,8,L,P,C)}function Ba(a,c,f,x,j,L,P,C){Yr(a,c+4,1,j,8,L,P,C),Yr(f,x+4,1,j,8,L,P,C)}function $i(){this.ba=new Vr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ct,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Us(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Vs(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function qa(){this.ua=0,this.Wa=new U,this.vb=new U,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new q,this.yc=new _}function Nl(){this.xb=this.a=0,this.l=new qi,this.ca=new Vr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new qa,this.ab=0,this.gc=l(4,Vs),this.Oc=0}function Ki(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new qi,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function vi(a,c,f,x,j,L,P){for(a=a==null?0:a[c+0],c=0;c<P;++c)j[L+c]=a+f[x+c]&255,a=j[L+c]}function Ws(a,c,f,x,j,L,P){var C;if(a==null)vi(null,null,f,x,j,L,P);else for(C=0;C<P;++C)j[L+C]=a[c+C]+f[x+C]&255}function Hn(a,c,f,x,j,L,P){if(a==null)vi(null,null,f,x,j,L,P);else{var C,O=a[c+0],D=O,J=O;for(C=0;C<P;++C)D=J+(O=a[c+C])-D,J=f[x+C]+(-256&D?0>D?0:255:D)&255,D=O,j[L+C]=J}}function Hs(a,c,f,x){var j=c.width,L=c.o;if(e(a!=null&&c!=null),0>f||0>=x||f+x>L)return null;if(!a.Cc){if(a.ga==null){var P;if(a.ga=new Ki,(P=a.ga==null)||(P=c.width*c.o,e(a.Gb.length==0),a.Gb=s(P),a.Uc=0,a.Gb==null?P=0:(a.mb=a.Gb,a.nb=a.Uc,a.rc=null,P=1),P=!P),!P){P=a.ga;var C=a.Fa,O=a.P,D=a.qc,J=a.mb,oe=a.nb,le=O+1,re=D-1,be=P.l;if(e(C!=null&&J!=null&&c!=null),Xn[0]=null,Xn[1]=vi,Xn[2]=Ws,Xn[3]=Hn,P.ca=J,P.tb=oe,P.c=c.width,P.i=c.height,e(0<P.c&&0<P.i),1>=D)c=0;else if(P.$a=C[O+0]>>0&3,P.Z=C[O+0]>>2&3,P.Lc=C[O+0]>>4&3,O=C[O+0]>>6&3,0>P.$a||1<P.$a||4<=P.Z||1<P.Lc||O)c=0;else if(be.put=ln,be.ac=Qt,be.bc=cn,be.ma=P,be.width=c.width,be.height=c.height,be.Da=c.Da,be.v=c.v,be.va=c.va,be.j=c.j,be.o=c.o,P.$a)e:{e(P.$a==1),c=Er();t:for(;;){if(c==null){c=0;break e}if(e(P!=null),P.mc=c,c.c=P.c,c.i=P.i,c.l=P.l,c.l.ma=P,c.l.width=P.c,c.l.height=P.i,c.a=0,se(c.m,C,le,re),!hn(P.c,P.i,1,c,null)||(c.ab==1&&c.gc[0].hc==3&&Pn(c.s)?(P.ic=1,C=c.c*c.i,c.Ta=null,c.Ua=0,c.V=s(C),c.Ba=0,c.V==null?(c.a=1,c=0):c=1):(P.ic=0,c=fi(c,P.c)),!c))break t;c=1;break e}P.mc=null,c=0}else c=re>=P.c*P.i;P=!c}if(P)return null;a.ga.Lc!=1?a.Ga=0:x=L-f}e(a.ga!=null),e(f+x<=L);e:{if(c=(C=a.ga).c,L=C.l.o,C.$a==0){if(le=a.rc,re=a.Vc,be=a.Fa,O=a.P+1+f*c,D=a.mb,J=a.nb+f*c,e(O<=a.P+a.qc),C.Z!=0)for(e(Xn[C.Z]!=null),P=0;P<x;++P)Xn[C.Z](le,re,be,O,D,J,c),le=D,re=J,J+=c,O+=c;else for(P=0;P<x;++P)n(D,J,be,O,c),le=D,re=J,J+=c,O+=c;a.rc=le,a.Vc=re}else{if(e(C.mc!=null),c=f+x,e((P=C.mc)!=null),e(c<=P.i),P.C>=c)c=1;else if(C.ic||ie(),C.ic){C=P.V,le=P.Ba,re=P.c;var pe=P.i,X=(be=1,O=P.$/re,D=P.$%re,J=P.m,oe=P.s,P.$),Z=re*pe,xe=re*c,we=oe.wc,ye=X<xe?zt(oe,D,O):null;e(X<=Z),e(c<=pe),e(Pn(oe));t:for(;;){for(;!J.h&&X<xe;){if(D&we||(ye=zt(oe,D,O)),e(ye!=null),ne(J),256>(pe=mr(ye.G[0],ye.H[0],J)))C[le+X]=pe,++X,++D>=re&&(D=0,++O<=c&&!(O%16)&&Gr(P,O));else{if(!(280>pe)){be=0;break t}pe=Wr(pe-256,J);var Re,ke=mr(ye.G[4],ye.H[4],J);if(ne(J),!(X>=(ke=un(re,ke=Wr(ke,J)))&&Z-X>=pe)){be=0;break t}for(Re=0;Re<pe;++Re)C[le+X+Re]=C[le+X+Re-ke];for(X+=pe,D+=pe;D>=re;)D-=re,++O<=c&&!(O%16)&&Gr(P,O);X<xe&&D&we&&(ye=zt(oe,D,O))}e(J.h==z(J))}Gr(P,O>c?c:O);break t}!be||J.h&&X<Z?(be=0,P.a=J.h?5:3):P.$=X,c=be}else c=$r(P,P.V,P.Ba,P.c,P.i,c,Di);if(!c){x=0;break e}}f+x>=L&&(a.Cc=1),x=1}if(!x)return null;if(a.Cc&&((x=a.ga)!=null&&(x.mc=null),a.ga=null,0<a.Ga))return alert("todo:WebPDequantizeLevels"),null}return a.nb+f*j}function h(a,c,f,x,j,L){for(;0<j--;){var P,C=a,O=c+(f?1:0),D=a,J=c+(f?0:3);for(P=0;P<x;++P){var oe=D[J+4*P];oe!=255&&(oe*=32897,C[O+4*P+0]=C[O+4*P+0]*oe>>23,C[O+4*P+1]=C[O+4*P+1]*oe>>23,C[O+4*P+2]=C[O+4*P+2]*oe>>23)}c+=L}}function A(a,c,f,x,j){for(;0<x--;){var L;for(L=0;L<f;++L){var P=a[c+2*L+0],C=15&(D=a[c+2*L+1]),O=4369*C,D=(240&D|D>>4)*O>>16;a[c+2*L+0]=(240&P|P>>4)*O>>16&240|(15&P|P<<4)*O>>16>>4&15,a[c+2*L+1]=240&D|C}c+=j}}function F(a,c,f,x,j,L,P,C){var O,D,J=255;for(D=0;D<j;++D){for(O=0;O<x;++O){var oe=a[c+O];L[P+4*O]=oe,J&=oe}c+=f,P+=C}return J!=255}function $(a,c,f,x,j){var L;for(L=0;L<j;++L)f[x+L]=a[c+L]>>8}function ie(){Rr=h,jt=A,At=F,Ft=$}function ge(a,c,f){M[a]=function(x,j,L,P,C,O,D,J,oe,le,re,be,pe,X,Z,xe,we){var ye,Re=we-1>>1,ke=C[O+0]|D[J+0]<<16,ze=oe[le+0]|re[be+0]<<16;e(x!=null);var Ce=3*ke+ze+131074>>2;for(c(x[j+0],255&Ce,Ce>>16,pe,X),L!=null&&(Ce=3*ze+ke+131074>>2,c(L[P+0],255&Ce,Ce>>16,Z,xe)),ye=1;ye<=Re;++ye){var ht=C[O+ye]|D[J+ye]<<16,mt=oe[le+ye]|re[be+ye]<<16,ct=ke+ht+ze+mt+524296,st=ct+2*(ht+ze)>>3;Ce=st+ke>>1,ke=(ct=ct+2*(ke+mt)>>3)+ht>>1,c(x[j+2*ye-1],255&Ce,Ce>>16,pe,X+(2*ye-1)*f),c(x[j+2*ye-0],255&ke,ke>>16,pe,X+(2*ye-0)*f),L!=null&&(Ce=ct+ze>>1,ke=st+mt>>1,c(L[P+2*ye-1],255&Ce,Ce>>16,Z,xe+(2*ye-1)*f),c(L[P+2*ye+0],255&ke,ke>>16,Z,xe+(2*ye+0)*f)),ke=ht,ze=mt}1&we||(Ce=3*ke+ze+131074>>2,c(x[j+we-1],255&Ce,Ce>>16,pe,X+(we-1)*f),L!=null&&(Ce=3*ze+ke+131074>>2,c(L[P+we-1],255&Ce,Ce>>16,Z,xe+(we-1)*f)))}}function Ne(){Mr[Ka]=Qh,Mr[Ya]=Qc,Mr[$c]=Zh,Mr[Ja]=Zc,Mr[Xa]=eu,Mr[Sl]=tu,Mr[Kc]=ef,Mr[Ll]=Qc,Mr[Pl]=Zc,Mr[Qa]=eu,Mr[kl]=tu}function De(a){return a&~tf?0>a?0:255:a>>ru}function qe(a,c){return De((19077*a>>8)+(26149*c>>8)-14234)}function et(a,c,f){return De((19077*a>>8)-(6419*c>>8)-(13320*f>>8)+8708)}function Xe(a,c){return De((19077*a>>8)+(33050*c>>8)-17685)}function ot(a,c,f,x,j){x[j+0]=qe(a,f),x[j+1]=et(a,c,f),x[j+2]=Xe(a,c)}function kt(a,c,f,x,j){x[j+0]=Xe(a,c),x[j+1]=et(a,c,f),x[j+2]=qe(a,f)}function It(a,c,f,x,j){var L=et(a,c,f);c=L<<3&224|Xe(a,c)>>3,x[j+0]=248&qe(a,f)|L>>5,x[j+1]=c}function Ut(a,c,f,x,j){var L=240&Xe(a,c)|15;x[j+0]=240&qe(a,f)|et(a,c,f)>>4,x[j+1]=L}function nr(a,c,f,x,j){x[j+0]=255,ot(a,c,f,x,j+1)}function Kt(a,c,f,x,j){kt(a,c,f,x,j),x[j+3]=255}function Jr(a,c,f,x,j){ot(a,c,f,x,j),x[j+3]=255}function Sr(a,c){return 0>a?0:a>c?c:a}function mn(a,c,f){M[a]=function(x,j,L,P,C,O,D,J,oe){for(var le=J+(-2&oe)*f;J!=le;)c(x[j+0],L[P+0],C[O+0],D,J),c(x[j+1],L[P+0],C[O+0],D,J+f),j+=2,++P,++O,J+=2*f;1&oe&&c(x[j+0],L[P+0],C[O+0],D,J)}}function za(a,c,f){return f==0?a==0?c==0?6:5:c==0?4:0:f}function Gs(a,c,f,x,j){switch(a>>>30){case 3:En(c,f,x,j,0);break;case 2:Rt(c,f,x,j);break;case 1:dr(c,f,x,j)}}function $s(a,c){var f,x,j=c.M,L=c.Nb,P=a.oc,C=a.pc+40,O=a.oc,D=a.pc+584,J=a.oc,oe=a.pc+600;for(f=0;16>f;++f)P[C+32*f-1]=129;for(f=0;8>f;++f)O[D+32*f-1]=129,J[oe+32*f-1]=129;for(0<j?P[C-1-32]=O[D-1-32]=J[oe-1-32]=129:(i(P,C-32-1,127,21),i(O,D-32-1,127,9),i(J,oe-32-1,127,9)),x=0;x<a.za;++x){var le=c.ya[c.aa+x];if(0<x){for(f=-1;16>f;++f)n(P,C+32*f-4,P,C+32*f+12,4);for(f=-1;8>f;++f)n(O,D+32*f-4,O,D+32*f+4,4),n(J,oe+32*f-4,J,oe+32*f+4,4)}var re=a.Gd,be=a.Hd+x,pe=le.ad,X=le.Hc;if(0<j&&(n(P,C-32,re[be].y,0,16),n(O,D-32,re[be].f,0,8),n(J,oe-32,re[be].ea,0,8)),le.Za){var Z=P,xe=C-32+16;for(0<j&&(x>=a.za-1?i(Z,xe,re[be].y[15],4):n(Z,xe,re[be+1].y,0,4)),f=0;4>f;f++)Z[xe+128+f]=Z[xe+256+f]=Z[xe+384+f]=Z[xe+0+f];for(f=0;16>f;++f,X<<=2)Z=P,xe=C+iu[f],Xr[le.Ob[f]](Z,xe),Gs(X,pe,16*+f,Z,xe)}else if(Z=za(x,j,le.Ob[0]),Jn[Z](P,C),X!=0)for(f=0;16>f;++f,X<<=2)Gs(X,pe,16*+f,P,C+iu[f]);for(f=le.Gc,Z=za(x,j,le.Dd),Tn[Z](O,D),Tn[Z](J,oe),X=pe,Z=O,xe=D,255&(le=f>>0)&&(170&le?Qs(X,256,Z,xe):Tr(X,256,Z,xe)),le=J,X=oe,255&(f>>=8)&&(170&f?Qs(pe,320,le,X):Tr(pe,320,le,X)),j<a.Ub-1&&(n(re[be].y,0,P,C+480,16),n(re[be].f,0,O,D+224,8),n(re[be].ea,0,J,oe+224,8)),f=8*L*a.B,re=a.sa,be=a.ta+16*x+16*L*a.R,pe=a.qa,le=a.ra+8*x+f,X=a.Ha,Z=a.Ia+8*x+f,f=0;16>f;++f)n(re,be+f*a.R,P,C+32*f,16);for(f=0;8>f;++f)n(pe,le+f*a.B,O,D+32*f,8),n(X,Z+f*a.B,J,oe+32*f,8)}}function Yi(a,c,f,x,j,L,P,C,O){var D=[0],J=[0],oe=0,le=O!=null?O.kd:0,re=O??new Us;if(a==null||12>f)return 7;re.data=a,re.w=c,re.ha=f,c=[c],f=[f],re.gb=[re.gb];e:{var be=c,pe=f,X=re.gb;if(e(a!=null),e(pe!=null),e(X!=null),X[0]=0,12<=pe[0]&&!t(a,be[0],"RIFF")){if(t(a,be[0]+8,"WEBP")){X=3;break e}var Z=_e(a,be[0]+4);if(12>Z||4294967286<Z){X=3;break e}if(le&&Z>pe[0]-8){X=7;break e}X[0]=Z,be[0]+=12,pe[0]-=12}X=0}if(X!=0)return X;for(Z=0<re.gb[0],f=f[0];;){e:{var xe=a;pe=c,X=f;var we=D,ye=J,Re=be=[0];if((Ce=oe=[oe])[0]=0,8>X[0])X=7;else{if(!t(xe,pe[0],"VP8X")){if(_e(xe,pe[0]+4)!=10){X=3;break e}if(18>X[0]){X=7;break e}var ke=_e(xe,pe[0]+8),ze=1+Ee(xe,pe[0]+12);if(2147483648<=ze*(xe=1+Ee(xe,pe[0]+15))){X=3;break e}Re!=null&&(Re[0]=ke),we!=null&&(we[0]=ze),ye!=null&&(ye[0]=xe),pe[0]+=18,X[0]-=18,Ce[0]=1}X=0}}if(oe=oe[0],be=be[0],X!=0)return X;if(pe=!!(2&be),!Z&&oe)return 3;if(L!=null&&(L[0]=!!(16&be)),P!=null&&(P[0]=pe),C!=null&&(C[0]=0),P=D[0],be=J[0],oe&&pe&&O==null){X=0;break}if(4>f){X=7;break}if(Z&&oe||!Z&&!oe&&!t(a,c[0],"ALPH")){f=[f],re.na=[re.na],re.P=[re.P],re.Sa=[re.Sa];e:{ke=a,X=c,Z=f;var Ce=re.gb;we=re.na,ye=re.P,Re=re.Sa,ze=22,e(ke!=null),e(Z!=null),xe=X[0];var ht=Z[0];for(e(we!=null),e(Re!=null),we[0]=null,ye[0]=null,Re[0]=0;;){if(X[0]=xe,Z[0]=ht,8>ht){X=7;break e}var mt=_e(ke,xe+4);if(4294967286<mt){X=3;break e}var ct=8+mt+1&-2;if(ze+=ct,0<Ce&&ze>Ce){X=3;break e}if(!t(ke,xe,"VP8 ")||!t(ke,xe,"VP8L")){X=0;break e}if(ht[0]<ct){X=7;break e}t(ke,xe,"ALPH")||(we[0]=ke,ye[0]=xe+8,Re[0]=mt),xe+=ct,ht-=ct}}if(f=f[0],re.na=re.na[0],re.P=re.P[0],re.Sa=re.Sa[0],X!=0)break}f=[f],re.Ja=[re.Ja],re.xa=[re.xa];e:if(Ce=a,X=c,Z=f,we=re.gb[0],ye=re.Ja,Re=re.xa,ke=X[0],xe=!t(Ce,ke,"VP8 "),ze=!t(Ce,ke,"VP8L"),e(Ce!=null),e(Z!=null),e(ye!=null),e(Re!=null),8>Z[0])X=7;else{if(xe||ze){if(Ce=_e(Ce,ke+4),12<=we&&Ce>we-12){X=3;break e}if(le&&Ce>Z[0]-8){X=7;break e}ye[0]=Ce,X[0]+=8,Z[0]-=8,Re[0]=ze}else Re[0]=5<=Z[0]&&Ce[ke+0]==47&&!(Ce[ke+4]>>5),ye[0]=Z[0];X=0}if(f=f[0],re.Ja=re.Ja[0],re.xa=re.xa[0],c=c[0],X!=0)break;if(4294967286<re.Ja)return 3;if(C==null||pe||(C[0]=re.xa?2:1),P=[P],be=[be],re.xa){if(5>f){X=7;break}C=P,le=be,pe=L,a==null||5>f?a=0:5<=f&&a[c+0]==47&&!(a[c+4]>>5)?(Z=[0],Ce=[0],we=[0],se(ye=new k,a,c,f),Ue(ye,Z,Ce,we)?(C!=null&&(C[0]=Z[0]),le!=null&&(le[0]=Ce[0]),pe!=null&&(pe[0]=we[0]),a=1):a=0):a=0}else{if(10>f){X=7;break}C=be,a==null||10>f||!Sa(a,c+3,f-3)?a=0:(le=a[c+0]|a[c+1]<<8|a[c+2]<<16,pe=16383&(a[c+7]<<8|a[c+6]),a=16383&(a[c+9]<<8|a[c+8]),1&le||3<(le>>1&7)||!(le>>4&1)||le>>5>=re.Ja||!pe||!a?a=0:(P&&(P[0]=pe),C&&(C[0]=a),a=1))}if(!a||(P=P[0],be=be[0],oe&&(D[0]!=P||J[0]!=be)))return 3;O!=null&&(O[0]=re,O.offset=c-O.w,e(4294967286>c-O.w),e(O.offset==O.ha-f));break}return X==0||X==7&&oe&&O==null?(L!=null&&(L[0]|=re.na!=null&&0<re.na.length),x!=null&&(x[0]=P),j!=null&&(j[0]=be),0):X}function Ks(a,c,f){var x=c.width,j=c.height,L=0,P=0,C=x,O=j;if(c.Da=a!=null&&0<a.Da,c.Da&&(C=a.cd,O=a.bd,L=a.v,P=a.j,11>f||(L&=-2,P&=-2),0>L||0>P||0>=C||0>=O||L+C>x||P+O>j))return 0;if(c.v=L,c.j=P,c.va=L+C,c.o=P+O,c.U=C,c.T=O,c.da=a!=null&&0<a.da,c.da){if(!Ze(C,O,f=[a.ib],L=[a.hb]))return 0;c.ib=f[0],c.hb=L[0]}return c.ob=a!=null&&a.ob,c.Kb=a==null||!a.Sd,c.da&&(c.ob=c.ib<3*x/4&&c.hb<3*j/4,c.Kb=0),1}function Ys(a){if(a==null)return 2;if(11>a.S){var c=a.f.RGBA;c.fb+=(a.height-1)*c.A,c.A=-c.A}else c=a.f.kb,a=a.height,c.O+=(a-1)*c.fa,c.fa=-c.fa,c.N+=(a-1>>1)*c.Ab,c.Ab=-c.Ab,c.W+=(a-1>>1)*c.Db,c.Db=-c.Db,c.F!=null&&(c.J+=(a-1)*c.lb,c.lb=-c.lb);return 0}function Ji(a,c,f,x){if(x==null||0>=a||0>=c)return 2;if(f!=null){if(f.Da){var j=f.cd,L=f.bd,P=-2&f.v,C=-2&f.j;if(0>P||0>C||0>=j||0>=L||P+j>a||C+L>c)return 2;a=j,c=L}if(f.da){if(!Ze(a,c,j=[f.ib],L=[f.hb]))return 2;a=j[0],c=L[0]}}x.width=a,x.height=c;e:{var O=x.width,D=x.height;if(a=x.S,0>=O||0>=D||!(a>=Ka&&13>a))a=2;else{if(0>=x.Rd&&x.sd==null){P=L=j=c=0;var J=(C=O*su[a])*D;if(11>a||(L=(D+1)/2*(c=(O+1)/2),a==12&&(P=(j=O)*D)),(D=s(J+2*L+P))==null){a=1;break e}x.sd=D,11>a?((O=x.f.RGBA).eb=D,O.fb=0,O.A=C,O.size=J):((O=x.f.kb).y=D,O.O=0,O.fa=C,O.Fd=J,O.f=D,O.N=0+J,O.Ab=c,O.Cd=L,O.ea=D,O.W=0+J+L,O.Db=c,O.Ed=L,a==12&&(O.F=D,O.J=0+J+2*L),O.Tc=P,O.lb=j)}if(c=1,j=x.S,L=x.width,P=x.height,j>=Ka&&13>j)if(11>j)a=x.f.RGBA,c&=(C=Math.abs(a.A))*(P-1)+L<=a.size,c&=C>=L*su[j],c&=a.eb!=null;else{a=x.f.kb,C=(L+1)/2,J=(P+1)/2,O=Math.abs(a.fa),D=Math.abs(a.Ab);var oe=Math.abs(a.Db),le=Math.abs(a.lb),re=le*(P-1)+L;c&=O*(P-1)+L<=a.Fd,c&=D*(J-1)+C<=a.Cd,c=(c&=oe*(J-1)+C<=a.Ed)&O>=L&D>=C&oe>=C,c&=a.y!=null,c&=a.f!=null,c&=a.ea!=null,j==12&&(c&=le>=L,c&=re<=a.Tc,c&=a.F!=null)}else c=0;a=c?0:2}}return a!=0||f!=null&&f.fd&&(a=Ys(x)),a}var Zt=64,Xi=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Qi=24,Zi=32,Js=8,vr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Pe("Predictor0","PredictorAdd0"),M.Predictor0=function(){return 4278190080},M.Predictor1=function(a){return a},M.Predictor2=function(a,c,f){return c[f+0]},M.Predictor3=function(a,c,f){return c[f+1]},M.Predictor4=function(a,c,f){return c[f-1]},M.Predictor5=function(a,c,f){return Ie(Ie(a,c[f+1]),c[f+0])},M.Predictor6=function(a,c,f){return Ie(a,c[f-1])},M.Predictor7=function(a,c,f){return Ie(a,c[f+0])},M.Predictor8=function(a,c,f){return Ie(c[f-1],c[f+0])},M.Predictor9=function(a,c,f){return Ie(c[f+0],c[f+1])},M.Predictor10=function(a,c,f){return Ie(Ie(a,c[f-1]),Ie(c[f+0],c[f+1]))},M.Predictor11=function(a,c,f){var x=c[f+0];return 0>=rt(x>>24&255,a>>24&255,(c=c[f-1])>>24&255)+rt(x>>16&255,a>>16&255,c>>16&255)+rt(x>>8&255,a>>8&255,c>>8&255)+rt(255&x,255&a,255&c)?x:a},M.Predictor12=function(a,c,f){var x=c[f+0];return(Be((a>>24&255)+(x>>24&255)-((c=c[f-1])>>24&255))<<24|Be((a>>16&255)+(x>>16&255)-(c>>16&255))<<16|Be((a>>8&255)+(x>>8&255)-(c>>8&255))<<8|Be((255&a)+(255&x)-(255&c)))>>>0},M.Predictor13=function(a,c,f){var x=c[f-1];return(Ye((a=Ie(a,c[f+0]))>>24&255,x>>24&255)<<24|Ye(a>>16&255,x>>16&255)<<16|Ye(a>>8&255,x>>8&255)<<8|Ye(a>>0&255,x>>0&255))>>>0};var jl=M.PredictorAdd0;M.PredictorAdd1=nt,Pe("Predictor2","PredictorAdd2"),Pe("Predictor3","PredictorAdd3"),Pe("Predictor4","PredictorAdd4"),Pe("Predictor5","PredictorAdd5"),Pe("Predictor6","PredictorAdd6"),Pe("Predictor7","PredictorAdd7"),Pe("Predictor8","PredictorAdd8"),Pe("Predictor9","PredictorAdd9"),Pe("Predictor10","PredictorAdd10"),Pe("Predictor11","PredictorAdd11"),Pe("Predictor12","PredictorAdd12"),Pe("Predictor13","PredictorAdd13");var Xs=M.PredictorAdd2;it("ColorIndexInverseTransform","MapARGB","32b",function(a){return a>>8&255},function(a){return a}),it("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(a){return a},function(a){return a>>8&255});var Ua,Or=M.ColorIndexInverseTransform,es=M.MapARGB,Va=M.VP8LColorIndexInverseTransformAlpha,Wa=M.MapAlpha,Gn=M.VP8LPredictorsAdd=[];Gn.length=16,(M.VP8LPredictors=[]).length=16,(M.VP8LPredictorsAdd_C=[]).length=16,(M.VP8LPredictors_C=[]).length=16;var xi,xr,ur,$n,Cn,In,ts,En,Rt,Qs,dr,Tr,rs,Ha,Zs,yi,bi,Kn,wi,ns,Ni,Yn,ea,Dr,Rr,jt,At,Ft,$t=s(511),On=s(2041),ta=s(225),is=s(767),Ga=0,Al=On,$a=ta,Lr=is,Fr=$t,Ka=0,Ya=1,$c=2,Ja=3,Xa=4,Sl=5,Kc=6,Ll=7,Pl=8,Qa=9,kl=10,Mh=[2,3,7],Bh=[3,3,11],Yc=[280,256,256,256,40],qh=[0,1,1,1,0],zh=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Uh=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Vh=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Wh=8,_l=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Cl=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ra=null,Hh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Gh=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Jc=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],$h=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Kh=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Yh=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Jh=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Jn=[],Xr=[],Tn=[],Xh=1,Xc=2,Xn=[],Mr=[];ge("UpsampleRgbLinePair",ot,3),ge("UpsampleBgrLinePair",kt,3),ge("UpsampleRgbaLinePair",Jr,4),ge("UpsampleBgraLinePair",Kt,4),ge("UpsampleArgbLinePair",nr,4),ge("UpsampleRgba4444LinePair",Ut,2),ge("UpsampleRgb565LinePair",It,2);var Qh=M.UpsampleRgbLinePair,Zh=M.UpsampleBgrLinePair,Qc=M.UpsampleRgbaLinePair,Zc=M.UpsampleBgraLinePair,eu=M.UpsampleArgbLinePair,tu=M.UpsampleRgba4444LinePair,ef=M.UpsampleRgb565LinePair,Za=16,eo=1<<Za-1,na=-227,Il=482,ru=6,tf=(256<<ru)-1,nu=0,rf=s(256),nf=s(256),sf=s(256),af=s(256),of=s(Il-na),lf=s(Il-na);mn("YuvToRgbRow",ot,3),mn("YuvToBgrRow",kt,3),mn("YuvToRgbaRow",Jr,4),mn("YuvToBgraRow",Kt,4),mn("YuvToArgbRow",nr,4),mn("YuvToRgba4444Row",Ut,2),mn("YuvToRgb565Row",It,2);var iu=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],to=[0,2,8],cf=[8,7,6,4,4,2,2,2,1,1,1,1],uf=1;this.WebPDecodeRGBA=function(a,c,f,x,j){var L=Ya,P=new $i,C=new Vr;P.ba=C,C.S=L,C.width=[C.width],C.height=[C.height];var O=C.width,D=C.height,J=new Ln;if(J==null||a==null)var oe=2;else e(J!=null),oe=Yi(a,c,f,J.width,J.height,J.Pd,J.Qd,J.format,null);if(oe!=0?O=0:(O!=null&&(O[0]=J.width[0]),D!=null&&(D[0]=J.height[0]),O=1),O){C.width=C.width[0],C.height=C.height[0],x!=null&&(x[0]=C.width),j!=null&&(j[0]=C.height);e:{if(x=new qi,(j=new Us).data=a,j.w=c,j.ha=f,j.kd=1,c=[0],e(j!=null),((a=Yi(j.data,j.w,j.ha,null,null,null,c,null,j))==0||a==7)&&c[0]&&(a=4),(c=a)==0){if(e(P!=null),x.data=j.data,x.w=j.w+j.offset,x.ha=j.ha-j.offset,x.put=ln,x.ac=Qt,x.bc=cn,x.ma=P,j.xa){if((a=Er())==null){P=1;break e}if(function(le,re){var be=[0],pe=[0],X=[0];t:for(;;){if(le==null)return 0;if(re==null)return le.a=2,0;if(le.l=re,le.a=0,se(le.m,re.data,re.w,re.ha),!Ue(le.m,be,pe,X)){le.a=3;break t}if(le.xb=Xc,re.width=be[0],re.height=pe[0],!hn(be[0],pe[0],1,le,null))break t;return 1}return e(le.a!=0),0}(a,x)){if(x=(c=Ji(x.width,x.height,P.Oa,P.ba))==0){t:{x=a;r:for(;;){if(x==null){x=0;break t}if(e(x.s.yc!=null),e(x.s.Ya!=null),e(0<x.s.Wb),e((f=x.l)!=null),e((j=f.ma)!=null),x.xb!=0){if(x.ca=j.ba,x.tb=j.tb,e(x.ca!=null),!Ks(j.Oa,f,Ja)){x.a=2;break r}if(!fi(x,f.width)||f.da)break r;if((f.da||ft(x.ca.S))&&ie(),11>x.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),x.ca.f.kb.F!=null&&ie()),x.Pb&&0<x.s.ua&&x.s.vb.X==null&&!Ve(x.s.vb,x.s.Wa.Xa)){x.a=1;break r}x.xb=0}if(!$r(x,x.V,x.Ba,x.c,x.i,f.o,Ti))break r;j.Dc=x.Ma,x=1;break t}e(x.a!=0),x=0}x=!x}x&&(c=a.a)}else c=a.a}else{if((a=new il)==null){P=1;break e}if(a.Fa=j.na,a.P=j.P,a.qc=j.Sa,La(a,x)){if((c=Ji(x.width,x.height,P.Oa,P.ba))==0){if(a.Aa=0,f=P.Oa,e((j=a)!=null),f!=null){if(0<(O=0>(O=f.Md)?0:100<O?255:255*O/100)){for(D=J=0;4>D;++D)12>(oe=j.pb[D]).lc&&(oe.ia=O*cf[0>oe.lc?0:oe.lc]>>3),J|=oe.ia;J&&(alert("todo:VP8InitRandom"),j.ia=1)}j.Ga=f.Id,100<j.Ga?j.Ga=100:0>j.Ga&&(j.Ga=0)}sl(a,x)||(c=a.a)}}else c=a.a}c==0&&P.Oa!=null&&P.Oa.fd&&(c=Ys(P.ba))}P=c}L=P!=0?null:11>L?C.f.RGBA.eb:C.f.kb.y}else L=null;return L};var su=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function m(M,Q){for(var ce="",E=0;E<4;E++)ce+=String.fromCharCode(M[Q++]);return ce}function g(M,Q){return(M[Q+0]<<0|M[Q+1]<<8|M[Q+2]<<16)>>>0}function v(M,Q){return(M[Q+0]<<0|M[Q+1]<<8|M[Q+2]<<16|M[Q+3]<<24)>>>0}new d;var y=[0],p=[0],N=[],b=new d,I=r,w=function(M,Q){var ce={},E=0,_=!1,B=0,q=0;if(ce.frames=[],!function(R,z,Y,ne){for(var ue=0;ue<ne;ue++)if(R[z+ue]!=Y.charCodeAt(ue))return!0;return!1}(M,Q,"RIFF",4)){for(v(M,Q+=4),Q+=8;Q<M.length;){var ae=m(M,Q),K=v(M,Q+=4);Q+=4;var fe=K+(1&K);switch(ae){case"VP8 ":case"VP8L":ce.frames[E]===void 0&&(ce.frames[E]={}),(ee=ce.frames[E]).src_off=_?q:Q-8,ee.src_size=B+K+8,E++,_&&(_=!1,B=0,q=0);break;case"VP8X":(ee=ce.header={}).feature_flags=M[Q];var se=Q+4;ee.canvas_width=1+g(M,se),se+=3,ee.canvas_height=1+g(M,se),se+=3;break;case"ALPH":_=!0,B=fe+8,q=Q-8;break;case"ANIM":(ee=ce.header).bgcolor=v(M,Q),se=Q+4,ee.loop_count=(Le=M)[(k=se)+0]<<0|Le[k+1]<<8,se+=2;break;case"ANMF":var me,ee;(ee=ce.frames[E]={}).offset_x=2*g(M,Q),Q+=3,ee.offset_y=2*g(M,Q),Q+=3,ee.width=1+g(M,Q),Q+=3,ee.height=1+g(M,Q),Q+=3,ee.duration=g(M,Q),Q+=3,me=M[Q++],ee.dispose=1&me,ee.blend=me>>1&1}ae!="ANMF"&&(Q+=fe)}var Le,k;return ce}}(I,0);w.response=I,w.rgbaoutput=!0,w.dataurl=!1;var S=w.header?w.header:null,T=w.frames?w.frames:null;if(S){S.loop_counter=S.loop_count,y=[S.canvas_height],p=[S.canvas_width];for(var W=0;W<T.length&&T[W].blend!=0;W++);}var G=T[0],te=b.WebPDecodeRGBA(I,G.src_off,G.src_size,p,y);G.rgba=te,G.imgwidth=p[0],G.imgheight=y[0];for(var H=0;H<p[0]*y[0]*4;H++)N[H]=te[H];return this.width=p,this.height=y,this.data=N,this}(function(r){var e=function(){return typeof pc=="function"},t=function(y,p,N,b){var I=4,w=l;switch(b){case r.image_compression.FAST:I=1,w=s;break;case r.image_compression.MEDIUM:I=6,w=u;break;case r.image_compression.SLOW:I=9,w=d}y=n(y,p,N,w);var S=pc(y,{level:I});return r.__addimage__.arrayBufferToBinaryString(S)},n=function(y,p,N,b){for(var I,w,S,T=y.length/p,W=new Uint8Array(y.length+T),G=g(),te=0;te<T;te+=1){if(S=te*p,I=y.subarray(S,S+p),b)W.set(b(I,N,w),S+te);else{for(var H,M=G.length,Q=[];H<M;H+=1)Q[H]=G[H](I,N,w);var ce=v(Q.concat());W.set(Q[ce],S+te)}w=I}return W},i=function(y){var p=Array.apply([],y);return p.unshift(0),p},s=function(y,p){var N,b=[],I=y.length;b[0]=1;for(var w=0;w<I;w+=1)N=y[w-p]||0,b[w+1]=y[w]-N+256&255;return b},l=function(y,p,N){var b,I=[],w=y.length;I[0]=2;for(var S=0;S<w;S+=1)b=N&&N[S]||0,I[S+1]=y[S]-b+256&255;return I},u=function(y,p,N){var b,I,w=[],S=y.length;w[0]=3;for(var T=0;T<S;T+=1)b=y[T-p]||0,I=N&&N[T]||0,w[T+1]=y[T]+256-(b+I>>>1)&255;return w},d=function(y,p,N){var b,I,w,S,T=[],W=y.length;T[0]=4;for(var G=0;G<W;G+=1)b=y[G-p]||0,I=N&&N[G]||0,w=N&&N[G-p]||0,S=m(b,I,w),T[G+1]=y[G]-S+256&255;return T},m=function(y,p,N){if(y===p&&p===N)return y;var b=Math.abs(p-N),I=Math.abs(y-N),w=Math.abs(y+p-N-N);return b<=I&&b<=w?y:I<=w?p:N},g=function(){return[i,s,l,u,d]},v=function(y){var p=y.map(function(N){return N.reduce(function(b,I){return b+Math.abs(I)},0)});return p.indexOf(Math.min.apply(null,p))};r.processPNG=function(y,p,N,b){var I,w,S,T,W,G,te,H,M,Q,ce,E,_,B,q,ae=this.decode.FLATE_DECODE,K="";if(this.__addimage__.isArrayBuffer(y)&&(y=new Uint8Array(y)),this.__addimage__.isArrayBufferView(y)){if(y=(S=new q2(y)).imgData,w=S.bits,I=S.colorSpace,W=S.colors,[4,6].indexOf(S.colorType)!==-1){if(S.bits===8){M=(H=S.pixelBitlength==32?new Uint32Array(S.decodePixels().buffer):S.pixelBitlength==16?new Uint16Array(S.decodePixels().buffer):new Uint8Array(S.decodePixels().buffer)).length,ce=new Uint8Array(M*S.colors),Q=new Uint8Array(M);var fe,se=S.pixelBitlength-S.bits;for(B=0,q=0;B<M;B++){for(_=H[B],fe=0;fe<se;)ce[q++]=_>>>fe&255,fe+=S.bits;Q[B]=_>>>fe&255}}if(S.bits===16){M=(H=new Uint32Array(S.decodePixels().buffer)).length,ce=new Uint8Array(M*(32/S.pixelBitlength)*S.colors),Q=new Uint8Array(M*(32/S.pixelBitlength)),E=S.colors>1,B=0,q=0;for(var me=0;B<M;)_=H[B++],ce[q++]=_>>>0&255,E&&(ce[q++]=_>>>16&255,_=H[B++],ce[q++]=_>>>0&255),Q[me++]=_>>>16&255;w=8}b!==r.image_compression.NONE&&e()?(y=t(ce,S.width*S.colors,S.colors,b),te=t(Q,S.width,1,b)):(y=ce,te=Q,ae=void 0)}if(S.colorType===3&&(I=this.color_spaces.INDEXED,G=S.palette,S.transparency.indexed)){var ee=S.transparency.indexed,Le=0;for(B=0,M=ee.length;B<M;++B)Le+=ee[B];if((Le/=255)===M-1&&ee.indexOf(0)!==-1)T=[ee.indexOf(0)];else if(Le!==M){for(H=S.decodePixels(),Q=new Uint8Array(H.length),B=0,M=H.length;B<M;B++)Q[B]=ee[H[B]];te=t(Q,S.width,1)}}var k=function(R){var z;switch(R){case r.image_compression.FAST:z=11;break;case r.image_compression.MEDIUM:z=13;break;case r.image_compression.SLOW:z=14;break;default:z=12}return z}(b);return ae===this.decode.FLATE_DECODE&&(K="/Predictor "+k+" "),K+="/Colors "+W+" /BitsPerComponent "+w+" /Columns "+S.width,(this.__addimage__.isArrayBuffer(y)||this.__addimage__.isArrayBufferView(y))&&(y=this.__addimage__.arrayBufferToBinaryString(y)),(te&&this.__addimage__.isArrayBuffer(te)||this.__addimage__.isArrayBufferView(te))&&(te=this.__addimage__.arrayBufferToBinaryString(te)),{alias:N,data:y,index:p,filter:ae,decodeParameters:K,transparency:T,palette:G,sMask:te,predictor:k,width:S.width,height:S.height,bitsPerComponent:w,colorSpace:I}}}})(We.API),function(r){r.processGIF89A=function(e,t,n,i){var s=new z2(e),l=s.width,u=s.height,d=[];s.decodeAndBlitFrameRGBA(0,d);var m={data:d,width:l,height:u},g=new Jl(100).encode(m,100);return r.processJPEG.call(this,g,t,n,i)},r.processGIF87A=r.processGIF89A}(We.API),en.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},en.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){Nt.log("bit decode error:"+t)}},en.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++)for(var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+8*i*4,u=0;u<8&&8*i+u<this.width;u++){var d=this.palette[s>>7-u&1];this.data[l+4*u]=d.blue,this.data[l+4*u+1]=d.green,this.data[l+4*u+2]=d.red,this.data[l+4*u+3]=255}t!==0&&(this.pos+=4-t)}},en.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<r;i++){var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+2*i*4,u=s>>4,d=15&s,m=this.palette[u];if(this.data[l]=m.blue,this.data[l+1]=m.green,this.data[l+2]=m.red,this.data[l+3]=255,2*i+1>=this.width)break;m=this.palette[d],this.data[l+4]=m.blue,this.data[l+4+1]=m.green,this.data[l+4+2]=m.red,this.data[l+4+3]=255}e!==0&&(this.pos+=4-e)}},en.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;if(i<this.palette.length){var l=this.palette[i];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},en.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,u=(s>>5&e)/e*255|0,d=(s>>10&e)/e*255|0,m=s>>15?255:0,g=n*this.width*4+4*i;this.data[g]=d,this.data[g+1]=u,this.data[g+2]=l,this.data[g+3]=m}this.pos+=r}},en.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(l&e)/e*255|0,d=(l>>5&t)/t*255|0,m=(l>>11)/e*255|0,g=i*this.width*4+4*s;this.data[g]=m,this.data[g+1]=d,this.data[g+2]=u,this.data[g+3]=255}this.pos+=r}},en.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*t;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=255}this.pos+=this.width%4}},en.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),u=e*this.width*4+4*t;this.data[u]=s,this.data[u+1]=i,this.data[u+2]=n,this.data[u+3]=l}},en.prototype.getData=function(){return this.data},function(r){r.processBMP=function(e,t,n,i){var s=new en(e,!1),l=s.width,u=s.height,d={data:s.getData(),width:l,height:u},m=new Jl(100).encode(d,100);return r.processJPEG.call(this,m,t,n,i)}}(We.API),cd.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(e,t,n,i){var s=new cd(e),l=s.width,u=s.height,d={data:s.getData(),width:l,height:u},m=new Jl(100).encode(d,100);return r.processJPEG.call(this,m,t,n,i)}}(We.API),We.API.processRGBA=function(r,e,t){for(var n=r.data,i=n.length,s=new Uint8Array(i/4*3),l=new Uint8Array(i/4),u=0,d=0,m=0;m<i;m+=4){var g=n[m],v=n[m+1],y=n[m+2],p=n[m+3];s[u++]=g,s[u++]=v,s[u++]=y,l[d++]=p}var N=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:N,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},We.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ds=We.API,xo=ds.getCharWidthsArray=function(r,e){var t,n,i=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),l=e.charSpace||this.internal.getCharSpace(),u=e.widths?e.widths:i.metadata.Unicode.widths,d=u.fof?u.fof:1,m=e.kerning?e.kerning:i.metadata.Unicode.kerning,g=m.fof?m.fof:1,v=e.doKerning!==!1,y=0,p=r.length,N=0,b=u[0]||d,I=[];for(t=0;t<p;t++)n=r.charCodeAt(t),typeof i.metadata.widthOfString=="function"?I.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+l*(1e3/s)||0)/1e3):(y=v&&vt(m[n])==="object"&&!isNaN(parseInt(m[n][N],10))?m[n][N]/g:0,I.push((u[n]||b)/d+y)),N=n;return I},sd=ds.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return ds.processArabic&&(r=ds.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,t,i)/t:xo.apply(this,arguments).reduce(function(s,l){return s+l},0)},ad=function(r,e,t,n){for(var i=[],s=0,l=r.length,u=0;s!==l&&u+e[s]<t;)u+=e[s],s++;i.push(r.slice(0,s));var d=s;for(u=0;s!==l;)u+e[s]>n&&(i.push(r.slice(d,s)),u=0,d=s),u+=e[s],s++;return d!==s&&i.push(r.slice(d,s)),i},od=function(r,e,t){t||(t={});var n,i,s,l,u,d,m,g=[],v=[g],y=t.textIndent||0,p=0,N=0,b=r.split(" "),I=xo.apply(this,[" ",t])[0];if(d=t.lineIndent===-1?b[0].length+2:t.lineIndent||0){var w=Array(d).join(" "),S=[];b.map(function(W){(W=W.split(/\s*\n/)).length>1?S=S.concat(W.map(function(G,te){return(te&&G.length?`
`:"")+G})):S.push(W[0])}),b=S,d=sd.apply(this,[w,t])}for(s=0,l=b.length;s<l;s++){var T=0;if(n=b[s],d&&n[0]==`
`&&(n=n.substr(1),T=1),y+p+(N=(i=xo.apply(this,[n,t])).reduce(function(W,G){return W+G},0))>e||T){if(N>e){for(u=ad.apply(this,[n,i,e-(y+p),e]),g.push(u.shift()),g=[u.pop()];u.length;)v.push([u.shift()]);N=i.slice(n.length-(g[0]?g[0].length:0)).reduce(function(W,G){return W+G},0)}else g=[n];v.push(g),y=N+d,p=I}else g.push(n),y+=p+N,p=I}return m=d?function(W,G){return(G?w:"")+W.join(" ")}:function(W){return W.join(" ")},v.map(m)},ds.splitTextToSize=function(r,e,t){var n,i=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(g){if(g.widths&&g.kerning)return{widths:g.widths,kerning:g.kerning};var v=this.internal.getFont(g.fontName,g.fontStyle);return v.metadata.Unicode?{widths:v.metadata.Unicode.widths||{0:1},kerning:v.metadata.Unicode.kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var l=1*this.internal.scaleFactor*e/i;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=t.lineIndent;var u,d,m=[];for(u=0,d=n.length;u<d;u++)m=m.concat(od.apply(this,[n[u],l,s]));return m},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},n={},i=0;i<e.length;i++)t[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var s=function(v){return"0x"+parseInt(v,10).toString(16)},l=r.__fontmetrics__.compress=function(v){var y,p,N,b,I=["{"];for(var w in v){if(y=v[w],isNaN(parseInt(w,10))?p="'"+w+"'":(w=parseInt(w,10),p=(p=s(w).slice(2)).slice(0,-1)+n[p.slice(-1)]),typeof y=="number")y<0?(N=s(y).slice(3),b="-"):(N=s(y).slice(2),b=""),N=b+N.slice(0,-1)+n[N.slice(-1)];else{if(vt(y)!=="object")throw new Error("Don't know what to do with value type "+vt(y)+".");N=l(y)}I.push(p+N)}return I.push("}"),I.join("")},u=r.__fontmetrics__.uncompress=function(v){if(typeof v!="string")throw new Error("Invalid argument passed to uncompress.");for(var y,p,N,b,I={},w=1,S=I,T=[],W="",G="",te=v.length-1,H=1;H<te;H+=1)(b=v[H])=="'"?y?(N=y.join(""),y=void 0):y=[]:y?y.push(b):b=="{"?(T.push([S,N]),S={},N=void 0):b=="}"?((p=T.pop())[0][p[1]]=S,N=void 0,S=p[0]):b=="-"?w=-1:N===void 0?t.hasOwnProperty(b)?(W+=t[b],N=parseInt(W,16)*w,w=1,W=""):W+=b:t.hasOwnProperty(b)?(G+=t[b],S[N]=parseInt(G,16)*w,w=1,N=void 0,G=""):G+=b;return I},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},g={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(v){var y=v.font,p=g.Unicode[y.postScriptName];p&&(y.metadata.Unicode={},y.metadata.Unicode.widths=p.widths,y.metadata.Unicode.kerning=p.kerning);var N=m.Unicode[y.postScriptName];N&&(y.metadata.Unicode.encoding=N,y.encoding=N.codePages[0])}])}(We.API),function(r){var e=function(t){for(var n=t.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=t.charCodeAt(s);return i};r.API.events.push(["addFont",function(t){var n=void 0,i=t.font,s=t.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(l,u){u=/^\x00\x01\x00\x00/.test(u)?e(u):e(xa(u)),l.metadata=r.API.TTFFont.open(u),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(i,n)}}])}(We),function(r){function e(){return(He.canvg?Promise.resolve(He.canvg):Ns(()=>import("./index.es-599d02bd.js"),["assets/index.es-599d02bd.js","assets/index-e439054e.js","assets/index-6a1ae680.css","assets/ViewPanelCard-780dac58.js","assets/index.min-45331c48.js","assets/Basic3dViewPanel-6892a15b.js","assets/OrbitControls-945b1259.js","assets/constants-81f60586.js","assets/CreditCostDisplay-278e24ac.js","assets/Button-fcf173b3.js","assets/geminiService-f982c15c.js","assets/authService-2d4415af.js","assets/Input-605e6434.js","assets/projectService-1550175d.js","assets/geometryUtils-5d5cd992.js","assets/ErrorBarContext-f85feee6.js","assets/Label-4a29d029.js","assets/CollaborationModal-7cfc9c99.js","assets/DakshinVaarahiLogo-2a42c54f.js","assets/ExportModal-0b83a680.js"])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}We.API.addSvgAsImage=function(t,n,i,s,l,u,d,m){if(isNaN(n)||isNaN(i))throw Nt.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(l))throw Nt.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var g=document.createElement("canvas");g.width=s,g.height=l;var v=g.getContext("2d");v.fillStyle="#fff",v.fillRect(0,0,g.width,g.height);var y={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return e().then(function(N){return N.fromString(v,t,y)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(N){return N.render(y)}).then(function(){p.addImage(g.toDataURL("image/jpeg",1),n,i,s,l,d,m)})}}(),We.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,t);return this},We.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var n,i,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u=Object.keys(l),d=[],m=0,g=0,v=0;function y(N,b){var I,w=!1;for(I=0;I<N.length;I+=1)N[I]===b&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var p=u.length;for(v=0;v<p;v+=1)t[u[v]].value=t[u[v]].defaultValue,t[u[v]].explicitSet=!1}if(vt(r)==="object"){for(i in r)if(s=r[i],y(u,i)&&s!==void 0){if(t[i].type==="boolean"&&typeof s=="boolean")t[i].value=s;else if(t[i].type==="name"&&y(t[i].valueSet,s))t[i].value=s;else if(t[i].type==="integer"&&Number.isInteger(s))t[i].value=s;else if(t[i].type==="array"){for(m=0;m<s.length;m+=1)if(n=!0,s[m].length===1&&typeof s[m][0]=="number")d.push(String(s[m]-1));else if(s[m].length>1){for(g=0;g<s[m].length;g+=1)typeof s[m][g]!="number"&&(n=!1);n===!0&&d.push([s[m][0]-1,s[m][1]-1].join(" "))}t[i].value="["+d.join(" ")+"]"}else t[i].value=t[i].defaultValue;t[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var N,b=[];for(N in t)t[N].explicitSet===!0&&(t[N].type==="name"?b.push("/"+N+" /"+t[N].value):b.push("/"+N+" "+t[N].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(r){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),u=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),m=s.length+l.length+u.length+i.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+m+" >>"),this.internal.write("stream"),this.internal.write(i+s+l+u+d),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(We.API),function(r){var e=r.API,t=e.pdfEscape16=function(s,l){for(var u,d=l.metadata.Unicode.widths,m=["","0","00","000","0000"],g=[""],v=0,y=s.length;v<y;++v){if(u=l.metadata.characterToGlyph(s.charCodeAt(v)),l.metadata.glyIdsUsed.push(u),l.metadata.toUnicode[u]=s.charCodeAt(v),d.indexOf(u)==-1&&(d.push(u),d.push([parseInt(l.metadata.widthOfGlyph(u),10)])),u=="0")return g.join("");u=u.toString(16),g.push(m[4-u.length],u)}return g.join("")},n=function(s){var l,u,d,m,g,v,y;for(g=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],v=0,y=(u=Object.keys(s).sort(function(p,N){return p-N})).length;v<y;v++)l=u[v],d.length>=100&&(g+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(m=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),d.push("<"+l+"><"+m+">"));return d.length&&(g+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),g+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(l){var u=l.font,d=l.out,m=l.newObject,g=l.putStream;if(u.metadata instanceof r.API.TTFFont&&u.encoding==="Identity-H"){for(var v=u.metadata.Unicode.widths,y=u.metadata.subset.encode(u.metadata.glyIdsUsed,1),p="",N=0;N<y.length;N++)p+=String.fromCharCode(y[N]);var b=m();g({data:p,addLength1:!0,objectId:b}),d("endobj");var I=m();g({data:n(u.metadata.toUnicode),addLength1:!0,objectId:I}),d("endobj");var w=m();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+fs(u.fontName)),d("/FontFile2 "+b+" 0 R"),d("/FontBBox "+r.API.PDFObject.convert(u.metadata.bbox)),d("/Flags "+u.metadata.flags),d("/StemV "+u.metadata.stemV),d("/ItalicAngle "+u.metadata.italicAngle),d("/Ascent "+u.metadata.ascender),d("/Descent "+u.metadata.decender),d("/CapHeight "+u.metadata.capHeight),d(">>"),d("endobj");var S=m();d("<<"),d("/Type /Font"),d("/BaseFont /"+fs(u.fontName)),d("/FontDescriptor "+w+" 0 R"),d("/W "+r.API.PDFObject.convert(v)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+u.encoding+")"),d(">>"),d(">>"),d("endobj"),u.objectNumber=m(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+I+" 0 R"),d("/BaseFont /"+fs(u.fontName)),d("/Encoding /"+u.encoding),d("/DescendantFonts ["+S+" 0 R]"),d(">>"),d("endobj"),u.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(l){var u=l.font,d=l.out,m=l.newObject,g=l.putStream;if(u.metadata instanceof r.API.TTFFont&&u.encoding==="WinAnsiEncoding"){for(var v=u.metadata.rawData,y="",p=0;p<v.length;p++)y+=String.fromCharCode(v[p]);var N=m();g({data:y,addLength1:!0,objectId:N}),d("endobj");var b=m();g({data:n(u.metadata.toUnicode),addLength1:!0,objectId:b}),d("endobj");var I=m();d("<<"),d("/Descent "+u.metadata.decender),d("/CapHeight "+u.metadata.capHeight),d("/StemV "+u.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+N+" 0 R"),d("/Flags 96"),d("/FontBBox "+r.API.PDFObject.convert(u.metadata.bbox)),d("/FontName /"+fs(u.fontName)),d("/ItalicAngle "+u.metadata.italicAngle),d("/Ascent "+u.metadata.ascender),d(">>"),d("endobj"),u.objectNumber=m();for(var w=0;w<u.metadata.hmtx.widths.length;w++)u.metadata.hmtx.widths[w]=parseInt(u.metadata.hmtx.widths[w]*(1e3/u.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+fs(u.fontName)+"/FontDescriptor "+I+" 0 R/Encoding/"+u.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(u.metadata.hmtx.widths)+">>"),d("endobj"),u.isAlreadyPutted=!0}})(s)}]);var i=function(s){var l,u=s.text||"",d=s.x,m=s.y,g=s.options||{},v=s.mutex||{},y=v.pdfEscape,p=v.activeFontKey,N=v.fonts,b=p,I="",w=0,S="",T=N[b].encoding;if(N[b].encoding!=="Identity-H")return{text:u,x:d,y:m,options:g,mutex:v};for(S=u,b=p,Array.isArray(u)&&(S=u[0]),w=0;w<S.length;w+=1)N[b].metadata.hasOwnProperty("cmap")&&(l=N[b].metadata.cmap.unicode.codeMap[S[w].charCodeAt(0)]),l||S[w].charCodeAt(0)<256&&N[b].metadata.hasOwnProperty("Unicode")?I+=S[w]:I+="";var W="";return parseInt(b.slice(1))<14||T==="WinAnsiEncoding"?W=y(I,b).split("").map(function(G){return G.charCodeAt(0).toString(16)}).join(""):T==="Identity-H"&&(W=t(I,N[b])),v.isHex=!0,{text:W,x:d,y:m,options:g,mutex:v}};e.events.push(["postProcessText",function(s){var l=s.text||"",u=[],d={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var m=0;for(m=0;m<l.length;m+=1)Array.isArray(l[m])&&l[m].length===3?u.push([i(Object.assign({},d,{text:l[m][0]})).text,l[m][1],l[m][2]]):u.push(i(Object.assign({},d,{text:l[m]})).text);s.text=u}else s.text=i(Object.assign({},d,{text:l})).text}])}(We),function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(We.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var i,s,l,u,d,m,g,v=e,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],N={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},I=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),S=!1,T=0;this.__bidiEngine__={};var W=function(E){var _=E.charCodeAt(),B=_>>8,q=b[B];return q!==void 0?v[256*q+(255&_)]:B===252||B===253?"AL":w.test(B)?"L":B===8?"R":"N"},G=function(E){for(var _,B=0;B<E.length;B++){if((_=W(E.charAt(B)))==="L")return!1;if(_==="R")return!0}return!1},te=function(E,_,B,q){var ae,K,fe,se,me=_[q];switch(me){case"L":case"R":S=!1;break;case"N":case"AN":break;case"EN":S&&(me="AN");break;case"AL":S=!0,me="R";break;case"WS":me="N";break;case"CS":q<1||q+1>=_.length||(ae=B[q-1])!=="EN"&&ae!=="AN"||(K=_[q+1])!=="EN"&&K!=="AN"?me="N":S&&(K="AN"),me=K===ae?K:"N";break;case"ES":me=(ae=q>0?B[q-1]:"B")==="EN"&&q+1<_.length&&_[q+1]==="EN"?"EN":"N";break;case"ET":if(q>0&&B[q-1]==="EN"){me="EN";break}if(S){me="N";break}for(fe=q+1,se=_.length;fe<se&&_[fe]==="ET";)fe++;me=fe<se&&_[fe]==="EN"?"EN":"N";break;case"NSM":if(l&&!u){for(se=_.length,fe=q+1;fe<se&&_[fe]==="NSM";)fe++;if(fe<se){var ee=E[q],Le=ee>=1425&&ee<=2303||ee===64286;if(ae=_[fe],Le&&(ae==="R"||ae==="AL")){me="R";break}}}me=q<1||(ae=_[q-1])==="B"?"N":B[q-1];break;case"B":S=!1,i=!0,me=T;break;case"S":s=!0,me="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":S=!1;break;case"BN":me="N"}return me},H=function(E,_,B){var q=E.split("");return B&&M(q,B,{hiLevel:T}),q.reverse(),_&&_.reverse(),q.join("")},M=function(E,_,B){var q,ae,K,fe,se,me=-1,ee=E.length,Le=0,k=[],R=T?p:y,z=[];for(S=!1,i=!1,s=!1,ae=0;ae<ee;ae++)z[ae]=W(E[ae]);for(K=0;K<ee;K++){if(se=Le,k[K]=te(E,z,k,K),q=240&(Le=R[se][N[k[K]]]),Le&=15,_[K]=fe=R[Le][5],q>0)if(q===16){for(ae=me;ae<K;ae++)_[ae]=1;me=-1}else me=-1;if(R[Le][6])me===-1&&(me=K);else if(me>-1){for(ae=me;ae<K;ae++)_[ae]=fe;me=-1}z[K]==="B"&&(_[K]=0),B.hiLevel|=fe}s&&function(Y,ne,ue){for(var de=0;de<ue;de++)if(Y[de]==="S"){ne[de]=T;for(var he=de-1;he>=0&&Y[he]==="WS";he--)ne[he]=T}}(z,_,ee)},Q=function(E,_,B,q,ae){if(!(ae.hiLevel<E)){if(E===1&&T===1&&!i)return _.reverse(),void(B&&B.reverse());for(var K,fe,se,me,ee=_.length,Le=0;Le<ee;){if(q[Le]>=E){for(se=Le+1;se<ee&&q[se]>=E;)se++;for(me=Le,fe=se-1;me<fe;me++,fe--)K=_[me],_[me]=_[fe],_[fe]=K,B&&(K=B[me],B[me]=B[fe],B[fe]=K);Le=se}Le++}}},ce=function(E,_,B){var q=E.split(""),ae={hiLevel:T};return B||(B=[]),M(q,B,ae),function(K,fe,se){if(se.hiLevel!==0&&g)for(var me,ee=0;ee<K.length;ee++)fe[ee]===1&&(me=I.indexOf(K[ee]))>=0&&(K[ee]=I[me+1])}(q,B,ae),Q(2,q,_,B,ae),Q(1,q,_,B,ae),q.join("")};return this.__bidiEngine__.doBidiReorder=function(E,_,B){if(function(ae,K){if(K)for(var fe=0;fe<ae.length;fe++)K[fe]=fe;u===void 0&&(u=G(ae)),m===void 0&&(m=G(ae))}(E,_),l||!d||m)if(l&&d&&u^m)T=u?1:0,E=H(E,_,B);else if(!l&&d&&m)T=u?1:0,E=ce(E,_,B),E=H(E,_);else if(!l||u||d||m){if(l&&!d&&u^m)E=H(E,_),u?(T=0,E=ce(E,_,B)):(T=1,E=ce(E,_,B),E=H(E,_));else if(l&&u&&!d&&m)T=1,E=ce(E,_,B),E=H(E,_);else if(!l&&!d&&u^m){var q=g;u?(T=1,E=ce(E,_,B),T=0,g=!1,E=ce(E,_,B),g=q):(T=0,E=ce(E,_,B),E=H(E,_),T=1,g=!1,E=ce(E,_,B),g=q,E=H(E,_))}}else T=0,E=ce(E,_,B);else T=u?1:0,E=ce(E,_,B);return E},this.__bidiEngine__.setOptions=function(E){E&&(l=E.isInputVisual,d=E.isOutputVisual,u=E.isInputRtl,m=E.isOutputRtl,g=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var l=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var u=0;for(l=[],u=0;u<i.length;u+=1)Object.prototype.toString.call(i[u])==="[object Array]"?l.push([t.doBidiReorder(i[u][0]),i[u][1],i[u][2]]):l.push([t.doBidiReorder(i[u])]);n.text=l}else n.text=t.doBidiReorder(i);t.setOptions({isInputVisual:!0})}])}(We),We.API.TTFFont=function(){function r(e){var t;if(this.rawData=e,t=this.contents=new ui(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new r5(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new U2(this.contents),this.head=new W2(this),this.name=new Y2(this),this.cmap=new wh(this),this.toUnicode={},this.hhea=new H2(this),this.maxp=new J2(this),this.hmtx=new X2(this),this.post=new $2(this),this.os2=new G2(this),this.loca=new t5(this),this.glyf=new Q2(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,u,d,m;for(m=[],l=0,u=(d=this.bbox).length;l<u;l++)e=d[l],m.push(Math.round(e*this.scaleFactor));return m}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(t=i>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,n){var i,s,l,u;for(l=0,s=0,u=(e=""+e).length;0<=u?s<u:s>u;s=0<=u?++s:--s)i=e.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/t)||0;return l*(t/1e3)},r.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},r}();var an,ui=function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(e){var t,n,i;for(i=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)i.push(this.writeByte(e.charCodeAt(t)));return i},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,n,i,s,l,u,d;return e=this.readByte(),t=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),l=this.readByte(),u=this.readByte(),d=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^l)+256*(255^u)+(255^d)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*i+16777216*s+65536*l+256*u+d},r.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},r.prototype.write=function(e){var t,n,i,s;for(s=[],n=0,i=e.length;n<i;n++)t=e[n],s.push(this.writeByte(t));return s},r}(),U2=function(){var r;function e(t){var n,i,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,i,s,l,u,d,m,g,v,y,p,N,b;for(b in p=Object.keys(t).length,d=Math.log(2),v=16*Math.floor(Math.log(p)/d),l=Math.floor(v/d),g=16*p-v,(i=new ui).writeInt(this.scalarType),i.writeShort(p),i.writeShort(v),i.writeShort(l),i.writeShort(g),s=16*p,m=i.pos+s,u=null,N=[],t)for(y=t[b],i.writeString(b),i.writeInt(r(y)),i.writeInt(m),i.writeInt(y.length),N=N.concat(y),b==="head"&&(u=m),m+=y.length;m%4;)N.push(0),m++;return i.write(N),n=2981146554-r(i.data),i.pos=u+8,i.writeUInt32(n),i.data},r=function(t){var n,i,s,l;for(t=Nh.call(t);t.length%4;)t.push(0);for(s=new ui(t),i=0,n=0,l=t.length;n<l;n=n+=4)i+=s.readUInt32();return 4294967295&i},e}(),V2={}.hasOwnProperty,Sn=function(r,e){for(var t in e)V2.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};an=function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var W2=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new ui).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e}(),ud=function(){function r(e,t){var n,i,s,l,u,d,m,g,v,y,p,N,b,I,w,S,T;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=e.readByte();break;case 4:for(p=e.readUInt16(),y=p/2,e.pos+=6,s=function(){var W,G;for(G=[],d=W=0;0<=y?W<y:W>y;d=0<=y?++W:--W)G.push(e.readUInt16());return G}(),e.pos+=2,b=function(){var W,G;for(G=[],d=W=0;0<=y?W<y:W>y;d=0<=y?++W:--W)G.push(e.readUInt16());return G}(),m=function(){var W,G;for(G=[],d=W=0;0<=y?W<y:W>y;d=0<=y?++W:--W)G.push(e.readUInt16());return G}(),g=function(){var W,G;for(G=[],d=W=0;0<=y?W<y:W>y;d=0<=y?++W:--W)G.push(e.readUInt16());return G}(),i=(this.length-e.pos+this.offset)/2,u=function(){var W,G;for(G=[],d=W=0;0<=i?W<i:W>i;d=0<=i?++W:--W)G.push(e.readUInt16());return G}(),d=w=0,T=s.length;w<T;d=++w)for(I=s[d],n=S=N=b[d];N<=I?S<=I:S>=I;n=N<=I?++S:--S)g[d]===0?l=n+m[d]:(l=u[g[d]/2+(n-N)-(y-d)]||0)!==0&&(l+=m[d]),this.codeMap[n]=65535&l}e.pos=v}return r.encode=function(e,t){var n,i,s,l,u,d,m,g,v,y,p,N,b,I,w,S,T,W,G,te,H,M,Q,ce,E,_,B,q,ae,K,fe,se,me,ee,Le,k,R,z,Y,ne,ue,de,he,Se,Ae,Ee;switch(q=new ui,l=Object.keys(e).sort(function(_e,Ve){return _e-Ve}),t){case"macroman":for(b=0,I=function(){var _e=[];for(N=0;N<256;++N)_e.push(0);return _e}(),S={0:0},s={},ae=0,me=l.length;ae<me;ae++)S[he=e[i=l[ae]]]==null&&(S[he]=++b),s[i]={old:e[i],new:S[e[i]]},I[i]=S[e[i]];return q.writeUInt16(1),q.writeUInt16(0),q.writeUInt32(12),q.writeUInt16(0),q.writeUInt16(262),q.writeUInt16(0),q.write(I),{charMap:s,subtable:q.data,maxGlyphID:b+1};case"unicode":for(_=[],v=[],T=0,S={},n={},w=m=null,K=0,ee=l.length;K<ee;K++)S[G=e[i=l[K]]]==null&&(S[G]=++T),n[i]={old:G,new:S[G]},u=S[G]-i,w!=null&&u===m||(w&&v.push(w),_.push(i),m=u),w=i;for(w&&v.push(w),v.push(65535),_.push(65535),ce=2*(Q=_.length),M=2*Math.pow(Math.log(Q)/Math.LN2,2),y=Math.log(M/2)/Math.LN2,H=2*Q-M,d=[],te=[],p=[],N=fe=0,Le=_.length;fe<Le;N=++fe){if(E=_[N],g=v[N],E===65535){d.push(0),te.push(0);break}if(E-(B=n[E].new)>=32768)for(d.push(0),te.push(2*(p.length+Q-N)),i=se=E;E<=g?se<=g:se>=g;i=E<=g?++se:--se)p.push(n[i].new);else d.push(B-E),te.push(0)}for(q.writeUInt16(3),q.writeUInt16(1),q.writeUInt32(12),q.writeUInt16(4),q.writeUInt16(16+8*Q+2*p.length),q.writeUInt16(0),q.writeUInt16(ce),q.writeUInt16(M),q.writeUInt16(y),q.writeUInt16(H),ue=0,k=v.length;ue<k;ue++)i=v[ue],q.writeUInt16(i);for(q.writeUInt16(0),de=0,R=_.length;de<R;de++)i=_[de],q.writeUInt16(i);for(Se=0,z=d.length;Se<z;Se++)u=d[Se],q.writeUInt16(u);for(Ae=0,Y=te.length;Ae<Y;Ae++)W=te[Ae],q.writeUInt16(W);for(Ee=0,ne=p.length;Ee<ne;Ee++)b=p[Ee],q.writeUInt16(b);return{charMap:n,subtable:q.data,maxGlyphID:T+1}}},r}(),wh=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,i,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)n=new ud(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var i,s;return n==null&&(n="macroman"),i=ud.encode(t,n),(s=new ui).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},e}(),H2=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),G2=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(t.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(t.readInt());return i}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(t.readInt());return i}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),$2=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="post",e.prototype.parse=function(t){var n,i,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var l;for(i=t.readUInt16(),this.glyphNameIndex=[],l=0;0<=i?l<i:l>i;l=0<=i?++l:--l)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)n=t.readByte(),s.push(this.names.push(t.readString(n)));return s;case 151552:return i=t.readUInt16(),this.offsets=t.read(i);case 196608:break;case 262144:return this.map=(function(){var u,d,m;for(m=[],l=u=0,d=this.file.maxp.numGlyphs;0<=d?u<d:u>d;l=0<=d?++u:--u)m.push(t.readUInt32());return m}).call(this)}},e}(),K2=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Y2=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="name",e.prototype.parse=function(t){var n,i,s,l,u,d,m,g,v,y,p;for(t.pos=this.offset,t.readShort(),n=t.readShort(),d=t.readShort(),i=[],l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+d+t.readShort()});for(m={},l=v=0,y=i.length;v<y;l=++v)s=i[l],t.pos=s.offset,g=t.readString(s.length),u=new K2(g,s),m[p=s.nameID]==null&&(m[p]=[]),m[s.nameID].push(u);this.strings=m,this.copyright=m[0],this.fontFamily=m[1],this.fontSubfamily=m[2],this.uniqueSubfamily=m[3],this.fontName=m[4],this.version=m[5];try{this.postscriptName=m[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=m[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=m[7],this.manufacturer=m[8],this.designer=m[9],this.description=m[10],this.vendorUrl=m[11],this.designerUrl=m[12],this.license=m[13],this.licenseUrl=m[14],this.preferredFamily=m[15],this.preferredSubfamily=m[17],this.compatibleFull=m[18],this.sampleText=m[19]},e}(),J2=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),X2=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,i,s,l,u,d,m;for(t.pos=this.offset,this.metrics=[],n=0,d=this.file.hhea.numberOfMetrics;0<=d?n<d:n>d;n=0<=d?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var g,v;for(v=[],n=g=0;0<=s?g<s:g>s;n=0<=s?++g:--g)v.push(t.readInt16());return v}(),this.widths=(function(){var g,v,y,p;for(p=[],g=0,v=(y=this.metrics).length;g<v;g++)l=y[g],p.push(l.advance);return p}).call(this),i=this.widths[this.widths.length-1],m=[],n=u=0;0<=s?u<s:u>s;n=0<=s?++u:--u)m.push(this.widths.push(i));return m},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),Nh=[].slice,Q2=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,i,s,l,u,d,m,g,v,y;return t in this.cache?this.cache[t]:(l=this.file.loca,n=this.file.contents,i=l.indexOf(t),(s=l.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+i,u=(d=new ui(n.read(s))).readShort(),g=d.readShort(),y=d.readShort(),m=d.readShort(),v=d.readShort(),this.cache[t]=u===-1?new e5(d,g,y,m,v):new Z2(d,u,g,y,m,v),this.cache[t]))},e.prototype.encode=function(t,n,i){var s,l,u,d,m;for(u=[],l=[],d=0,m=n.length;d<m;d++)s=t[n[d]],l.push(u.length),s&&(u=u.concat(s.encode(i)));return l.push(u.length),{table:u,offsets:l}},e}(),Z2=function(){function r(e,t,n,i,s,l){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=l,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),e5=function(){function r(e,t,n,i,s){var l,u;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;u=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&u;)l.pos+=1&u?4:2,128&u?l.pos+=8:64&u?l.pos+=4:8&u&&(l.pos+=2)}return r.prototype.encode=function(){var e,t,n;for(t=new ui(Nh.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},r}(),t5=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Sn(e,an),e.prototype.tag="loca",e.prototype.parse=function(t){var n,i;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,l;for(l=[],i=0,s=this.length;i<s;i+=2)l.push(2*t.readUInt16());return l}).call(this):(function(){var s,l;for(l=[],i=0,s=this.length;i<s;i+=4)l.push(t.readUInt32());return l}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var i=new Uint32Array(this.offsets.length),s=0,l=0,u=0;u<i.length;++u)if(i[u]=s,l<n.length&&n[l]==u){++l,i[u]=s;var d=this.offsets[u],m=this.offsets[u+1]-d;m>0&&(s+=m)}for(var g=new Array(4*i.length),v=0;v<i.length;++v)g[4*v+3]=255&i[v],g[4*v+2]=(65280&i[v])>>8,g[4*v+1]=(16711680&i[v])>>16,g[4*v]=(4278190080&i[v])>>24;return g},e}(),r5=function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,n,i,s;for(t in i=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[t],e[t]=i[n];return e},r.prototype.glyphsFor=function(e){var t,n,i,s,l,u,d;for(i={},l=0,u=e.length;l<u;l++)i[s=e[l]]=this.font.glyf.glyphFor(s);for(s in t=[],i)(n=i[s])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(s in d=this.glyphsFor(t))n=d[s],i[s]=n;return i},r.prototype.encode=function(e,t){var n,i,s,l,u,d,m,g,v,y,p,N,b,I,w;for(i in n=wh.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(e),p={0:0},w=n.charMap)p[(d=w[i]).old]=d.new;for(N in y=n.maxGlyphID,l)N in p||(p[N]=y++);return g=function(S){var T,W;for(T in W={},S)W[S[T]]=T;return W}(p),v=Object.keys(g).sort(function(S,T){return S-T}),b=function(){var S,T,W;for(W=[],S=0,T=v.length;S<T;S++)u=v[S],W.push(g[u]);return W}(),s=this.font.glyf.encode(l,b,p),m=this.font.loca.encode(s.offsets,b),I={cmap:this.font.cmap.raw(),glyf:s.table,loca:m,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(I["OS/2"]=this.font.os2.raw()),this.font.directory.encode(I)},r}();We.API.PDFObject=function(){var r;function e(){}return r=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,i,s,l;if(Array.isArray(t))return"["+function(){var u,d,m;for(m=[],u=0,d=t.length;u<d;u++)n=t[u],m.push(e.convert(n));return m}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(i in s=["<<"],t)l=t[i],s.push("/"+i+" "+e.convert(l));return s.push(">>"),s.join(`
`)}return""+t},e}();const nn=1191,qr=842,yo=40,ps=100,wc=.01,Ci=(r,e)=>{const t=(r.x-e.minX)*e.scale+e.offsetX,n=(r.y-e.minY)*e.scale+e.offsetY;return{x:t,y:n}},n5=r=>{const e=r.walls.flatMap(l=>[{x:l.x1,y:l.y1},{x:l.x2,y:l.y2}]);if(e.length===0)return{minX:0,minY:0,width:1,height:1};const t=Math.min(...e.map(l=>l.x)),n=Math.min(...e.map(l=>l.y)),i=Math.max(...e.map(l=>l.x)),s=Math.max(...e.map(l=>l.y));return{minX:t,minY:n,width:Math.max(1,i-t),height:Math.max(1,s-n)}},i5=({projectName:r,sheetName:e,userName:t})=>o.jsxs("g",{className:"title-block",children:[o.jsx("rect",{x:"0",y:qr-ps,width:nn,height:ps,className:"fill"}),o.jsx("line",{x1:"0",y1:qr-ps,x2:nn,y2:qr-ps,className:"stroke-heavy"}),o.jsx("line",{x1:nn-250,y1:qr-ps,x2:nn-250,y2:qr,className:"stroke-light"}),o.jsx("text",{x:"20",y:qr-60,className:"title-text",children:r}),o.jsxs("text",{x:"20",y:qr-35,className:"subtitle-text",children:["Architect: ",t]}),o.jsx("text",{x:nn-230,y:qr-60,className:"sheet-text",children:e}),o.jsxs("text",{x:nn-230,y:qr-35,className:"date-text",children:["Date: ",new Date().toLocaleDateString()]})]}),s5=({dim:r,bounds:e})=>{const t={x:r.p1.x,y:r.p1.y},n={x:r.p2.x,y:r.p2.y},i=new As(n.x-t.x,n.y-t.y),s=i.length(),l=i.clone().normalize().rotateAround(new As(0,0),Math.PI/2).multiplyScalar(r.offsetDistance),u=Ci({x:t.x+l.x,y:t.y+l.y},e),d=Ci({x:n.x+l.x,y:n.y+l.y},e),m={x:(u.x+d.x)/2,y:(u.y+d.y)/2},g=i.angle()*(180/Math.PI),v=(s*wc).toFixed(2)+"m";return o.jsxs("g",{className:"dimension",children:[o.jsx("line",{x1:u.x,y1:u.y,x2:d.x,y2:d.y}),o.jsx("text",{x:m.x,y:m.y-5,transform:`rotate(${g>90||g<-90?g+180:g}, ${m.x}, ${m.y})`,children:v})]})},a5=({placement:r,wall:e,bounds:t})=>{const n=new As(e.x2-e.x1,e.y2-e.y1),i=n.angle()*(180/Math.PI),s=n.clone().multiplyScalar(r.positionRatio).add(new As(e.x1,e.y1)),l=Ci(s,t),u=r.width*t.scale,d=e.thickness*t.scale;return o.jsxs("g",{transform:`translate(${l.x}, ${l.y}) rotate(${i})`,className:"door",children:[o.jsx("rect",{x:-u/2,y:-d/2,width:u,height:d,className:"opening-fill"}),o.jsx("rect",{x:-u/2,y:-d/2,width:u,height:4,className:"leaf-stroke"}),o.jsx("path",{d:`M ${-u/2} ${-d/2} A ${u} ${u} 0 0 1 ${u/2} ${-d/2+u}`,className:"swing-arc"})]})},o5=({placement:r,wall:e,bounds:t})=>{const n=new As(e.x2-e.x1,e.y2-e.y1),i=n.angle()*(180/Math.PI),s=n.clone().multiplyScalar(r.positionRatio).add(new As(e.x1,e.y1)),l=Ci(s,t),u=r.width*t.scale,d=e.thickness*t.scale;return o.jsxs("g",{transform:`translate(${l.x}, ${l.y}) rotate(${i})`,className:"window",children:[o.jsx("rect",{x:-u/2,y:-d/2,width:u,height:d,className:"opening-fill"}),o.jsx("rect",{x:-u/2,y:-d/2,width:u,height:d,className:"leaf-stroke"}),o.jsx("line",{x1:-u/2,y1:0,x2:u/2,y2:0,className:"leaf-stroke"})]})},l5=({projectData:r,currentUser:e})=>{const[t,n]=V.useState(0),i=()=>{const p=document.getElementById("drawing-svg-export");if(!p)return;new We({orientation:"landscape",unit:"px",format:[nn,qr]}).html(p.outerHTML,{callback:function(b){b.save(`${r.name}_${r.levels[t].name}.pdf`)},x:0,y:0,width:nn,windowWidth:nn})},s=r.levels[t],l=V.useMemo(()=>n5(s),[s]),u={width:nn-yo*2,height:qr-yo*2-ps},d=Math.min(u.width/l.width,u.height/l.height),m=(u.width-l.width*d)/2+yo,g=(u.height-l.height*d)/2+yo,v={minX:l.minX,minY:l.minY,scale:d,offsetX:m,offsetY:g},y=p=>{const b=p.wallIds.map(S=>s.walls.find(T=>T.id===S)).filter(Boolean).flatMap(S=>[{x:S.x1,y:S.y1},{x:S.x2,y:S.y2}]),I=Array.from(new Map(b.map(S=>[`${S.x},${S.y}`,S])).values());if(I.length===0)return{x:0,y:0};const w=I.reduce((S,T)=>({x:S.x+T.x,y:S.y+T.y}),{x:0,y:0});return w.x/=I.length,w.y/=I.length,w};return o.jsxs("div",{className:"w-full bg-slate-700 p-2 rounded-lg",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2 px-2",children:[o.jsx("div",{className:"flex gap-1 bg-slate-800 p-1 rounded-md",children:r.levels.map((p,N)=>o.jsx("button",{onClick:()=>n(N),className:`px-3 py-1 text-xs rounded ${t===N?"bg-sky-600 text-white":"hover:bg-slate-700"}`,children:p.name},p.id))}),o.jsx("button",{onClick:i,className:"px-4 py-1 text-xs font-semibold bg-sky-600 hover:bg-sky-500 rounded-md",children:"Export PDF"})]}),o.jsxs("svg",{id:"drawing-svg-export",viewBox:`0 0 ${nn} ${qr}`,className:"w-full h-auto bg-white rounded-md",children:[o.jsx("style",{children:`
                    .stroke-heavy { stroke: #000; stroke-width: 0.8; }
                    .stroke-medium { stroke: #000; stroke-width: 0.5; }
                    .stroke-light { stroke: #000; stroke-width: 0.2; }
                    .fill { fill: white; }
                    .opening-fill { fill: white; }
                    .dimension { stroke: #555; stroke-width: 0.2; fill: #555; font-size: 8px; font-family: sans-serif; text-anchor: middle; }
                    .room-label { fill: #000; font-size: 10px; font-family: sans-serif; text-anchor: middle; }
                    .door .leaf-stroke { stroke: #000; stroke-width: 0.3; fill: none; }
                    .door .swing-arc { stroke: #888; stroke-width: 0.2; fill: none; stroke-dasharray: 2,2; }
                    .window .leaf-stroke { stroke: #000; stroke-width: 0.3; fill: none; }
                    .title-block { font-family: sans-serif; }
                    .title-block .title-text { font-size: 20px; font-weight: bold; }
                    .title-block .subtitle-text { font-size: 14px; }
                    .title-block .sheet-text { font-size: 18px; font-weight: bold; }
                    .title-block .date-text { font-size: 12px; }
                `}),o.jsxs("g",{id:"main-drawing",children:[s.walls.map(p=>{const N=Ci({x:p.x1,y:p.y1},v),b=Ci({x:p.x2,y:p.y2},v);return o.jsx("line",{x1:N.x,y1:N.y,x2:b.x,y2:b.y,className:"stroke-heavy"},p.id)}),s.placements.map(p=>{const N=s.walls.find(b=>b.id===p.wallId);return N?p.type==="door"?o.jsx(a5,{placement:p,wall:N,bounds:v},p.id):p.type==="window"?o.jsx(o5,{placement:p,wall:N,bounds:v},p.id):null:null}),s.rooms.map(p=>{const N=y(p),b=Ci(N,v),I=(Vp(p.wallIds.map(w=>s.walls.find(S=>S.id===w)).filter(Boolean))*wc*wc).toFixed(1);return o.jsxs("text",{x:b.x,y:b.y,className:"room-label",children:[o.jsx("tspan",{x:b.x,dy:"0",children:p.name}),o.jsxs("tspan",{x:b.x,dy:"1.2em",children:[I," sq.m"]})]},p.id)}),(s.dimensionLines||[]).map(p=>o.jsx(s5,{dim:p,bounds:v},p.id))]}),o.jsx(i5,{projectName:r.name||"Untitled",sheetName:s.name,userName:(e==null?void 0:e.name)||"AuraOS User"})]})]})},c5=r=>{var H,M,Q;const{currentUser:e,setDrawingSet:t,setBuyCreditsModalOpen:n,refreshCurrentUser:i,levels:s,activeLevelIndex:l,planNorthDirection:u,propertyLines:d,terrainMesh:m,currentProject:g}=r,v=(H=s[l])==null?void 0:H.drawingSet,[y,p]=V.useState(!1),[N,b]=V.useState(!1),[I,w]=V.useState(null),{addNotification:S}=pr(),W=$e().createProjectData({name:((M=r.currentProject)==null?void 0:M.name)||"Untitled Project",projectType:((Q=r.currentProject)==null?void 0:Q.projectType)||"building",levels:s,planNorthDirection:u,propertyLines:d,terrainMesh:m,zones:[],infrastructure:[]}),G=async()=>{if(!e){S("Please log in to use this feature.","error");return}if(e.role!=="owner"&&e.credits<150){S(`You need 150 credits for the Vishwakarma Engine. You have ${e.credits}.`,"info"),n(!0);return}p(!0),w(null),t(null);try{const ce=await dp((g==null?void 0:g.id)||"",W);t(ce),S("Vishwakarma Engine has generated a GFC Drawing Set!","success"),await i()}catch(ce){w(ce.message||"An unexpected error occurred."),S(ce.message,"error")}finally{p(!1)}},te=async()=>{if(!g){S("No project loaded to export.","error");return}b(!0);try{await Bp(g.id,g.name),S("DXF file export started.","success")}catch(ce){S(`DXF export failed: ${ce.message}`,"error")}finally{b(!1)}};return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Vishwakarma Engine"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:'The ultimate detailing tool. The Vishwakarma Engine synthesizes your entire project into a professional, "Good for Construction" (GFC) document set, complete with MEP layers, material legends, and detailed construction notes.'}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("button",{onClick:G,disabled:y,className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[y?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"🛠️"}),o.jsxs("span",{className:"flex-grow text-sm",children:[v?"Regenerate":"Generate"," GFC Set"]}),o.jsx("span",{className:"text-xs bg-black/30 px-2 py-0.5 rounded-full",children:"150cr"})]}),o.jsxs("button",{onClick:te,disabled:N,className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-emerald-600 to-teal-700 hover:from-emerald-700 hover:to-teal-800",children:[N?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"📄"}),o.jsx("span",{className:"flex-grow text-sm",children:"Export DXF"})]})]}),I&&o.jsx("p",{className:"text-red-400 text-xs mt-2",children:I}),v&&o.jsx("div",{className:"mt-4 p-2 bg-slate-900/50 rounded-lg",children:o.jsx(l5,{sheet:v,projectData:W,currentUser:e})})]})},u5=r=>{const{currentUser:e,setBuyCreditsModalOpen:t,refreshCurrentUser:n,selectedObject:i,currentProject:s,setGeneratedDocuments:l}=r,[u,d]=V.useState(!1),{addNotification:m}=pr(),g=async()=>{if(!i){m("Please select an object in the 2D or 3D view first.","info");return}if(!e||!s){m("Please log in and open a project.","error");return}if(e.role!=="owner"&&e.credits<50){m("You need 50 credits for the Fabricator Engine.","info"),t(!0);return}d(!0);try{const{files:v,elementName:y}=await hp(s.id,i),p=v.map(b=>{const I={name:`${y}_${b.fileName}`,type:"Fabrication File",url:`data:${b.mimeType};charset=utf-8,${encodeURIComponent(b.content)}`};return qp(s.id,I)}),N=await Promise.all(p);N.length>0&&l(N[N.length-1]),m(`Fabrication files for "${y}" generated and saved to Project Hub.`,"success"),await n()}catch(v){m(`Fabrication failed: ${v.message}`,"error")}finally{d(!1)}};return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Astra Fabricator Engine"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Bridge the gap between digital design and physical reality. Select a single object (like a wall, custom furniture, or a complex facade piece) and the AI will generate machine-readable files for digital fabrication."}),o.jsxs("div",{className:"p-4 bg-slate-700/50 rounded-lg text-center",children:[o.jsx("p",{className:"text-sm text-slate-400",children:"Selected Object:"}),i?o.jsxs("p",{className:"font-semibold text-amber-300 capitalize",children:[i.type," - ID: ",i.id]}):o.jsx("p",{className:"text-slate-500 italic",children:"None selected. Click an object in the 2D or 3D view."})]}),o.jsxs("button",{onClick:g,disabled:u||!i,className:"w-full mt-4 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700",children:[u?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"⚙️"}),o.jsx("span",{className:"flex-grow",children:u?"Generating Files...":"Generate Fabrication Files"}),o.jsx("span",{className:"text-xs bg-black/30 px-2 py-0.5 rounded-full",children:"50 credits"})]})]})},dd=({title:r,children:e})=>o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"font-bold text-lg text-sky-300 mb-2",children:r}),o.jsx("div",{className:"space-y-3 pl-2 border-l-2 border-slate-700",children:e})]}),d5=r=>{const{currentUser:e,setBuyCreditsModalOpen:t,refreshCurrentUser:n,levels:i,planNorthDirection:s,propertyLines:l,terrainMesh:u,currentProject:d}=r,[m,g]=V.useState(null),[v,y]=V.useState(!1),[p,N]=V.useState(null),{addNotification:b}=pr(),w=$e().createProjectData({name:(d==null?void 0:d.name)||"Untitled Project",projectType:(d==null?void 0:d.projectType)||"building",levels:i,planNorthDirection:s,propertyLines:l,terrainMesh:u,zones:[],infrastructure:[]}),S=async()=>{if(!e){b("Please log in.","error");return}if(e.role!=="owner"&&e.credits<60){b("You need 60 credits for this feature.","info"),t(!0);return}y(!0),g(null);try{const W=await fp((d==null?void 0:d.id)||"",w);g(W),b("Indra-Net has generated your media kit!","success"),await n()}catch(W){b(`Generation failed: ${W.message}`,"error")}finally{y(!1)}},T=async(W,G)=>{if(!e){b("Please log in.","error");return}if(e.role!=="owner"&&e.credits<5){b("You need 5 credits per image.","info"),t(!0);return}N(G);try{const{imageUrl:te}=await pp((d==null?void 0:d.id)||"",W.prompt,{aspectRatio:"16:9"});g(H=>{if(!H)return null;const M=[...H.visuals];return M[G]={...M[G],generatedImageUrl:te},{...H,visuals:M}}),await n()}catch(te){b(`Image generation failed: ${te.message}`,"error")}finally{N(null)}};return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Indra-Net Media Kit Engine"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Generate a complete marketing and media kit for your project, including brand identity, visuals, and copy."}),o.jsxs("button",{onClick:S,disabled:v,className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-sky-500 to-cyan-600 hover:from-sky-600 hover:to-cyan-700",children:[v?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"⚡"}),o.jsx("span",{className:"flex-grow",children:v?"Generating Kit...":"Generate Media Kit"}),o.jsx("span",{className:"text-xs bg-black/30 px-2 py-0.5 rounded-full",children:"60 credits"})]}),m&&o.jsxs("div",{className:"mt-4 bg-slate-700/50 rounded-lg p-3",children:[o.jsxs(dd,{title:"Brand Identity",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Logo Concept:"})," ",m.brandIdentity.logoConcept]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Tagline:"}),' "',m.brandIdentity.tagline,'"']})]}),o.jsx(dd,{title:"Visuals",children:m.visuals.map((W,G)=>o.jsxs("div",{className:"p-2 bg-slate-900/50 rounded-md",children:[o.jsxs("p",{className:"text-xs text-slate-400",children:['"',W.prompt,'"']}),W.generatedImageUrl?o.jsx("img",{src:W.generatedImageUrl,alt:W.title,className:"w-full h-auto rounded-md mt-2"}):o.jsx("button",{onClick:()=>T(W,G),disabled:p===G,className:"w-full text-xs p-2 mt-2 bg-sky-600 hover:bg-sky-500 rounded-md",children:p===G?o.jsx(dt,{size:"h-4 w-4"}):"Generate Visual (5 Cr)"})]},G))})]})]})},da=({title:r,children:e})=>o.jsxs("div",{className:"bg-slate-900/50 p-3 rounded-md border border-slate-700",children:[o.jsx("h5",{className:"font-semibold text-sky-300 mb-1",children:r}),o.jsx("div",{className:"text-sm text-slate-200 space-y-1",children:e})]}),h5=r=>{const{currentUser:e,setBuyCreditsModalOpen:t,refreshCurrentUser:n,currentProject:i,lokaSimulatorReport:s,setLokaSimulatorReport:l}=r,[u,d]=V.useState(!1),[m,g]=V.useState(null),{addNotification:v}=pr(),y=async()=>{const p=i==null?void 0:i.location;if(!p){v("Please set a project location first in the Project Hub.","error");return}if(!e){v("Please log in.","error");return}if(e.role!=="owner"&&e.credits<10){v("You need 10 credits for the Loka Simulator.","info"),t(!0);return}d(!0),g(null);try{if(!(i!=null&&i.id))throw new Error("No active project to associate the cost with.");const N=await mp(i.id,p);l(N),v("World simulation complete!","success"),await n()}catch(N){g(N.message),v(`Simulation failed: ${N.message}`,"error")}finally{d(!1)}};return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Vayu-Astra (Climate Simulator)"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Simulate real-world environmental data for your project's location. This helps in making informed decisions for sustainable design, like optimizing for wind patterns (Vayu)."}),o.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg mb-4",children:[o.jsx("p",{className:"text-xs text-slate-400",children:"Project Location"}),o.jsx("p",{className:"font-semibold text-amber-300",children:(i==null?void 0:i.location)||"Not Set"})]}),o.jsxs("button",{onClick:y,disabled:u||!(i!=null&&i.location),className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700",children:[u?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"🌍"}),o.jsx("span",{className:"flex-grow",children:u?"Simulating World...":"Run World Simulation"}),o.jsx("span",{className:"text-xs bg-black/30 px-2 py-0.5 rounded-full",children:"10 credits"})]}),m&&o.jsx("p",{className:"text-red-400 text-xs mt-2",children:m}),s&&o.jsxs("div",{className:"mt-4 space-y-3",children:[o.jsx(da,{title:"Climate Summary",children:o.jsx("p",{className:"italic",children:s.summary})}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs(da,{title:"Solar Irradiance",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Annual Avg:"})," ",s.solarIrradiance.annual," ",s.solarIrradiance.units]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Peak:"})," ",s.solarIrradiance.peakMonths.join(", ")]})]}),o.jsxs(da,{title:"Wind Patterns",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Dominant:"})," ",s.windPatterns.dominantDirection]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Avg Speed:"})," ",s.windPatterns.averageSpeed," ",s.windPatterns.units]})]}),o.jsx(da,{title:"Temperature",children:o.jsxs("p",{children:[o.jsx("strong",{children:"Min/Max:"})," ",s.temperatureRange.annualMin,"° - ",s.temperatureRange.annualMax,"° C"]})}),o.jsxs(da,{title:"Precipitation",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Annual Avg:"})," ",s.precipitation.annualAverage," ",s.precipitation.units]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Wettest:"})," ",s.precipitation.wettestMonths.join(", ")]})]})]})]})]})},bo=({title:r,children:e})=>o.jsxs("div",{className:"mt-3",children:[o.jsx("h4",{className:"font-bold text-sky-300 mb-1",children:r}),o.jsx("div",{className:"space-y-2 text-xs text-slate-300 pl-2 border-l-2 border-slate-700",children:e})]}),f5=({report:r})=>o.jsx("div",{className:"w-full aspect-square bg-slate-800 rounded-md mt-2 p-2",children:o.jsxs("svg",{viewBox:"0 0 2000 2000",children:[o.jsx("rect",{width:"100%",height:"100%",fill:"#1e293b"}),r.canals.map((t,n)=>o.jsx("polyline",{points:t.path.map(i=>`${i.x},${i.y}`).join(" "),fill:"none",stroke:t.type==="Main Canal"?"#38bdf8":"#67e8f9",strokeWidth:t.type==="Main Canal"?"15":"8",strokeLinecap:"round"},`canal-${n}`)),r.reservoirs.map((t,n)=>o.jsx("circle",{cx:t.location.x,cy:t.location.y,r:"30",fill:"#3b82f6",opacity:"0.7"},`res-${n}`)),r.dams.map((t,n)=>o.jsx("rect",{x:t.location.x-20,y:t.location.y-5,width:"40",height:"10",fill:"#94a3b8"},`dam-${n}`))]})}),p5=r=>{const{currentUser:e,setBuyCreditsModalOpen:t,refreshCurrentUser:n,currentProject:i}=r,[s,l]=V.useState("Design a canal network to connect the Godavari and Krishna rivers to irrigate the drought-prone regions of Rayalaseema in Andhra Pradesh. Include conceptual placements for reservoirs."),[u,d]=V.useState(!1),[m,g]=V.useState(null),[v,y]=V.useState(null),{addNotification:p}=pr(),N=async()=>{if(!(!s.trim()||!e)){if(e.role!=="owner"&&e.credits<300){p("The Varuna Engine requires 300 credits.","info"),t(!0);return}d(!0),g(null),y(null);try{const b=await gp((i==null?void 0:i.id)||"",s);y(b),p("The Varuna Engine has generated a hydro-engineering proposal!","success"),await n()}catch(b){g(b.message||"An unexpected error occurred."),p(b.message,"error")}finally{d(!1)}}};return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Varuna Hydro-Engineering Engine"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Operate at a national scale. Describe a large-scale water resource management mission, and the Varuna Engine will generate a conceptual plan for canal networks, dams, and reservoirs."}),o.jsx("textarea",{value:s,onChange:b=>l(b.target.value),rows:4,className:"w-full p-2 border border-slate-600 rounded-md bg-slate-700 text-slate-100 focus:ring-2 focus:ring-sky-500",placeholder:"e.g., Plan an inter-state river linking project...",disabled:u}),o.jsxs("button",{onClick:N,disabled:u||!s.trim(),className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-blue-600 to-teal-700 hover:from-blue-700 hover:to-teal-800",children:[u?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"🌊"}),o.jsx("span",{className:"flex-grow",children:u?"Generating Plan...":"Generate Hydro Plan"}),o.jsx("span",{className:"text-xs bg-black/30 px-2 py-0.5 rounded-full",children:"300 credits"})]}),m&&o.jsx("p",{className:"text-red-400 text-xs mt-2",children:m}),v&&o.jsxs("div",{className:"mt-4 bg-slate-700/50 rounded-lg p-3",children:[o.jsx("h3",{className:"font-bold text-lg text-amber-300",children:"Varuna Engine Report"}),o.jsx(bo,{title:"Narrative",children:o.jsx("p",{children:v.narrative})}),o.jsx(bo,{title:"Inferred Topography",children:o.jsx("p",{children:v.topographySummary})}),o.jsx(bo,{title:"Plan Visualizer",children:o.jsx(f5,{report:v})}),o.jsx(bo,{title:"Environmental Impact Assessment",children:o.jsx("p",{children:v.environmentalImpact})})]})]})},m5=({spotlightId:r,title:e,content:t,children:n})=>{const{seenSpotlights:i,markSpotlightSeen:s,completeOnboardingChecklistItem:l}=$e(N=>({seenSpotlights:N.seenSpotlights,markSpotlightSeen:N.markSpotlightSeen,completeOnboardingChecklistItem:N.completeOnboardingChecklistItem})),[u,d]=V.useState(!i.includes(r)),[m,g]=V.useState({top:0,left:0}),v=V.useRef(null),y=V.useRef(null);V.useLayoutEffect(()=>{if(u&&v.current&&y.current){const N=v.current.getBoundingClientRect(),b=y.current.getBoundingClientRect();g({top:N.top-b.height-10,left:N.left+N.width/2-b.width/2})}},[u]);const p=()=>{d(!1),s(r),l("featureSpotlightViewed")};return o.jsxs("div",{ref:v,className:"relative",children:[n,u&&o.jsxs("div",{ref:y,className:"guided-tour-popover z-[1002]",style:{position:"fixed",top:m.top,left:m.left,opacity:m.top===0?0:1},children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("h4",{className:"font-bold text-amber-300",children:e}),o.jsx("button",{onClick:p,className:"text-slate-500 hover:text-white",children:"×"})]}),o.jsx("p",{className:"text-sm text-slate-300 mb-3",children:t}),o.jsx(wn,{size:"sm",onClick:p,className:"w-full",children:"Got it"})]})]})},g5=r=>{const e=$e();return o.jsx(m5,{spotlightId:"vastu-tool",title:"Vastu Grid Analysis",content:"This powerful tool analyzes your floor plan against ancient Vastu principles, providing a color-coded grid and detailed feedback for creating a harmonious space.",children:o.jsx(Pt,{...r,toolName:"Vastu Grid Analysis",description:"Analyze your floor plan against the principles of Vastu Shastra. The AI will generate a 9x9 Vastu Purusha Mandala and identify the energetic compliance of each zone.",creditCost:10,icon:"🕉️",apiFn:vp,buildPayload:t=>{var i;return[e.createProjectData({projectType:((i=t.currentProject)==null?void 0:i.projectType)||"building",levels:t.levels,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(t,n)=>{n.setVastuGridAnalysis(t),n.setShowVastuGrid(!0)},buttonText:"Analyze Vastu Grid"})})},ha=Ei.div,v5=Ei.p,fa={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5}}},x5=({action:r,onAction:e})=>o.jsx(wn,{onClick:()=>e(r.cta),size:"sm",variant:"outline",className:"text-xs flex-shrink-0 ml-2",children:r.cta}),y5=({report:r})=>{const{setView:e,setActiveTool:t}=$e(i=>({setView:i.setView,setActiveTool:i.setActiveTool})),n=i=>{const s=i.toLowerCase();s.includes("marketplace")?e("marketplace"):s.includes("brahma")?e("brahmaAstra"):t("nexus")};return o.jsxs(ha,{variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.15}}},initial:"hidden",animate:"visible",className:"space-y-4 mt-4",children:[o.jsxs(v5,{variants:fa,className:"text-sm text-slate-300 italic",children:['"',r.strategicOverview,'"']}),r.svaDharmaAnalysis&&o.jsxs(ha,{variants:fa,className:"p-4 bg-slate-900/30 rounded-lg border border-purple-600/50",children:[o.jsxs("h4",{className:"font-semibold text-purple-300 mb-2 flex items-center gap-2",children:[o.jsx("span",{className:"text-lg",children:"🧬"})," Your Architectural DNA (Atman Signature)"]}),o.jsxs("p",{className:"font-bold text-lg text-white mb-2",children:['"',r.svaDharmaAnalysis.signature,'"']}),o.jsx("p",{className:"text-xs text-purple-200",children:r.svaDharmaAnalysis.analysis})]}),r.akashicInsights&&r.akashicInsights.length>0&&o.jsxs(ha,{variants:fa,className:"p-4 bg-purple-900/30 rounded-lg border border-purple-600/50",children:[o.jsxs("h4",{className:"font-semibold text-purple-300 mb-2 flex items-center gap-2",children:[o.jsx("span",{className:"text-lg",children:"📚"})," Akasha Engine Insight"]}),o.jsx("ul",{className:"space-y-2 text-xs text-purple-200 list-disc list-inside",children:r.akashicInsights.map((i,s)=>o.jsx("li",{children:i},s))})]}),o.jsxs(ha,{variants:fa,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-green-400 mb-2",children:"Growth Opportunities"}),o.jsx("ul",{className:"space-y-3",children:r.growthOpportunities.map((i,s)=>o.jsxs("li",{className:"text-xs",children:[o.jsx("strong",{className:"text-slate-200 block",children:i.title}),o.jsx("p",{className:"text-slate-400",children:i.description})]},s))})]}),o.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-orange-400 mb-2",children:"Potential Risks"}),o.jsx("ul",{className:"space-y-3",children:r.potentialRisks.map((i,s)=>o.jsxs("li",{className:"text-xs",children:[o.jsx("strong",{className:"text-slate-200 block",children:i.title}),o.jsx("p",{className:"text-slate-400",children:i.description})]},s))})]})]}),o.jsxs(ha,{variants:fa,children:[o.jsx("h4",{className:"font-semibold text-sky-300 mb-2",children:"Suggested Actions"}),o.jsx("div",{className:"space-y-2",children:r.suggestedActions.map((i,s)=>o.jsxs("div",{className:"bg-slate-900/50 p-3 rounded-lg flex justify-between items-center",children:[o.jsxs("div",{className:"text-sm",children:[o.jsx("strong",{className:"text-slate-200 block",children:i.title}),o.jsx("p",{className:"text-slate-400 text-xs",children:i.description})]}),o.jsx(x5,{action:i,onAction:n})]},s))})]})]})},b5=r=>{const{projects:e,nexusReport:t,setNexusReport:n,currentUser:i,setBuyCreditsModalOpen:s,refreshCurrentUser:l,addNotification:u}=$e(p=>({projects:p.projects,nexusReport:p.nexusReport,setNexusReport:p.setNexusReport,currentUser:p.currentUser,setBuyCreditsModalOpen:p.setBuyCreditsModalOpen,refreshCurrentUser:p.refreshCurrentUser,addNotification:p.addNotification})),[d,m]=V.useState(!1),[g,v]=V.useState(null),y=V.useCallback(async()=>{var N;if(!e||e.length===0){u("Create at least one project to get advice.","error");return}const p=10;if(i&&i.role!=="owner"&&i.credits<p){u(`You need ${p} credits for the Nexus Advisor. You have ${i.credits}.`,"info"),s(!0);return}m(!0),v(null);try{const b=await xp(((N=e[0])==null?void 0:N.id)||"no-project",e);n(b),u("Nexus Advisor report generated!","success"),i&&i.role!=="owner"&&await l()}catch(b){const I=b.message||"Failed to fetch strategic advice.";v(I),u(I,"error")}finally{m(!1)}},[e,i,s,l,n,u]);return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Nexus Strategic Advisor"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Receive hyper-personalized strategic advice based on your entire project portfolio. The Nexus Advisor will identify opportunities, risks, and actionable next steps to help you grow."}),o.jsxs(wn,{onClick:y,className:"w-full flex items-center justify-center",disabled:d,children:[d?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"💎"}),o.jsx("span",{className:"flex-grow",children:t?"Refresh Advice":"Generate Advice"}),o.jsx("span",{className:"text-xs bg-black/30 px-2 py-0.5 rounded-full",children:"10 credits"})]}),o.jsxs("div",{className:"mt-4",children:[d&&o.jsxs("div",{className:"flex items-center justify-center p-4",children:[o.jsx(dt,{}),o.jsx("p",{className:"ml-2 text-sm",children:"Analyzing portfolio..."})]}),g&&o.jsx("p",{className:"text-red-400 text-sm p-4",children:g}),!d&&!g&&t&&o.jsx(y5,{report:t}),!d&&!g&&!t&&o.jsx("div",{className:"text-center text-slate-400 text-sm p-4 mt-4 bg-slate-900/50 rounded-lg",children:o.jsx("p",{children:"Your personalized AI strategic report will appear here once generated."})})]})]})},w5=()=>o.jsxs("div",{className:"text-center p-4 flex flex-col items-center justify-center h-full",children:[o.jsxs("div",{className:"text-6xl mb-4",children:[o.jsx("span",{className:"text-slate-400",children:"2D"}),o.jsx("span",{className:"mx-2 text-sky-400",children:"→"}),o.jsx("span",{className:"text-white font-bold",children:"3D"})]}),o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Live 3D Synthesis"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Your 3D model is generated instantly and is always synchronized with your 2D plan. Any changes you make on the canvas are immediately reflected in the 3D Visualization panel."}),o.jsx("p",{className:"text-xs text-slate-400 italic",children:"There's no 'convert' button because it's always live. This is the power of AuraOS."}),o.jsx("button",{className:"mt-6 w-full px-4 py-3 text-white font-semibold rounded-md flex items-center justify-center transition-all bg-sky-600 hover:bg-sky-500",children:"View 3D Model"})]}),N5=Ei.div,j5=({solution:r,onApply:e,isLoading:t})=>o.jsxs(N5,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[o.jsx("p",{className:"font-semibold text-sky-300 mb-3",children:r.description}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-4",children:[o.jsxs("div",{title:r.impactAnalysis.cost,children:[o.jsx("strong",{children:"Cost:"})," ",o.jsx("span",{className:"text-slate-300 truncate",children:r.impactAnalysis.cost})]}),o.jsxs("div",{title:r.impactAnalysis.structural,children:[o.jsx("strong",{children:"Structure:"})," ",o.jsx("span",{className:"text-slate-300 truncate",children:r.impactAnalysis.structural})]}),o.jsxs("div",{title:r.impactAnalysis.vastu,children:[o.jsx("strong",{children:"Vastu:"})," ",o.jsx("span",{className:"text-slate-300 truncate",children:r.impactAnalysis.vastu})]}),o.jsxs("div",{title:r.impactAnalysis.sustainability,children:[o.jsx("strong",{children:"Sustainability:"})," ",o.jsx("span",{className:"text-slate-300 truncate",children:r.impactAnalysis.sustainability})]})]}),o.jsx("button",{onClick:e,disabled:t,className:"w-full py-1 text-sm bg-emerald-600 hover:bg-emerald-500 rounded-md font-semibold disabled:opacity-50",children:"Apply this Solution"})]}),A5=r=>{const{proposeSamaranganFixes:e,applySamaranganFix:t,samaranganSolutions:n,setSamaranganSolutions:i,globalLoadingMessage:s}=$e(),[l,u]=V.useState(""),[d,m]=V.useState(null),g=!!(s!=null&&s.includes("Adjudicating")),v=async()=>{if(l.trim()){m(null),$e.setState({globalLoadingMessage:"Adjudicating design options..."});try{await e(l)}catch(N){m(N.message)}finally{$e.setState({globalLoadingMessage:null})}}},y=N=>{t(N.fix),u("")},p=()=>{i(null),u(""),m(null)};return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Samarangan: AI Design Adjudicator"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Issue high-level commands to iterate on your design. The AI will analyze the context and propose multiple intelligent solutions with impact analyses for your review."}),n?o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h4",{className:"font-semibold text-lg text-slate-100",children:"AI-Proposed Solutions"}),o.jsx("button",{onClick:p,className:"text-xs text-sky-400 hover:underline",children:"Start Over"})]}),o.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-2",children:o.jsx(ga,{children:n.map((N,b)=>o.jsx(j5,{solution:N,onApply:()=>y(N),isLoading:g},b))})})]}):o.jsxs(o.Fragment,{children:[o.jsx("textarea",{value:l,onChange:N=>u(N.target.value),rows:3,className:"w-full p-2 border border-slate-600 rounded-md bg-slate-700 text-slate-100 focus:ring-2 focus:ring-purple-500",placeholder:"e.g., 'Make the master bedroom 20% larger' or 'Add a powder room near the entrance'",disabled:g}),o.jsxs("button",{onClick:v,disabled:g||!l.trim(),className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700",children:[g?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"⚖️"}),o.jsx("span",{className:"flex-grow",children:g?"Adjudicating...":"Propose Solutions"}),o.jsx(bn,{cost:15})]}),d&&o.jsx("p",{className:"text-red-400 text-xs mt-2",children:d})]})]})},S5=({isEnabled:r,onToggle:e,disabled:t})=>o.jsx("button",{onClick:e,disabled:t,className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors disabled:opacity-50 ${r?"bg-primary":"bg-slate-600"}`,children:o.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${r?"translate-x-6":"translate-x-1"}`})}),L5=r=>{var v,y;const{currentProject:e,toggleHolocronEnabled:t,updateHolocronHotspots:n,setHotspotEditorOpen:i,globalLoadingMessage:s}=$e(),l=e==null?void 0:e.holocron,u=!!(s!=null&&s.includes("Holocron")),d=p=>{i(!0,{position:p.position,existingHotspotId:p.id})},m=p=>{if(l&&window.confirm("Are you sure you want to delete this hotspot?")){const N=l.hotspots.filter(b=>b.id!==p);n(N)}},g=l!=null&&l.isEnabled&&l.shareableLink?`${window.location.origin}/#/holocron/${l.shareableLink}`:"";return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Holocron Authoring"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Create an interactive, shareable 3D presentation of your project. Add narrative points, renders, and documents directly onto your model."}),o.jsxs("div",{className:"p-4 bg-slate-700/50 rounded-lg space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("label",{className:"font-semibold text-slate-200",children:"Enable Holocron Presentation"}),o.jsx(S5,{isEnabled:(l==null?void 0:l.isEnabled)||!1,onToggle:t,disabled:u})]}),u&&o.jsx("div",{className:"flex justify-center",children:o.jsx(dt,{})}),(l==null?void 0:l.isEnabled)&&g&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-slate-400",children:"Shareable Link"}),o.jsxs("div",{className:"flex gap-2 mt-1",children:[o.jsx("input",{type:"text",readOnly:!0,value:g,className:"w-full p-2 bg-slate-800 border border-slate-600 rounded-md text-slate-300 text-xs"}),o.jsx(wn,{size:"sm",onClick:()=>navigator.clipboard.writeText(g),children:"Copy"})]})]}),o.jsxs("div",{className:"p-3 bg-slate-900/50 rounded-lg border border-dashed border-slate-600 text-center",children:[o.jsx("h4",{className:"font-semibold text-amber-300",children:"Add Hotspots"}),o.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Double-click anywhere on the 3D model to add a new interactive hotspot."})]}),o.jsxs("div",{children:[o.jsxs("h4",{className:"font-semibold text-slate-200 mb-2",children:["Manage Hotspots (",((v=l.hotspots)==null?void 0:v.length)||0,")"]}),o.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:((y=l.hotspots)==null?void 0:y.length)>0?l.hotspots.map(p=>o.jsxs("div",{className:"p-2 bg-slate-800/70 rounded-md flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-slate-100",children:p.title}),o.jsx("p",{className:"text-xs text-slate-500 capitalize",children:p.type})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(wn,{variant:"ghost",size:"sm",onClick:()=>d(p),children:"Edit"}),o.jsx(wn,{variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300",onClick:()=>m(p.id),children:"Delete"})]})]},p.id)):o.jsx("p",{className:"text-center text-sm text-slate-500 py-4",children:"No hotspots created yet."})})]})]})]})]})},P5=({active:r,payload:e})=>{if(r&&e&&e.length){const t=e[0].payload;return o.jsxs("div",{className:"p-3 bg-slate-800/90 border border-slate-600 rounded-lg shadow-xl text-sm",children:[o.jsxs("p",{className:"font-bold text-slate-100 mb-2",children:["Solution ID: ",t.id]}),o.jsx("div",{className:"space-y-1",children:Object.entries(t.scores).map(([n,i])=>o.jsxs("p",{className:"text-slate-300",children:[o.jsxs("span",{className:"capitalize",children:[n.replace(/_/g," "),":"]}),o.jsxs("span",{className:"font-semibold text-amber-300 ml-2",children:[i,"/100"]})]},n))}),o.jsx("img",{src:t.thumbnailUrl,alt:`Thumbnail for ${t.id}`,className:"mt-2 rounded-md border-2 border-slate-700"})]})}return null},k5=({report:r})=>{if(!r||!r.solutions||r.solutions.length===0)return o.jsx("p",{className:"text-slate-400",children:"No optimal solutions were found."});const e=Object.keys(r.solutions[0].scores),t=e[0]||"score1",n=e[1]||"score2",i=r.solutions.map(s=>({id:s.id,[t]:s.scores[t],[n]:s.scores[n],...s.scores,thumbnailUrl:s.thumbnailUrl}));return o.jsxs("div",{className:"mt-4 p-2 bg-slate-900/50 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-amber-300 text-center mb-2",children:"Mandala of Optimization"}),o.jsx("p",{className:"text-xs text-slate-400 text-center mb-4",children:"Each point represents an optimal design. Hover to view details."}),o.jsx("div",{style:{width:"100%",height:300},children:o.jsx(ac,{children:o.jsxs(A1,{margin:{top:20,right:20,bottom:20,left:20},children:[o.jsx(Rd,{strokeDasharray:"3 3",stroke:"#475569"}),o.jsx(Fd,{type:"number",dataKey:t,name:t.replace(/_/g," "),unit:"",tick:{fill:"#94a3b8",fontSize:10},label:{value:t.replace(/_/g," "),position:"insideBottom",offset:-10,fill:"#cbd5e1"}}),o.jsx(Md,{type:"number",dataKey:n,name:n.replace(/_/g," "),unit:"",tick:{fill:"#94a3b8",fontSize:10},label:{value:n.replace(/_/g," "),angle:-90,position:"insideLeft",fill:"#cbd5e1"}}),o.jsx(oc,{cursor:{strokeDasharray:"3 3",stroke:"#a78bfa"},content:o.jsx(P5,{})}),o.jsx(eh,{name:"Solutions",data:i,fill:"#f59e0b",shape:"star"})]})})})]})},_5=({report:r})=>{const{setParamAstraReport:e,setActiveTool:t}=$e(i=>({setParamAstraReport:i.setParamAstraReport,setActiveTool:i.setActiveTool})),n=i=>{try{const s=JSON.parse(i);console.log("Invoking Param-Astra with objectives:",s),e({solutions:[{id:"sol_A1",scores:{cost:90,vastu:65},thumbnailUrl:"/images/param-astra/thumb_simple_rect.png"},{id:"sol_B2",scores:{cost:75,vastu:85},thumbnailUrl:"/images/param-astra/thumb_complex_asym.png"},{id:"sol_C3",scores:{cost:82,vastu:80},thumbnailUrl:"/images/param-astra/thumb_l-shape.png"}]}),t("optimizer")}catch(s){console.error("Failed to parse solution prompt for Param-Astra:",s),alert("Could not start optimizer due to an invalid solution prompt.")}};return o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-slate-200",children:"Executive Summary"}),o.jsx("p",{className:"text-sm text-slate-300 italic",children:r.summary})]}),r.conflicts&&r.conflicts.length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-red-400 mb-2",children:"Identified Conflicts"}),o.jsx("div",{className:"space-y-3",children:r.conflicts.map((i,s)=>o.jsxs("div",{className:"p-3 bg-slate-900/50 rounded-md border-l-4 border-red-500",children:[o.jsx("p",{className:"text-sm text-slate-200",children:i.description}),i.solutionPrompt&&o.jsx("button",{onClick:()=>n(i.solutionPrompt),className:"mt-2 px-3 py-1 text-xs font-semibold text-white rounded-md bg-gradient-to-r from-purple-600 to-indigo-700 hover:from-purple-500 hover:to-indigo-600",children:"✨ Invoke Param-Astra to Solve"})]},s))})]}),r.synergies&&r.synergies.length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-green-400 mb-2",children:"Potential Synergies"}),o.jsx("div",{className:"space-y-3",children:r.synergies.map((i,s)=>o.jsx("div",{className:"p-3 bg-slate-900/50 rounded-md border-l-4 border-green-500",children:o.jsx("p",{className:"text-sm text-slate-200",children:i.description})},s))})]})]})},C5=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-3",children:[o.jsx("h4",{className:"font-semibold text-slate-200",children:"Cosmic Analysis"}),o.jsx("p",{className:"text-sm text-slate-300 italic",children:r.analysis}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-1",children:"Auspicious Timings:"}),o.jsx("ul",{className:"space-y-2 text-sm",children:r.auspiciousTimings.map((e,t)=>o.jsxs("li",{className:"p-2 bg-slate-900/50 rounded-md",children:[o.jsxs("strong",{children:[e.event,":"]})," ",o.jsx("span",{className:"text-amber-300",children:e.date}),o.jsx("p",{className:"text-xs text-slate-400",children:e.notes})]},t))})]})]}),I5=r=>{const e=$e();return o.jsx(Pt,{...r,toolName:"Navagraha Engine",description:"The celestial architect. Analyze your project's location and desired timeframe to find auspicious timings for key construction milestones, aligned with Vedic cosmic principles.",creditCost:100,icon:"🪐",apiFn:yp,buildPayload:t=>{var i,s,l;return[e.createProjectData({name:((i=t.currentProject)==null?void 0:i.name)||"Untitled Project",projectType:((s=t.currentProject)==null?void 0:s.projectType)||"building",levels:t.levels,location:(l=t.currentProject)==null?void 0:l.location,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh,zones:t.zones,infrastructure:t.infrastructure})]},onSuccess:(t,n)=>n.setNavagrahaReport(t),buttonText:"Analyze Cosmic Timings",renderResult:t=>C5(t)})},E5=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-3",children:[o.jsx("h4",{className:"font-semibold text-slate-200",children:"Response from the Akashic Records"}),o.jsx("p",{className:"text-sm text-slate-300 whitespace-pre-wrap",children:r.response}),r.citations.length>0&&o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-1",children:"Cited Projects from the Records:"}),o.jsx("ul",{className:"space-y-1 text-xs text-slate-400 list-disc list-inside",children:r.citations.map((e,t)=>o.jsx("li",{children:e.summary},t))})]})]}),O5=r=>{const[e,t]=V.useState("");return o.jsxs("div",{children:[o.jsx("textarea",{value:e,onChange:n=>t(n.target.value),rows:3,className:"w-full p-2 border border-slate-600 rounded-md bg-slate-700 text-slate-100 focus:ring-2 focus:ring-purple-500 mb-2",placeholder:"Ask a profound design question... e.g., 'What are the most common structural solutions for large cantilevered balconies in residential projects?'"}),o.jsx(Pt,{...r,toolName:"Akasha Engine",description:"Query the Akashic Records, the collective memory of all designs on the platform. Gain insights from a universe of architectural data.",creditCost:50,icon:"📚",apiFn:bp,buildPayload:n=>e.trim()?[e]:(n.addNotification("Please enter a query for the Akasha Engine.","error"),null),onSuccess:(n,i)=>i.setAkashaReport(n),buttonText:"Query the Records",renderResult:n=>E5(n)})]})},T5=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-3",children:[o.jsx("h4",{className:"font-semibold text-slate-200",children:"Lifecycle Analysis"}),o.jsx("p",{className:"text-sm text-slate-300 italic",children:r.summary}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-1",children:"Maintenance Schedule:"}),o.jsx("ul",{className:"space-y-1 text-xs text-slate-300 list-disc list-inside",children:r.maintenanceSchedule.map((e,t)=>o.jsxs("li",{children:[e.item," (",e.frequency,")"]},t))})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-1",children:"Material Reincarnation Plan:"}),o.jsx("ul",{className:"space-y-1 text-xs text-slate-300 list-disc list-inside",children:r.materialReincarnationPlan.map((e,t)=>o.jsxs("li",{children:[e.material," ➔ ",e.potentialNewUse]},t))})]})]})]}),D5=r=>{const e=$e();return o.jsx(Pt,{...r,toolName:"Samsara Engine",description:"The master of cycles. Analyze your project's entire lifecycle, from maintenance costs to demolition and material recycling potential.",creditCost:75,icon:"♻️",apiFn:wp,buildPayload:t=>{var i;return[e.createProjectData({projectType:((i=t.currentProject)==null?void 0:i.projectType)||"building",levels:t.levels,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(t,n)=>n.setSamsaraReport(t),buttonText:"Analyze Lifecycle",renderResult:t=>T5(t)})},R5=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-900/30 rounded-lg space-y-6",children:[o.jsxs("div",{className:"border-l-4 border-amber-400 pl-4 py-2 bg-slate-800/40 rounded-r-lg",children:[o.jsx("h4",{className:"font-bold text-lg text-amber-300 font-serif",children:"A Sthapati's Proclamation"}),o.jsxs("blockquote",{className:"mt-2 text-slate-200 italic",children:['"',r.narrative,'"']})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold text-lg text-sky-300 mb-3",children:"Potential Embellishments"}),o.jsx("div",{className:"space-y-3",children:r.potentialEmbellishments.map((e,t)=>o.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg border border-slate-700 hover:border-sky-500",children:[o.jsx("p",{className:"font-semibold text-sky-200",children:e.location}),o.jsx("p",{className:"text-sm text-slate-300",children:e.suggestion})]},t))})]})]}),F5=r=>{const e=$e();return o.jsx(Pt,{...r,toolName:"Shilpa Sutra Analysis",description:"A Sthapati's critique. Receive an aesthetic and spiritual analysis of your design, with suggestions for artistic embellishments based on traditional principles.",creditCost:25,icon:"🎨",apiFn:Np,buildPayload:t=>{var i;return[e.createProjectData({projectType:((i=t.currentProject)==null?void 0:i.projectType)||"building",levels:t.levels,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(t,n)=>n.setShilpaSutraReport(t),buttonText:"Analyze Aesthetics",renderResult:t=>R5(t)})},M5=r=>{const{atmanSignature:e,svaDharmaReport:t,runSvaDharmaAnalyzer:n,globalLoadingMessage:i}=$e(d=>({atmanSignature:d.atmanSignature,svaDharmaReport:d.svaDharmaReport,runSvaDharmaAnalyzer:d.runSvaDharmaAnalyzer,globalLoadingMessage:d.globalLoadingMessage})),[s,l]=V.useState(""),u=i==null?void 0:i.includes("DNA");return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Atman Signature"}),o.jsxs("div",{className:"p-3 my-3 bg-slate-900/50 rounded-lg border border-purple-600/50",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsx("h4",{className:"font-semibold text-purple-300",children:"Your Architectural DNA"})}),t?o.jsxs("div",{className:"mt-2",children:[o.jsxs("p",{className:"font-bold text-lg text-white",children:['"',t.signature,'"']}),o.jsx("p",{className:"text-xs text-purple-200 mt-1",children:t.analysis})]}):o.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Discover your unique design signature by analyzing your portfolio."}),o.jsx(wn,{variant:"outline",size:"sm",onClick:n,className:"w-full mt-3",disabled:u,children:u?o.jsxs(o.Fragment,{children:[o.jsx(dt,{size:"h-4 w-4 mr-2"}),"Analyzing..."]}):t?"Re-Analyze Signature":"Analyze My Signature (25 Cr)"})]}),o.jsx("h4",{className:"font-bold text-lg text-sky-300 mt-6",children:"Signature Synthesis"}),o.jsx("p",{className:"text-sm text-slate-400 my-2",children:"Synthesize your unique design DNA with a new prompt to generate a project that is intrinsically yours."}),o.jsx("textarea",{value:s,onChange:d=>l(d.target.value),rows:2,className:"w-full p-2 border border-slate-600 rounded-md bg-slate-700 text-slate-100",placeholder:"New prompt, e.g., 'A small library'",disabled:!e}),o.jsx(Pt,{...r,toolName:"",description:"",creditCost:50,icon:"🧬",apiFn:jp,buildPayload:d=>e?s.trim()?[e||"",s]:(d.addNotification("Please enter a prompt for synthesis.","error"),null):(d.addNotification("Please analyze your signature first.","error"),null),onSuccess:(d,m)=>m.setAtmanSignatureReport(d),buttonText:"Synthesize Signature"})]})},B5=r=>{const{paramAstraReport:e}=r;return o.jsxs("div",{children:[o.jsx(Pt,{...r,toolName:"Param-Astra Engine",description:"The evolutionary design engine. Define your objectives (e.g., minimize cost, maximize views) and let the AI explore thousands of design variations to find the optimal solutions.",creditCost:75,icon:"📈",apiFn:Ap,buildPayload:t=>[{cost:"minimize",views:"maximize",vastu:"maximize"}],onSuccess:(t,n)=>n.setParamAstraReport(t),buttonText:"Find Optimal Solutions"}),e&&o.jsx(k5,{report:e})]})},q5=r=>{const{sanjeevaniReport:e}=r,t=$e();return o.jsxs("div",{children:[o.jsx(Pt,{...r,toolName:"Samudra Manthan (The Great Churning)",description:"A holistic, multi-disciplinary analysis to identify conflicts and synergies between your project's structural, aesthetic, Vastu, and sustainable systems.",creditCost:40,icon:"🌪️",apiFn:Sp,buildPayload:n=>{var s;return[t.createProjectData({projectType:((s=n.currentProject)==null?void 0:s.projectType)||"building",levels:n.levels,planNorthDirection:n.planNorthDirection,propertyLines:n.propertyLines,terrainMesh:n.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(n,i)=>i.setSanjeevaniReport(n),buttonText:"Perform Holistic Analysis"}),e&&o.jsx(_5,{report:e})]})},z5=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-3",children:[o.jsx("h4",{className:"font-semibold text-slate-200",children:"Singularity Protocol Report"}),o.jsx("p",{className:"text-sm text-slate-300 italic",children:r.summary}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-semibold text-slate-200 mb-1",children:"Generated Assets:"}),o.jsx("ul",{className:"space-y-2 text-sm",children:r.generatedAssets.map((e,t)=>o.jsxs("li",{className:"flex justify-between p-2 bg-slate-900/50 rounded-md",children:[o.jsx("span",{children:e.type}),o.jsx("span",{className:e.status==="Success"?"text-green-400":"text-red-400",children:e.status})]},t))})]})]}),U5=r=>{const e=$e();return o.jsx(Pt,{...r,toolName:"Singularity Engine",description:"The final step. Orchestrate all presentation engines to generate a complete, client-ready package including GFC drawings, cinematic tours, renders, and a professional folio.",creditCost:500,icon:"🌌",apiFn:Lp,buildPayload:t=>{var i;return[e.createProjectData({projectType:((i=t.currentProject)==null?void 0:i.projectType)||"building",levels:t.levels,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(t,n)=>n.setSingularityReport(t),buttonText:"Activate Singularity",renderResult:t=>z5(t)})},V5=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-3",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-slate-200",children:"Geotechnical Report"}),o.jsxs("ul",{className:"text-sm text-slate-300 list-disc list-inside",children:[o.jsxs("li",{children:["Soil Type: ",r.geotechnicalReport.assumedSoilType]}),o.jsxs("li",{children:["Est. SBC: ",r.geotechnicalReport.estimatedSbc]}),o.jsxs("li",{children:["Water Table: ",r.geotechnicalReport.waterTableDepth]})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-slate-200",children:"Recommended Foundation"}),o.jsxs("p",{className:"text-sm text-slate-200",children:[o.jsx("strong",{children:"Type:"})," ",r.recommendedFoundation.type]}),o.jsx("p",{className:"text-xs text-slate-400",children:o.jsx("em",{children:r.recommendedFoundation.reasoning})})]})]}),W5=r=>{const e=$e();return o.jsx(Pt,{...r,toolName:"Prithvi-Astra (Geotechnical)",description:"Analyzes the project's location to provide a preliminary geotechnical report and a recommended foundation plan based on our Living Root Systems philosophy.",creditCost:20,icon:"🌱",apiFn:Pp,buildPayload:t=>{var i,s,l;return(i=t.currentProject)!=null&&i.location?[e.createProjectData({name:((s=t.currentProject)==null?void 0:s.name)||"Untitled Project",projectType:((l=t.currentProject)==null?void 0:l.projectType)||"building",levels:t.levels,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh,zones:t.zones,infrastructure:t.infrastructure,location:t.location})]:(t.addNotification("Please set a project location in the Project Hub first.","error"),null)},onSuccess:(t,n)=>{var s;const i=t;n.setPrithviAstraReport(i),(s=i.recommendedFoundation)!=null&&s.preliminaryPlan&&n.levels[0]&&n.setSingleLevelProp("foundationPlan",i.recommendedFoundation.preliminaryPlan)},buttonText:"Run Geotechnical Analysis",renderResult:t=>V5(t)})},H5=r=>o.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg space-y-3 max-h-96 overflow-y-auto",children:[o.jsx("h4",{className:"font-semibold text-slate-200",children:"Structural System"}),o.jsx("p",{className:"text-sm text-slate-300 italic",children:r.structuralSystemSummary}),o.jsxs("details",{children:[o.jsxs("summary",{className:"cursor-pointer font-semibold text-slate-200",children:["Column Schedule (",r.columnSchedule.length,")"]}),o.jsx("ul",{className:"text-xs text-slate-300 mt-1 pl-4",children:r.columnSchedule.map(e=>o.jsxs("li",{children:[e.id,": ",e.size," - ",e.reinforcement]},e.id))})]}),o.jsxs("details",{children:[o.jsxs("summary",{className:"cursor-pointer font-semibold text-slate-200",children:["Beam Layout (",r.beamLayout.length,")"]}),o.jsx("ul",{className:"text-xs text-slate-300 mt-1 pl-4",children:r.beamLayout.map(e=>o.jsxs("li",{children:[e.id,": ",e.size," - ",e.reinforcement]},e.id))})]})]}),G5=r=>{const{prithviAstraReport:e,setActiveTool:t}=r,n=$e();return e?o.jsx(Pt,{...r,toolName:"Agni-Astra (Structural Detailing)",description:"Designs a complete RCC structural system (columns, beams, slabs) based on your architectural plan and the geotechnical report.",creditCost:40,icon:"🔥",apiFn:kp,buildPayload:i=>{var l,u,d;return i.prithviAstraReport?[n.createProjectData({name:((l=i.currentProject)==null?void 0:l.name)||"Untitled Project",projectType:((u=i.currentProject)==null?void 0:u.projectType)||"building",levels:i.levels,planNorthDirection:i.planNorthDirection,propertyLines:i.propertyLines,terrainMesh:i.terrainMesh,zones:i.zones,infrastructure:i.infrastructure,location:(d=i.currentProject)==null?void 0:d.location}),i.prithviAstraReport]:(i.addNotification("Geotechnical report is missing.","error"),null)},onSuccess:(i,s)=>{s.setAgniAstraReport(i)},buttonText:"Generate Structural System",renderResult:i=>H5(i)}):o.jsxs("div",{className:"text-center p-4",children:[o.jsx("p",{className:"text-sm text-slate-300 mb-4",children:"A Geotechnical Report is required to run the Structural Detailing engine. Please run the Prithvi-Astra tool first."}),o.jsx("button",{onClick:()=>t("geotechnical"),className:"w-full p-2 bg-sky-600 hover:bg-sky-500 rounded-md text-sm",children:"Go to Geotechnical Tool"})]})},$5=r=>{const{currentUser:e,setBuyCreditsModalOpen:t,refreshCurrentUser:n,setLevels:i,pushToUndoStack:s,currentProject:l,setLastAiToolRun:u}=r,[d,m]=V.useState(!1),{addNotification:g}=pr(),v=qn.useRef(null),y=async p=>{var I;const N=(I=p.target.files)==null?void 0:I[0];if(!N)return;if(!e){g("Please log in.","error");return}if(e.role!=="owner"&&e.credits<20){g("You need 20 credits.","info"),t(!0);return}m(!0);const b=new FileReader;b.onload=async w=>{var T;const S=((T=w.target)==null?void 0:T.result).split(",")[1];try{s();const W=await Dp((l==null?void 0:l.id)||"",S,N.type);i(W.levels||[]),g("Floor plan generated from image!","success"),u("Sketch to Plan"),await n()}catch(W){g(`Failed to generate plan: ${W.message}`,"error")}finally{m(!1)}},b.readAsDataURL(N)};return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-sky-300",children:"Sketch to Plan"}),o.jsx("p",{className:"text-sm text-slate-300 my-3",children:"Upload an image of a hand-drawn sketch or a blueprint, and the AI will convert it into an editable digital floor plan."}),o.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:v,onChange:y}),o.jsxs("button",{onClick:()=>{var p;return(p=v.current)==null?void 0:p.click()},disabled:d,className:"w-full mt-2 px-4 py-3 text-white font-semibold rounded-md disabled:opacity-50 flex items-center justify-center transition-all bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[d?o.jsx(dt,{size:"h-5 w-5 mr-2"}):o.jsx("span",{className:"mr-2 text-lg",children:"✍️"}),d?"Analyzing Image...":"Upload Image & Generate Plan (20 Cr)"]})]})},K5=r=>o.jsx(Pt,{...r,toolName:"Plumbing Layout",description:"Generates a preliminary plumbing layout for wet areas.",creditCost:15,icon:"💧",apiFn:_p,buildPayload:e=>{var n;return[$e().createProjectData({projectType:((n=e.currentProject)==null?void 0:n.projectType)||"building",levels:e.levels,planNorthDirection:e.planNorthDirection,propertyLines:e.propertyLines,terrainMesh:e.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(e,t)=>t.setSingleLevelProp("plumbingLayout",e.plumbingLayout)}),Y5=r=>o.jsx(Pt,{...r,toolName:"Electrical Layout",description:"Generates a preliminary electrical layout with circuits and wiring paths.",creditCost:15,icon:"⚡️",apiFn:Cp,buildPayload:e=>{var n;return[$e().createProjectData({projectType:((n=e.currentProject)==null?void 0:n.projectType)||"building",levels:e.levels,planNorthDirection:e.planNorthDirection,propertyLines:e.propertyLines,terrainMesh:e.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(e,t)=>t.setSingleLevelProp("electricalLayout",e)}),J5=r=>o.jsx(Pt,{...r,toolName:"HVAC Layout",description:"Generates a preliminary HVAC layout with ducts and vents.",creditCost:15,icon:"💨",apiFn:Ip,buildPayload:e=>{var n;return[$e().createProjectData({projectType:((n=e.currentProject)==null?void 0:n.projectType)||"building",levels:e.levels,planNorthDirection:e.planNorthDirection,propertyLines:e.propertyLines,terrainMesh:e.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(e,t)=>t.setSingleLevelProp("hvacLayout",e)}),X5=r=>o.jsx(Pt,{...r,toolName:"Flow & Ergonomics Analysis",description:"Analyzes the floor plan for movement pathways and potential ergonomic issues.",creditCost:2,icon:"🚶",apiFn:Ep,buildPayload:e=>{var n;return[$e().createProjectData({projectType:((n=e.currentProject)==null?void 0:n.projectType)||"building",levels:e.levels,planNorthDirection:e.planNorthDirection,propertyLines:e.propertyLines,terrainMesh:e.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(e,t)=>{const n=e;t.addNotification(`${n.length} flow/ergonomics issues found. Check console for details.`,"info"),console.log("Flow & Ergonomics Report:",n)}}),Q5=r=>o.jsx(Pt,{...r,toolName:"Cinematic Tour",description:"Generates a cinematic tour script and camera path for your project.",creditCost:40,icon:"🎬",apiFn:Op,buildPayload:e=>{var n;return[$e().createProjectData({projectType:((n=e.currentProject)==null?void 0:n.projectType)||"building",levels:e.levels,planNorthDirection:e.planNorthDirection,propertyLines:e.propertyLines,terrainMesh:e.terrainMesh,zones:[],infrastructure:[]})]},onSuccess:(e,t)=>{t.setCinematicTourData(e),t.addNotification("Cinematic tour is ready! Click the ▶️ button on the bottom dock.","success")}}),Z5=r=>{const{addNotification:e}=pr();return o.jsx(Pt,{...r,toolName:"Site Analysis",description:"Analyzes the project site, including terrain and property lines.",creditCost:10,icon:"🗺️",apiFn:Tp,buildPayload:t=>{var i;return t.terrainMesh?[$e().createProjectData({projectType:((i=t.currentProject)==null?void 0:i.projectType)||"building",levels:t.levels,planNorthDirection:t.planNorthDirection,propertyLines:t.propertyLines,terrainMesh:t.terrainMesh})]:(e("Please generate a terrain before analyzing the site.","error"),null)},onSuccess:(t,n)=>{n.addNotification(`Site Analysis Complete: ${t.summary}`,"success")}})},eg=({id:r,isActive:e,onClick:t,children:n,isPremium:i})=>o.jsxs("button",{id:r,onClick:t,className:`px-3 py-2 text-xs font-medium border-b-2 transition-colors whitespace-nowrap ${e?i?"border-amber-400 text-amber-300":"border-sky-400 text-sky-300":"border-transparent text-slate-400 hover:text-white"}`,children:[i&&"✨"," ",n]}),Mo={core:{label:"Core AI",tools:["aiArchitect","samarangan","conceptExplorer","sketchToPlan","nexus","research","oracle"]},analysis:{label:"Analysis",tools:["boq","sustainability","compliance","structural","vastu","flow","material","constructionCam"]},civil:{label:"Civil & Site",tools:["geotechnical","structuralDetailing","site","hydro","climate"]},fabrication:{label:"Fabrication",tools:["gfcDrawings","3dSynthesis","fabrication"]},presentation:{label:"Presentation",tools:["render","aiDecorator","cinematicTour","mediaKit","holocron","staging"]},mep:{label:"MEP",tools:["plumbing","electrical","hvac"]},advanced:{label:"Transcendence",tools:["cosmicTiming","akasha","lifecycle","aesthetics","atmanSignature","optimizer","holisticAnalysis","singularity"]},utility:{label:"Utility",tools:["comments","modelLibrary"]}},hd=r=>{for(const e in Mo)if(Mo[e].tools.includes(r))return e;return"core"},tg=r=>{const{activeTool:e,setActiveTool:t}=r,[n,i]=qn.useState(hd(e)),s=u=>{i(u),t(Mo[u].tools[0])};qn.useEffect(()=>{i(hd(e))},[e]);const l=()=>{switch(e){case"aiArchitect":return o.jsx("div",{id:"mission-step-2-target",children:o.jsx(_1,{...r})});case"samarangan":return o.jsx(A5,{...r});case"conceptExplorer":return o.jsx(H1,{...r});case"sketchToPlan":return o.jsx($5,{...r});case"nexus":return o.jsx(b5,{...r});case"research":return o.jsx(E1,{...r});case"oracle":return o.jsx(e2,{...r});case"boq":return o.jsx(D1,{...r});case"sustainability":return o.jsx(F1,{...r});case"compliance":return o.jsx(B1,{...r});case"structural":return o.jsx(V1,{...r});case"vastu":return o.jsx(g5,{...r});case"flow":return o.jsx(X5,{...r});case"material":return o.jsx(z1,{...r});case"constructionCam":return o.jsx(t2,{...r});case"geotechnical":return o.jsx(W5,{...r});case"structuralDetailing":return o.jsx(G5,{...r});case"site":return o.jsx(Z5,{...r});case"hydro":return o.jsx(p5,{...r});case"climate":return o.jsx(h5,{...r});case"gfcDrawings":return o.jsx(c5,{...r});case"3dSynthesis":return o.jsx(w5,{...r});case"fabrication":return o.jsx(u5,{...r});case"render":return o.jsx("div",{id:"mission-step-3-target",children:o.jsx(s2,{...r})});case"aiDecorator":return o.jsx($1,{...r});case"cinematicTour":return o.jsx(Q5,{...r});case"mediaKit":return o.jsx(d5,{...r});case"staging":return o.jsx(Q1,{...r});case"plumbing":return o.jsx(K5,{...r});case"electrical":return o.jsx(Y5,{...r});case"hvac":return o.jsx(J5,{...r});case"cosmicTiming":return o.jsx(I5,{...r});case"akasha":return o.jsx(O5,{...r});case"lifecycle":return o.jsx(D5,{...r});case"aesthetics":return o.jsx(F5,{...r});case"atmanSignature":return o.jsx(M5,{...r});case"optimizer":return o.jsx(B5,{...r});case"holisticAnalysis":return o.jsx(q5,{...r});case"singularity":return o.jsx(U5,{...r});case"comments":return o.jsx(n2,{...r});case"modelLibrary":return o.jsx(i2,{...r});case"holocron":return o.jsx(L5,{...r});default:return o.jsxs("p",{children:["Tool '",e,"' not implemented yet."]})}};return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx("div",{className:"border-b border-slate-700 flex-shrink-0",children:o.jsx("div",{className:"flex overflow-x-auto",children:Object.entries(Mo).map(([u,{label:d}])=>o.jsx(eg,{isActive:n===u,onClick:()=>s(u),children:d},u))})}),o.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:l()})]})},rg=(r,e)=>{if(!r.type||!r.orientation)return{summary:"Room type or orientation not defined for Vastu scan.",scoreConcept:0,colorHint:"gray"};const t=r.type.toLowerCase(),n=r.orientation.toLowerCase();let i=50,s=`Vastu for a ${r.type} in the ${r.orientation} is generally neutral.`,l="text-yellow-400";return t.includes("kitchen")&&(n.includes("south-east")?(i=90,s="Excellent: Kitchen in the South-East (Agni) zone is ideal.",l="text-emerald-400"):n.includes("north-west")?(i=75,s="Good: Kitchen in the North-West zone is a viable alternative.",l="text-emerald-400"):n.includes("north-east")?(i=10,s="Poor: Kitchen in the North-East (Ishan) zone is a major Vastu defect.",l="text-red-400"):(i=40,s=`Okay: Kitchen placement in the ${r.orientation} may need remedies.`,l="text-yellow-400")),{summary:`${s} (Score: ${i}/100)`,scoreConcept:i,colorHint:l}},ng=({currentProject:r,loadProject:e,addNotification:t})=>{const[n,i]=V.useState({location:"",clientProfile:"",siteContext:"",specificRequirements:""}),[s,l]=V.useState(!1);V.useEffect(()=>{r&&i({location:r.location||"",clientProfile:r.clientProfile||"",siteContext:r.siteContext||"",specificRequirements:r.specificRequirements||""})},[r]);const u=m=>{i(g=>({...g,[m.target.name]:m.target.value}))},d=async()=>{if(r){l(!0);try{const m={...n},g=await zp({projectContent:{...r,...m},projectName:r.name,commitMessage:"Updated project details from properties panel",existingProjectId:r.id});t("Project details updated successfully.","success"),await e(g.project.id)}catch(m){t(`Failed to save details: ${m.message}`,"error")}finally{l(!1)}}};return r?o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsx("h4",{className:"font-bold text-sky-300",children:"Project Details"}),o.jsx("p",{className:"text-xs text-slate-400 -mt-2",children:"Providing these details helps the AI generate more accurate and context-aware designs."}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Location"}),o.jsx("input",{type:"text",name:"location",value:n.location,onChange:u,className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md",placeholder:"e.g., Goa, India"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Client Profile"}),o.jsx("textarea",{name:"clientProfile",value:n.clientProfile,onChange:u,rows:3,className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md",placeholder:"Describe the client, their family, lifestyle..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Site & Climate Context"}),o.jsx("textarea",{name:"siteContext",value:n.siteContext,onChange:u,rows:3,className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md",placeholder:"Describe the site's surroundings, climate..."})]}),o.jsx("div",{className:"flex justify-end",children:o.jsxs("button",{onClick:d,disabled:s,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500 rounded-md font-semibold text-white disabled:opacity-50 flex items-center text-sm",children:[s&&o.jsx(dt,{size:"h-4 w-4 mr-2"})," Save Details"]})})]}):o.jsx("p",{className:"p-4 text-slate-400",children:"No project loaded."})},vn=({label:r,children:e})=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:r}),e]}),wo=({value:r,onBlur:e,onKeyDown:t})=>{const[n,i]=qn.useState(r.toFixed(2));qn.useEffect(()=>{i(r.toFixed(2))},[r]);const s=()=>{const l=parseFloat(n);isNaN(l)?i(r.toFixed(2)):e(l)};return o.jsx("input",{type:"number",value:n,onChange:l=>i(l.target.value),onBlur:s,onKeyDown:t,className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-slate-100 text-sm"})},ig=({value:r,onChange:e,children:t})=>o.jsx("select",{value:r,onChange:n=>e(n.target.value),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-slate-100 text-sm",children:t}),sg=r=>{const{selectedObject:e,levels:t,pushToUndoStack:n,setSingleLevelProp:i,planNorthDirection:s,logUserCorrection:l}=r;if(!e)return o.jsx(ng,{...r});const{id:u,type:d,levelIndex:m}=e,g=t[m],v=(p,N)=>{n();const I={wall:"walls",room:"rooms",placement:"placements",placedModel:"placedModels"}[d];I&&(i(I,w=>w.map(S=>S.id===u?p(S):S)),N&&l&&l(N))},y=()=>{switch(d){case"wall":const p=g.walls.find(w=>w.id===u);return p?o.jsxs("div",{className:"space-y-4",children:[o.jsx(vn,{label:"Wall Length",children:o.jsx(wo,{value:Math.hypot(p.x2-p.x1,p.y2-p.y1),onBlur:()=>{}})}),o.jsx(vn,{label:"Height",children:o.jsx(wo,{value:p.height,onBlur:w=>v(S=>({...S,height:w}),{type:"modify-wall",objectId:u,property:"height",oldValue:p.height,newValue:w})})}),o.jsx(vn,{label:"Thickness",children:o.jsx(wo,{value:p.thickness,onBlur:w=>v(S=>({...S,thickness:w}),{type:"modify-wall",objectId:u,property:"thickness",oldValue:p.thickness,newValue:w})})}),o.jsx(vn,{label:"Material",children:o.jsxs(ig,{value:p.material||"",onChange:w=>v(S=>({...S,material:w})),children:[o.jsx("option",{value:"",children:"-- Select Material --"}),Rp.map(w=>o.jsx("option",{value:w.key,children:w.name},w.key))]})})]}):null;case"room":const N=g.rooms.find(w=>w.id===u);if(!N)return null;const b=rg(N);return o.jsxs("div",{className:"space-y-4",children:[o.jsx(vn,{label:"Room Name",children:o.jsx("input",{type:"text",value:N.name,onChange:w=>v(S=>({...S,name:w.target.value})),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-sm"})}),o.jsx(vn,{label:"Room Type",children:o.jsx("input",{type:"text",value:N.type,onChange:w=>v(S=>({...S,type:w.target.value})),className:"w-full p-2 bg-slate-700 border border-slate-600 rounded-md text-sm"})}),o.jsx(vn,{label:"Area (sq. ft.)",children:o.jsx("p",{className:"p-2 text-sm font-mono",children:((N.calculatedArea||0)/100).toFixed(2)})}),o.jsx(vn,{label:"Vastu Compliance",children:o.jsx("div",{className:`p-2 rounded-md text-sm border-l-4 ${b.colorHint==="text-emerald-400"?"border-emerald-400":b.colorHint==="text-red-400"?"border-red-400":"border-yellow-400"}`,children:o.jsx("p",{className:`${b.colorHint}`,children:b.summary})})})]});case"placedModel":const I=g.placedModels.find(w=>w.id===u);return I?o.jsxs("div",{className:"space-y-4",children:[o.jsx(vn,{label:"Name",children:o.jsx("p",{className:"p-2 text-sm",children:I.name})}),o.jsx(vn,{label:"Rotation",children:o.jsx(wo,{value:I.rotation,onBlur:w=>v(S=>({...S,rotation:w}))})})]}):null;default:return o.jsx("p",{children:"No properties to display for this object type."})}};return o.jsxs("div",{className:"p-4",children:[o.jsxs("h4",{className:"font-bold text-sky-300 capitalize",children:[d," Properties"]}),o.jsx("div",{className:"mt-4",children:y()})]})},ag=({layers:r,activeLayerId:e,setActiveLayerId:t,onAddLayer:n,onUpdateLayer:i,onDeleteLayer:s})=>o.jsxs("div",{className:"h-full flex flex-col p-2 text-white",children:[o.jsx("ul",{className:"flex-grow space-y-1 overflow-y-auto pr-1",children:r.map(l=>o.jsxs("li",{onClick:()=>t(l.id),className:`flex items-center gap-2 p-2 rounded-md cursor-pointer transition-colors ${e===l.id?"bg-sky-700/80 ring-1 ring-sky-500":"bg-slate-700/50 hover:bg-slate-600/50"}`,children:[o.jsx("button",{onClick:u=>{u.stopPropagation(),i(l.id,{isVisible:!l.isVisible})},title:l.isVisible?"Hide Layer":"Show Layer",className:"flex-shrink-0",children:l.isVisible?o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[o.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),o.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M13.477 14.89A6 6 0 015.11 6.524l8.367 8.367zM10 18a8 8 0 01-8-8c0-1.421.38-2.75.996-3.896l11.898 11.898A7.962 7.962 0 0110 18z",clipRule:"evenodd"})})}),o.jsx("button",{onClick:u=>{u.stopPropagation(),i(l.id,{isLocked:!l.isLocked})},title:l.isLocked?"Unlock Layer":"Lock Layer",className:"flex-shrink-0",children:l.isLocked?o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2-2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v5a2 2 0 002 2h10a2 2 0 002-2v-5a2 2 0 00-2-2V7a5 5 0 00-5-5zm0 9a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})}),o.jsx("span",{onDoubleClick:u=>{u.stopPropagation();const d=prompt("Enter new layer name:",l.name);d&&i(l.id,{name:d})},className:"text-sm flex-grow truncate",title:l.name,children:l.name}),o.jsx("button",{onClick:u=>{u.stopPropagation(),s(l.id)},title:"Delete Layer",className:"text-slate-500 hover:text-red-400 disabled:cursor-not-allowed disabled:text-slate-600",disabled:r.length<=1,children:"×"})]},l.id))}),o.jsx("div",{className:"mt-2 flex-shrink-0",children:o.jsx("button",{onClick:n,className:"w-full p-2 text-sm bg-slate-600 hover:bg-slate-500 rounded-md",children:"+ Add Layer"})})]}),fd=({isActive:r,onClick:e,children:t})=>o.jsx("button",{onClick:e,className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${r?"border-sky-400 text-sky-300":"border-transparent text-slate-400 hover:text-white"}`,children:t}),og=({doc:r})=>o.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-900/50 rounded-md",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-slate-200",children:r.name}),o.jsxs("p",{className:"text-xs text-slate-400",children:[r.type," - ",new Date(r.createdAt).toLocaleDateString()]})]}),o.jsx("a",{href:r.url,download:r.name,className:"px-3 py-1 text-xs bg-slate-600 hover:bg-slate-500 rounded-md",children:"Download"})]}),lg=({render:r})=>o.jsxs("div",{className:"bg-slate-900/50 rounded-lg overflow-hidden group",children:[o.jsx("img",{src:r.url,alt:r.prompt,className:"w-full h-32 object-cover"}),o.jsxs("div",{className:"p-2",children:[o.jsx("p",{className:"text-xs text-slate-400 truncate group-hover:whitespace-normal",children:r.prompt}),o.jsx("a",{href:r.url,download:`render_${r._id}.png`,className:"text-xs mt-2 inline-block text-sky-400 hover:underline",children:"Download"})]})]}),cg=()=>{const{currentProject:r}=$e(),[e,t]=V.useState("docs");if(!r)return o.jsx("div",{className:"p-4 text-center text-slate-400",children:"No project loaded."});const{generatedDocuments:n=[],generatedRenders:i=[]}=r;return o.jsxs("div",{className:"p-2 h-full flex flex-col",children:[o.jsx("div",{className:"border-b border-slate-700 flex-shrink-0",children:o.jsxs("nav",{className:"flex space-x-2",children:[o.jsxs(fd,{isActive:e==="docs",onClick:()=>t("docs"),children:["Documents (",n.length,")"]}),o.jsxs(fd,{isActive:e==="renders",onClick:()=>t("renders"),children:["Renders (",i.length,")"]})]})}),o.jsxs("div",{className:"flex-grow overflow-y-auto pt-4",children:[e==="docs"&&o.jsx("div",{className:"space-y-2 pr-2",children:n.length>0?n.map(s=>o.jsx(og,{doc:s},s._id)):o.jsx("p",{className:"text-center text-sm text-slate-500 pt-8",children:"No documents have been generated yet."})}),e==="renders"&&o.jsx("div",{className:"grid grid-cols-2 gap-3 pr-2",children:i.length>0?i.map(s=>o.jsx(lg,{render:s},s._id)):o.jsx("p",{className:"col-span-2 text-center text-sm text-slate-500 pt-8",children:"No renders have been generated yet."})})]})]})},An=Object.create(null);An.open="0";An.close="1";An.ping="2";An.pong="3";An.message="4";An.upgrade="5";An.noop="6";const ko=Object.create(null);Object.keys(An).forEach(r=>{ko[An[r]]=r});const Nc={type:"error",data:"parser error"},jh=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ah=typeof ArrayBuffer=="function",Sh=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,Uc=({type:r,data:e},t,n)=>jh&&e instanceof Blob?t?n(e):pd(e,n):Ah&&(e instanceof ArrayBuffer||Sh(e))?t?n(e):pd(new Blob([e]),n):n(An[r]+(e||"")),pd=(r,e)=>{const t=new FileReader;return t.onload=function(){const n=t.result.split(",")[1];e("b"+(n||""))},t.readAsDataURL(r)};function md(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let Xl;function ug(r,e){if(jh&&r.data instanceof Blob)return r.data.arrayBuffer().then(md).then(e);if(Ah&&(r.data instanceof ArrayBuffer||Sh(r.data)))return e(md(r.data));Uc(r,!1,t=>{Xl||(Xl=new TextEncoder),e(Xl.encode(t))})}const gd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ma=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<gd.length;r++)ma[gd.charCodeAt(r)]=r;const dg=r=>{let e=r.length*.75,t=r.length,n,i=0,s,l,u,d;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);const m=new ArrayBuffer(e),g=new Uint8Array(m);for(n=0;n<t;n+=4)s=ma[r.charCodeAt(n)],l=ma[r.charCodeAt(n+1)],u=ma[r.charCodeAt(n+2)],d=ma[r.charCodeAt(n+3)],g[i++]=s<<2|l>>4,g[i++]=(l&15)<<4|u>>2,g[i++]=(u&3)<<6|d&63;return m},hg=typeof ArrayBuffer=="function",Vc=(r,e)=>{if(typeof r!="string")return{type:"message",data:Lh(r,e)};const t=r.charAt(0);return t==="b"?{type:"message",data:fg(r.substring(1),e)}:ko[t]?r.length>1?{type:ko[t],data:r.substring(1)}:{type:ko[t]}:Nc},fg=(r,e)=>{if(hg){const t=dg(r);return Lh(t,e)}else return{base64:!0,data:r}},Lh=(r,e)=>{switch(e){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},Ph=String.fromCharCode(30),pg=(r,e)=>{const t=r.length,n=new Array(t);let i=0;r.forEach((s,l)=>{Uc(s,!1,u=>{n[l]=u,++i===t&&e(n.join(Ph))})})},mg=(r,e)=>{const t=r.split(Ph),n=[];for(let i=0;i<t.length;i++){const s=Vc(t[i],e);if(n.push(s),s.type==="error")break}return n};function gg(){return new TransformStream({transform(r,e){ug(r,t=>{const n=t.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const s=new DataView(i.buffer);s.setUint8(0,126),s.setUint16(1,n)}else{i=new Uint8Array(9);const s=new DataView(i.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(n))}r.data&&typeof r.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(t)})}})}let Ql;function No(r){return r.reduce((e,t)=>e+t.length,0)}function jo(r,e){if(r[0].length===e)return r.shift();const t=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)t[i]=r[0][n++],n===r[0].length&&(r.shift(),n=0);return r.length&&n<r[0].length&&(r[0]=r[0].slice(n)),t}function vg(r,e){Ql||(Ql=new TextDecoder);const t=[];let n=0,i=-1,s=!1;return new TransformStream({transform(l,u){for(t.push(l);;){if(n===0){if(No(t)<1)break;const d=jo(t,1);s=(d[0]&128)===128,i=d[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(No(t)<2)break;const d=jo(t,2);i=new DataView(d.buffer,d.byteOffset,d.length).getUint16(0),n=3}else if(n===2){if(No(t)<8)break;const d=jo(t,8),m=new DataView(d.buffer,d.byteOffset,d.length),g=m.getUint32(0);if(g>Math.pow(2,53-32)-1){u.enqueue(Nc);break}i=g*Math.pow(2,32)+m.getUint32(4),n=3}else{if(No(t)<i)break;const d=jo(t,i);u.enqueue(Vc(s?d:Ql.decode(d),e)),n=0}if(i===0||i>r){u.enqueue(Nc);break}}}})}const kh=4;function Ht(r){if(r)return xg(r)}function xg(r){for(var e in Ht.prototype)r[e]=Ht.prototype[e];return r}Ht.prototype.on=Ht.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};Ht.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};Ht.prototype.off=Ht.prototype.removeListener=Ht.prototype.removeAllListeners=Ht.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var n,i=0;i<t.length;i++)if(n=t[i],n===e||n.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+r],this};Ht.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,i=t.length;n<i;++n)t[n].apply(this,e)}return this};Ht.prototype.emitReserved=Ht.prototype.emit;Ht.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};Ht.prototype.hasListeners=function(r){return!!this.listeners(r).length};const Xo=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))(),zr=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())(),yg="arraybuffer";function _h(r,...e){return e.reduce((t,n)=>(r.hasOwnProperty(n)&&(t[n]=r[n]),t),{})}const bg=zr.setTimeout,wg=zr.clearTimeout;function Qo(r,e){e.useNativeTimers?(r.setTimeoutFn=bg.bind(zr),r.clearTimeoutFn=wg.bind(zr)):(r.setTimeoutFn=zr.setTimeout.bind(zr),r.clearTimeoutFn=zr.clearTimeout.bind(zr))}const Ng=1.33;function jg(r){return typeof r=="string"?Ag(r):Math.ceil((r.byteLength||r.size)*Ng)}function Ag(r){let e=0,t=0;for(let n=0,i=r.length;n<i;n++)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function Ch(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Sg(r){let e="";for(let t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e}function Lg(r){let e={},t=r.split("&");for(let n=0,i=t.length;n<i;n++){let s=t[n].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class Pg extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class Wc extends Ht{constructor(e){super(),this.writable=!1,Qo(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new Pg(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Vc(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=Sg(e);return t.length?"?"+t:""}}class kg extends Wc{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};mg(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,pg(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Ch()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Ih=!1;try{Ih=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const _g=Ih;function Cg(){}class Ig extends kg{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let n=location.port;n||(n=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}}class jn extends Ht{constructor(e,t,n){super(),this.createRequest=e,Qo(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const t=_h(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=jn.requestsCount++,jn.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Cg,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete jn.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}jn.requestsCount=0;jn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",vd);else if(typeof addEventListener=="function"){const r="onpagehide"in zr?"pagehide":"unload";addEventListener(r,vd,!1)}}function vd(){for(let r in jn.requests)jn.requests.hasOwnProperty(r)&&jn.requests[r].abort()}const Eg=function(){const r=Eh({xdomain:!1});return r&&r.responseType!==null}();class Og extends Ig{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=Eg&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new jn(Eh,this.uri(),e)}}function Eh(r){const e=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||_g))return new XMLHttpRequest}catch{}if(!e)try{return new zr[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Oh=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Tg extends Wc{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=Oh?{}:_h(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],i=t===e.length-1;Uc(n,this.supportsBinary,s=>{try{this.doWrite(n,s)}catch{}i&&Xo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Ch()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Zl=zr.WebSocket||zr.MozWebSocket;class Dg extends Tg{createSocket(e,t,n){return Oh?new Zl(e,t,n):t?new Zl(e,t):new Zl(e)}doWrite(e,t){this.ws.send(t)}}class Rg extends Wc{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=vg(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),i=gg();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const s=()=>{n.read().then(({done:u,value:d})=>{u||(this.onPacket(d),s())}).catch(u=>{})};s();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],i=t===e.length-1;this._writer.write(n).then(()=>{i&&Xo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Fg={websocket:Dg,webtransport:Rg,polling:Og},Mg=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Bg=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function jc(r){if(r.length>8e3)throw"URI too long";const e=r,t=r.indexOf("["),n=r.indexOf("]");t!=-1&&n!=-1&&(r=r.substring(0,t)+r.substring(t,n).replace(/:/g,";")+r.substring(n,r.length));let i=Mg.exec(r||""),s={},l=14;for(;l--;)s[Bg[l]]=i[l]||"";return t!=-1&&n!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=qg(s,s.path),s.queryKey=zg(s,s.query),s}function qg(r,e){const t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function zg(r,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,s){i&&(t[i]=s)}),t}const Ac=typeof addEventListener=="function"&&typeof removeEventListener=="function",_o=[];Ac&&addEventListener("offline",()=>{_o.forEach(r=>r())},!1);class ai extends Ht{constructor(e,t){if(super(),this.binaryType=yg,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const n=jc(e);t.hostname=n.host,t.secure=n.protocol==="https"||n.protocol==="wss",t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=jc(t.host).host);Qo(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(n=>{const i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Lg(this.opts.query)),Ac&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},_o.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=kh,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&ai.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",ai.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(t+=jg(i)),n>0&&t>this._maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Xo(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,i){if(typeof t=="function"&&(i=t,t=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const s={type:e,data:t,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(ai.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ac&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=_o.indexOf(this._offlineEventListener);n!==-1&&_o.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}ai.protocol=kh;class Ug extends ai{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;ai.priorWebsocketSuccess=!1;const i=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",v=>{if(!n)if(v.type==="pong"&&v.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;ai.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(g(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const y=new Error("probe error");y.transport=t.name,this.emitReserved("upgradeError",y)}}))};function s(){n||(n=!0,g(),t.close(),t=null)}const l=v=>{const y=new Error("probe error: "+v);y.transport=t.name,s(),this.emitReserved("upgradeError",y)};function u(){l("transport closed")}function d(){l("socket closed")}function m(v){t&&v.name!==t.name&&s()}const g=()=>{t.removeListener("open",i),t.removeListener("error",l),t.removeListener("close",u),this.off("close",d),this.off("upgrading",m)};t.once("open",i),t.once("error",l),t.once("close",u),this.once("close",d),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let Vg=class extends Ug{constructor(e,t={}){const n=typeof e=="object"?e:t;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>Fg[i]).filter(i=>!!i)),super(e,n)}};function Wg(r,e="",t){let n=r;t=t||typeof location<"u"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(typeof t<"u"?r=t.protocol+"//"+r:r="https://"+r),n=jc(r)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const s=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(t&&t.port===n.port?"":":"+n.port),n}const Hg=typeof ArrayBuffer=="function",Gg=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Th=Object.prototype.toString,$g=typeof Blob=="function"||typeof Blob<"u"&&Th.call(Blob)==="[object BlobConstructor]",Kg=typeof File=="function"||typeof File<"u"&&Th.call(File)==="[object FileConstructor]";function Hc(r){return Hg&&(r instanceof ArrayBuffer||Gg(r))||$g&&r instanceof Blob||Kg&&r instanceof File}function Co(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,n=r.length;t<n;t++)if(Co(r[t]))return!0;return!1}if(Hc(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return Co(r.toJSON(),!0);for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&Co(r[t]))return!0;return!1}function Yg(r){const e=[],t=r.data,n=r;return n.data=Sc(t,e),n.attachments=e.length,{packet:n,buffers:e}}function Sc(r,e){if(!r)return r;if(Hc(r)){const t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){const t=new Array(r.length);for(let n=0;n<r.length;n++)t[n]=Sc(r[n],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){const t={};for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=Sc(r[n],e));return t}return r}function Jg(r,e){return r.data=Lc(r.data,e),delete r.attachments,r}function Lc(r,e){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<e.length)return e[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=Lc(r[t],e);else if(typeof r=="object")for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&(r[t]=Lc(r[t],e));return r}const Xg=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Qg=5;var at;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(at||(at={}));class Zg{constructor(e){this.replacer=e}encode(e){return(e.type===at.EVENT||e.type===at.ACK)&&Co(e)?this.encodeAsBinary({type:e.type===at.EVENT?at.BINARY_EVENT:at.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===at.BINARY_EVENT||e.type===at.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Yg(e),n=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(n),i}}function xd(r){return Object.prototype.toString.call(r)==="[object Object]"}class Gc extends Ht{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===at.BINARY_EVENT;n||t.type===at.BINARY_ACK?(t.type=n?at.EVENT:at.ACK,this.reconstructor=new ev(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Hc(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(at[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===at.BINARY_EVENT||n.type===at.BINARY_ACK){const s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const l=e.substring(s,t);if(l!=Number(l)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(l)}if(e.charAt(t+1)==="/"){const s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(s,t)}else n.nsp="/";const i=e.charAt(t+1);if(i!==""&&Number(i)==i){const s=t+1;for(;++t;){const l=e.charAt(t);if(l==null||Number(l)!=l){--t;break}if(t===e.length)break}n.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if(Gc.isPayloadValid(n.type,s))n.data=s;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case at.CONNECT:return xd(t);case at.DISCONNECT:return t===void 0;case at.CONNECT_ERROR:return typeof t=="string"||xd(t);case at.EVENT:case at.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Xg.indexOf(t[0])===-1);case at.ACK:case at.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ev{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Jg(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const tv=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Gc,Encoder:Zg,get PacketType(){return at},protocol:Qg},Symbol.toStringTag,{value:"Module"}));function rn(r,e,t){return r.on(e,t),function(){r.off(e,t)}}const rv=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Dh extends Ht{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[rn(e,"open",this.onopen.bind(this)),rn(e,"packet",this.onpacket.bind(this)),rn(e,"error",this.onerror.bind(this)),rn(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,i,s;if(rv.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const l={type:at.EVENT,data:t};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const g=this.ids++,v=t.pop();this._registerAckCallback(g,v),l.id=g}const u=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,d=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!u||(d?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(e,t){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let u=0;u<this.sendBuffer.length;u++)this.sendBuffer[u].id===e&&this.sendBuffer.splice(u,1);t.call(this,new Error("operation has timed out"))},i),l=(...u)=>{this.io.clearTimeoutFn(s),t.apply(this,u)};l.withError=!0,this.acks[e]=l}emitWithAck(e,...t){return new Promise((n,i)=>{const s=(l,u)=>l?i(l):n(u);s.withError=!0,t.push(s),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...s)=>n!==this._queue[0]?void 0:(i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(i)):(this._queue.shift(),t&&t(null,...s)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:at.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case at.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case at.EVENT:case at.BINARY_EVENT:this.onevent(e);break;case at.ACK:case at.BINARY_ACK:this.onack(e);break;case at.DISCONNECT:this.ondisconnect();break;case at.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...i){n||(n=!0,t.packet({type:at.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:at.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Is(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}Is.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=Math.floor(e*10)&1?r+t:r-t}return Math.min(r,this.max)|0};Is.prototype.reset=function(){this.attempts=0};Is.prototype.setMin=function(r){this.ms=r};Is.prototype.setMax=function(r){this.max=r};Is.prototype.setJitter=function(r){this.jitter=r};class Pc extends Ht{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Qo(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Is({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||tv;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Vg(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=rn(t,"open",function(){n.onopen(),e&&e()}),s=u=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",u),e?e(u):this.maybeReconnectOnOpen()},l=rn(t,"error",s);if(this._timeout!==!1){const u=this._timeout,d=this.setTimeoutFn(()=>{i(),s(new Error("timeout")),t.close()},u);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}return this.subs.push(i),this.subs.push(l),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(rn(e,"ping",this.onping.bind(this)),rn(e,"data",this.ondata.bind(this)),rn(e,"error",this.onerror.bind(this)),rn(e,"close",this.onclose.bind(this)),rn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Xo(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Dh(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t)if(this.nsps[n].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const pa={};function ec(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};const t=Wg(r,e.path||"/socket.io"),n=t.source,i=t.id,s=t.path,l=pa[i]&&s in pa[i].nsps,u=e.forceNew||e["force new connection"]||e.multiplex===!1||l;let d;return u?d=new Pc(n,e):(pa[i]||(pa[i]=new Pc(n,e)),d=pa[i]),t.query&&!e.query&&(e.query=t.queryKey),d.socket(t.path,e)}Object.assign(ec,{Manager:Pc,Socket:Dh,io:ec,connect:ec});var Rh="Expected a function",yd=0/0,nv="[object Symbol]",iv=/^\s+|\s+$/g,sv=/^[-+]0x[0-9a-f]+$/i,av=/^0b[01]+$/i,ov=/^0o[0-7]+$/i,lv=parseInt,cv=typeof fo=="object"&&fo&&fo.Object===Object&&fo,uv=typeof self=="object"&&self&&self.Object===Object&&self,dv=cv||uv||Function("return this")(),hv=Object.prototype,fv=hv.toString,pv=Math.max,mv=Math.min,tc=function(){return dv.Date.now()};function gv(r,e,t){var n,i,s,l,u,d,m=0,g=!1,v=!1,y=!0;if(typeof r!="function")throw new TypeError(Rh);e=bd(e)||0,Bo(t)&&(g=!!t.leading,v="maxWait"in t,s=v?pv(bd(t.maxWait)||0,e):s,y="trailing"in t?!!t.trailing:y);function p(te){var H=n,M=i;return n=i=void 0,m=te,l=r.apply(M,H),l}function N(te){return m=te,u=setTimeout(w,e),g?p(te):l}function b(te){var H=te-d,M=te-m,Q=e-H;return v?mv(Q,s-M):Q}function I(te){var H=te-d,M=te-m;return d===void 0||H>=e||H<0||v&&M>=s}function w(){var te=tc();if(I(te))return S(te);u=setTimeout(w,b(te))}function S(te){return u=void 0,y&&n?p(te):(n=i=void 0,l)}function T(){u!==void 0&&clearTimeout(u),m=0,n=d=i=u=void 0}function W(){return u===void 0?l:S(tc())}function G(){var te=tc(),H=I(te);if(n=arguments,i=this,d=te,H){if(u===void 0)return N(d);if(v)return u=setTimeout(w,e),p(d)}return u===void 0&&(u=setTimeout(w,e)),l}return G.cancel=T,G.flush=W,G}function vv(r,e,t){var n=!0,i=!0;if(typeof r!="function")throw new TypeError(Rh);return Bo(t)&&(n="leading"in t?!!t.leading:n,i="trailing"in t?!!t.trailing:i),gv(r,e,{leading:n,maxWait:e,trailing:i})}function Bo(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function xv(r){return!!r&&typeof r=="object"}function yv(r){return typeof r=="symbol"||xv(r)&&fv.call(r)==nv}function bd(r){if(typeof r=="number")return r;if(yv(r))return yd;if(Bo(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Bo(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(iv,"");var t=av.test(r);return t||ov.test(r)?lv(r.slice(2),t?2:8):sv.test(r)?yd:+r}var bv=vv;const wv=Nd(bv);Fp.replace("/api","");const Fh=(r,e)=>{};wv((r,e)=>{},50);const Nv=()=>{const{chatHistory:r,currentProject:e,currentUser:t,addChatMessage:n}=$e(g=>({chatHistory:g.chatHistory,currentProject:g.currentProject,currentUser:g.currentUser,addChatMessage:g.addChatMessage})),[i,s]=V.useState(""),l=V.useRef(null),[u,d]=V.useState(!1);V.useEffect(()=>{var g;(g=l.current)==null||g.scrollIntoView({behavior:"smooth"})},[r]);const m=g=>{if(g.preventDefault(),!i.trim()||!e||!t)return;const v={userId:t.id,userName:t.name||t.email.split("@")[0],text:i,isAI:!1,timestamp:new Date().toISOString()};if(n(v),Fh(e.id),i.toLowerCase().startsWith("@aura")){d(!0);const y=setTimeout(()=>{d(!1)},15e3);return()=>clearTimeout(y)}s("")};return V.useEffect(()=>{r.length>0&&r[r.length-1].isAI&&d(!1)},[r]),o.jsxs("div",{className:"p-2 h-full flex flex-col bg-slate-800 text-white",children:[o.jsxs("div",{className:"flex-grow overflow-y-auto pr-2 space-y-4 mb-2",children:[r.map((g,v)=>o.jsxs("div",{className:`flex gap-3 ${g.isAI?"justify-start":"justify-end"}`,children:[g.isAI&&o.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-500 flex-shrink-0 flex items-center justify-center text-sm font-bold",children:"AI"}),o.jsxs("div",{className:`max-w-xs px-4 py-2 rounded-2xl ${g.isAI?"bg-secondary rounded-bl-none":"bg-primary text-primary-foreground rounded-br-none"}`,children:[o.jsx("p",{className:"text-sm",children:g.text}),o.jsx("p",{className:`text-xs mt-1 ${g.isAI?"text-slate-400":"text-slate-200/70"}`,children:g.userName})]})]},v)),u&&o.jsxs("div",{className:"flex justify-start gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-500 flex-shrink-0 flex items-center justify-center text-sm font-bold",children:"AI"}),o.jsx("div",{className:"px-4 py-2 bg-secondary rounded-2xl rounded-bl-none flex items-center",children:o.jsx(dt,{size:"h-4 w-4"})})]}),o.jsx("div",{ref:l})]}),o.jsxs("form",{onSubmit:m,className:"flex gap-2 flex-shrink-0",children:[o.jsx("input",{value:i,onChange:g=>s(g.target.value),type:"text",placeholder:"Type a message or @aura command...",className:"flex-grow p-2 bg-slate-700 border border-slate-600 rounded-md text-sm"}),o.jsx("button",{type:"submit",className:"px-4 bg-sky-600 hover:bg-sky-500 rounded-md font-semibold text-sm",children:"Send"})]})]})},wd=["#0ea5e9","#8b5cf6","#ec4899","#f59e0b","#10b981","#64748b"],jv=()=>{const{currentProject:r}=$e(),[e,t]=V.useState(null),[n,i]=V.useState(!0);return V.useEffect(()=>{let s=!0;return r?(i(!0),Up(r.id).then(l=>{s&&t(l)}).catch(l=>console.error("Failed to load project analytics:",l)).finally(()=>{s&&i(!1)})):i(!1),()=>{s=!1}},[r]),n?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx(dt,{})}):e?o.jsxs("div",{className:"p-4 space-y-6 overflow-y-auto h-full",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"p-3 bg-slate-900/50 rounded-lg text-center",children:[o.jsx("p",{className:"text-sm text-slate-300",children:"Vastu Score"}),o.jsxs("p",{className:"text-4xl font-bold text-purple-300",children:[e.vastuScore,o.jsx("span",{className:"text-lg text-slate-400",children:"/100"})]})]}),o.jsxs("div",{className:"p-3 bg-slate-900/50 rounded-lg text-center",children:[o.jsx("p",{className:"text-sm text-slate-300",children:"Sustainability Score"}),o.jsxs("p",{className:"text-4xl font-bold text-emerald-300",children:[e.sustainabilityScore,o.jsx("span",{className:"text-lg text-slate-400",children:"/100"})]})]})]}),e.creditUsage.length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-sky-300 mb-2",children:"AI Credit Usage by Tool"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(ac,{children:o.jsxs(y1,{data:e.creditUsage,layout:"vertical",margin:{left:100},children:[o.jsx(Rd,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),o.jsx(Fd,{type:"number",tick:{fill:"#94a3b8",fontSize:10}}),o.jsx(Md,{type:"category",dataKey:"name",tick:{fill:"#cbd5e1",fontSize:10,width:100},width:100}),o.jsx(oc,{cursor:{fill:"rgba(255,255,255,0.1)"},contentStyle:{backgroundColor:"rgba(30, 41, 59, 0.9)",borderColor:"rgba(255, 255, 255, 0.2)"}}),o.jsx(Yd,{dataKey:"cost",fill:"#8884d8",name:"Credits"})]})})})]}),e.materialDistribution.length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-sky-300 mb-2",children:"Material Distribution (by Quantity)"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(ac,{children:o.jsxs(N1,{children:[o.jsx(Hd,{data:e.materialDistribution,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:60,fill:"#8884d8",children:e.materialDistribution.map((s,l)=>o.jsx(Cs,{fill:wd[l%wd.length]},`cell-${l}`))}),o.jsx(oc,{contentStyle:{backgroundColor:"rgba(30, 41, 59, 0.9)",borderColor:"rgba(255, 255, 255, 0.2)"}}),o.jsx(Wp,{iconSize:10,wrapperStyle:{fontSize:"10px"}})]})})})]})]}):o.jsx("div",{className:"p-4 text-center text-slate-400",children:"No analytics data available. Run AI analysis tools to generate data."})},rc=({label:r,isEnabled:e,onToggle:t})=>o.jsxs("div",{className:"flex justify-between items-center bg-slate-900/50 p-2 rounded-md",children:[o.jsx("label",{className:"text-sm text-slate-200",children:r}),o.jsx("button",{onClick:t,className:`relative inline-flex items-center h-5 rounded-full w-10 transition-colors ${e?"bg-sky-500":"bg-slate-600"}`,children:o.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${e?"translate-x-5":"translate-x-0.5"}`})})]}),nc=({label:r,value:e,unit:t,color:n})=>o.jsxs("div",{className:"bg-slate-900/50 p-3 rounded-lg text-center",children:[o.jsx("p",{className:"text-xs text-slate-400",children:r}),o.jsxs("p",{className:`text-2xl font-bold ${n}`,children:[e,o.jsx("span",{className:"text-sm text-slate-300 ml-1",children:t})]})]}),Av=()=>{const{isDigitalTwinModeActive:r,toggleDigitalTwinMode:e,digitalTwinData:t,activeDataOverlays:n,setActiveDataOverlays:i}=$e();if(!r)return o.jsxs("div",{className:"p-4 h-full flex flex-col items-center justify-center text-center",children:[o.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Digital Twin mode is inactive. Activate it to see live IoT data simulations from your project."}),o.jsx("button",{onClick:e,className:"px-4 py-2 bg-sky-600 hover:bg-sky-500 rounded-md font-semibold",children:"Activate Digital Twin"})]});if(!t)return o.jsx("div",{className:"p-4 h-full flex items-center justify-center",children:o.jsx(dt,{})});const{totalPowerDraw:s,peakStressFactor:l,totalOccupancy:u}=t;return o.jsxs("div",{className:"p-4 h-full flex flex-col space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsx(nc,{label:"Power Draw",value:(s/1e3).toFixed(2),unit:"kW",color:"text-yellow-300"}),o.jsx(nc,{label:"Peak Stress",value:(l*100).toFixed(1),unit:"%",color:"text-red-300"}),o.jsx(nc,{label:"Occupancy",value:u.toString(),unit:"people",color:"text-cyan-300"})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-sky-300 mb-2",children:"3D Overlays"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(rc,{label:"Energy Usage",isEnabled:n.energy,onToggle:()=>i(d=>({...d,energy:!d.energy}))}),o.jsx(rc,{label:"Structural Stress",isEnabled:n.stress,onToggle:()=>i(d=>({...d,stress:!d.stress}))}),o.jsx(rc,{label:"Live Occupancy",isEnabled:n.occupancy,onToggle:()=>i(d=>({...d,occupancy:!d.occupancy}))})]})]}),o.jsx("div",{className:"mt-auto pt-4 border-t border-slate-700",children:o.jsx("button",{onClick:e,className:"w-full px-4 py-2 bg-slate-600 hover:bg-slate-500 rounded-md font-semibold text-sm",children:"Deactivate Digital Twin"})})]})},Sv=()=>{const{importRevitProject:r,globalLoadingMessage:e,importDwgProject:t,exportAsDxf:n,currentProject:i}=$e(v=>({importRevitProject:v.importRevitProject,globalLoadingMessage:v.globalLoadingMessage,importDwgProject:v.importDwgProject,exportAsDxf:v.exportAsDxf,currentProject:v.currentProject})),[s,l]=V.useState("RVT-2024-HS-001"),u=!!(e!=null&&e.includes("Importing")),d=V.useRef(null),m=()=>{r(s)},g=v=>{var p;const y=(p=v.target.files)==null?void 0:p[0];y&&t(y)};return o.jsxs("div",{className:"p-4 h-full flex flex-col space-y-4",children:[o.jsx("p",{className:"text-sm text-slate-300",children:"Connect AuraOS with your existing workflows by importing data from other platforms."}),o.jsxs("div",{className:"p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[o.jsx("h4",{className:"font-semibold text-amber-300",children:"Revit / BIM Import (Simulation)"}),o.jsx("p",{className:"text-xs text-slate-400 my-2",children:"Enter a mock Revit Project ID to simulate importing a BIM model. This will load a predefined project structure into the editor."}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Hp,{htmlFor:"revit-id",children:"Mock Revit Project ID"}),o.jsx(Bd,{id:"revit-id",value:s,onChange:v=>l(v.target.value),disabled:u})]}),o.jsxs(wn,{onClick:m,className:"w-full mt-4",disabled:u,children:[u&&o.jsx(dt,{size:"h-4 w-4 mr-2"}),"Import Project"]})]}),o.jsxs("div",{className:"p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[o.jsx("h4",{className:"font-semibold text-amber-300",children:"Autodesk DWG/DXF"}),o.jsx("input",{type:"file",ref:d,className:"hidden",accept:".dwg,.dxf",onChange:g}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[o.jsx(wn,{onClick:()=>{var v;return(v=d.current)==null?void 0:v.click()},variant:"outline",disabled:u,children:u?o.jsx(dt,{size:"h-4 w-4"}):"Import DWG/DXF"}),o.jsx(wn,{onClick:n,variant:"outline",disabled:!i,children:"Export as DXF"})]})]})]})},Lv=()=>o.jsx("div",{className:"p-4 h-full flex flex-col",children:o.jsx("div",{className:"flex-grow bg-slate-700/50 rounded p-2 text-center text-slate-400",children:"The Maya Layer for reality distortion will be managed here."})}),Pv=({sequence:r,activeWeek:e,setActiveWeek:t})=>{const[n,i]=V.useState(!1),s=V.useRef(null),l=r.length>0?r[r.length-1].week:0,u=V.useCallback(()=>{s.current&&clearInterval(s.current),s.current=window.setInterval(()=>{t(v=>{const y=v??-1;return y>=l?(clearInterval(s.current),i(!1),l):y+1})},800)},[l,t]),d=V.useCallback(()=>{s.current&&(clearInterval(s.current),s.current=null)},[]);V.useEffect(()=>(n?u():d(),()=>d()),[n,u,d]);const m=()=>{e!==null&&(e>=l?(t(0),i(!0)):i(!n))},g=r.find(v=>v.week===e);return o.jsx("div",{className:"absolute bottom-20 left-1/2 -translate-x-1/2 w-full max-w-3xl z-30 px-4",children:o.jsx("div",{className:"bg-slate-800/70 backdrop-blur-md rounded-xl p-4 shadow-2xl border border-slate-700/50",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("button",{onClick:m,className:"p-2 bg-slate-700 rounded-full hover:bg-sky-600 transition-colors",children:n?o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-white",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"})}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-white",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.972l-11.54 6.347a1.125 1.125 0 01-1.667-.986V5.653z"})})}),o.jsx("input",{type:"range",min:"0",max:l,value:e??0,onChange:v=>t(parseInt(v.target.value,10)),className:"flex-grow h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer"}),o.jsxs("div",{className:"text-right w-28",children:[o.jsxs("p",{className:"text-sm font-semibold text-white",children:["Week ",e??0," / ",l]}),o.jsx("p",{className:"text-xs text-slate-300 truncate",title:(g==null?void 0:g.description)||"Timeline",children:(g==null?void 0:g.description)||"Timeline"})]})]})})})},kv=({tourData:r,currentScript:e,onClose:t})=>o.jsxs("div",{className:"absolute inset-0 bg-black/50 z-[100] flex flex-col justify-between pointer-events-none",children:[o.jsx("div",{className:"h-16 md:h-24 bg-black pointer-events-auto",children:o.jsxs("div",{className:"w-full h-full flex items-center justify-between px-6",children:[o.jsx("h2",{className:"text-lg md:text-xl font-bold text-slate-200",children:r.title}),o.jsx("button",{onClick:t,className:"text-slate-300 hover:text-white transition-colors","aria-label":"Close cinematic tour",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})}),o.jsx("div",{className:"flex-grow"}),o.jsx("div",{className:"h-24 md:h-32 bg-black pointer-events-auto flex items-center justify-center p-4",children:o.jsx("p",{className:"text-base md:text-lg text-slate-100 text-center font-serif italic text-shadow-custom max-w-4xl",children:e})})]}),_v=()=>{const{isCompanionActive:r,companionState:e,setCompanionState:t,companionTranscript:n,setCompanionTranscript:i,currentProject:s}=$e(v=>({isCompanionActive:v.isCompanionActive,companionState:v.companionState,setCompanionState:v.setCompanionState,companionTranscript:v.companionTranscript,setCompanionTranscript:v.setCompanionTranscript,currentProject:v.currentProject})),l=V.useRef(null),{addNotification:u}=pr();V.useEffect(()=>{const v=window.SpeechRecognition||window.webkitSpeechRecognition;if(!v){console.warn("Speech recognition not supported in this browser.");return}l.current=new v,l.current.continuous=!1,l.current.lang="en-US",l.current.interimResults=!0,l.current.onresult=y=>{let p="";for(let N=y.resultIndex;N<y.results.length;++N)if(y.results[N].isFinal){const b=y.results[N][0].transcript;i(b),d(b)}else p+=y.results[N][0].transcript,i(p+"...")},l.current.onerror=y=>{console.error("Speech recognition error",y.error),y.error!=="no-speech"&&u(`Speech recognition error: ${y.error}`,"error"),t("idle"),i(null)},l.current.onend=()=>{$e.getState().companionState==="listening"&&t("idle")}},[u,t,i]);const d=async v=>{if(!v.trim()||!s){t("idle");return}t("thinking");try{Fh(s.id,`@aura ${v}`),setTimeout(()=>{$e.getState().companionState==="thinking"&&(t("idle"),i(null),u("Aura didn't respond. Please try again.","info"))},15e3)}catch(y){u(y.message,"error"),t("error"),i(null)}},m=()=>{if(!l.current){u("Voice recognition is not supported by your browser.","error");return}e==="listening"?(l.current.stop(),t("idle"),i(null)):(i("Listening..."),t("listening"),l.current.start())},g={idle:"bg-primary/20 border-primary/50 text-primary",listening:"bg-red-500/20 border-red-500 text-red-400 animate-pulse",thinking:"bg-purple-500/20 border-purple-500 text-purple-400 thinking-orb",speaking:"bg-green-500/20 border-green-500 text-green-400 animate-pulse",error:"bg-destructive/20 border-destructive/50 text-destructive"};return r?o.jsxs("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 z-50 flex flex-col items-center gap-2 pointer-events-auto",children:[n&&o.jsx("div",{className:"px-4 py-2 bg-black/50 rounded-lg text-white text-center text-sm",children:n}),o.jsx("button",{onClick:m,className:`w-16 h-16 rounded-full border-2 transition-all duration-300 flex items-center justify-center shadow-lg ${g[e]}`,children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})})]}):null},_r=({onClick:r,children:e,isPremium:t=!1})=>o.jsx("button",{onClick:r,className:`w-full text-left px-4 py-2 text-sm transition-colors flex items-center gap-2 ${t?"text-amber-200 hover:bg-amber-500/20":"text-slate-200 hover:bg-sky-600"}`,children:e}),ic=()=>o.jsx("div",{className:"h-px bg-slate-700 my-1"}),Cv=({x:r,y:e,object:t})=>{const{setContextMenu:n,setActiveTool:i,runAiFurnishRoom:s,atmanSignature:l,deleteSelectedObject:u}=$e(),d=(y,p)=>{y.stopPropagation(),i(p),n(null)},m=(y,p,N)=>{y.stopPropagation(),n(null);let b="modern minimalist";N||(b=prompt("Enter an interior design style (e.g., modern minimalist, industrial, scandinavian):","modern minimalist")||b),s(p,b,N&&l||void 0)},g=y=>{y.stopPropagation(),window.confirm("Are you sure you want to delete this object? This action can be undone.")&&u(),n(null)},v=()=>{if(!t)return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-4 pt-2 pb-1 text-xs font-semibold text-slate-400",children:"AI Actions"}),o.jsx(_r,{onClick:y=>d(y,"aiArchitect"),children:"🌟 New Concept..."}),o.jsx(_r,{onClick:y=>d(y,"modelLibrary"),children:"📦 Place 3D Model"})]});switch(t.type){case"wall":return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-4 pt-2 pb-1 text-xs font-semibold text-slate-400",children:"Wall Actions"}),o.jsx(_r,{onClick:y=>d(y,"structural"),children:"🏛️ Analyze Structure"}),o.jsx(_r,{onClick:y=>d(y,"material"),children:"🧱 Suggest Material"}),o.jsx(ic,{}),o.jsx(_r,{onClick:g,children:"🗑️ Delete"})]});case"room":return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-4 pt-2 pb-1 text-xs font-semibold text-slate-400",children:"AI Room Actions"}),o.jsx(_r,{onClick:y=>m(y,t.id,!1),children:"🛋️ Furnish Room..."}),l&&o.jsx(_r,{onClick:y=>m(y,t.id,!0),isPremium:!0,children:"🧬 Furnish Room (Atman Signature)"}),o.jsx(_r,{onClick:y=>d(y,"vastu"),children:"🕉️ Analyze Vastu"}),o.jsx(_r,{onClick:y=>d(y,"flow"),children:"🚶 Check Flow & Ergonomics"}),o.jsx(_r,{onClick:y=>d(y,"render"),children:"🖼️ Render Room"}),o.jsx(ic,{}),o.jsx(_r,{onClick:y=>d(y,"delete"),children:"🗑️ Delete Room"})]});case"placedModel":return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-4 pt-2 pb-1 text-xs font-semibold text-slate-400",children:"Model Actions"}),o.jsx(_r,{onClick:y=>d(y,"staging"),children:"Staging Engine"}),o.jsx(ic,{}),o.jsx(_r,{onClick:g,children:"🗑️ Delete Model"})]});default:return o.jsx("div",{className:"px-4 py-2 text-sm text-slate-400",children:"No actions available"})}};return o.jsx("div",{className:"fixed z-[150] bg-slate-800/90 backdrop-blur-md rounded-lg shadow-2xl border border-slate-700 overflow-hidden w-64",style:{top:e,left:r},children:o.jsx("div",{className:"py-1",children:v()})})},Iv=qn.lazy(()=>Ns(()=>import("./InteractiveTutorial-2d8f7d8f.js"),["assets/InteractiveTutorial-2d8f7d8f.js","assets/index-e439054e.js","assets/index-6a1ae680.css","assets/Button-fcf173b3.js"])),Ev=qn.lazy(()=>Ns(()=>import("./HolocronEditorModal-f407db52.js"),["assets/HolocronEditorModal-f407db52.js","assets/index-e439054e.js","assets/index-6a1ae680.css","assets/Button-fcf173b3.js"])),Ov=()=>{var se,me;const r=$e(),e=V.useRef(null),t=V.useRef(null),{panelStates:n,setPanelStates:i,togglePanelVisibility:s,currentProject:l,isExportModalOpen:u,setExportModalOpen:d,hasUnsavedChanges:m,focusPanel:g,addLayer:v,updateLayer:y,deleteLayer:p,onboardingStep:N,isHotspotEditorOpen:b,setHotspotEditorOpen:I,saveProjectVersion:w,activeSketcherTool:S,setActiveSketcherTool:T,editorMode:W,setEditorMode:G}=r,[te,H]=V.useState(!1),[M,Q]=V.useState(!1),ce=async ee=>{await w(ee)};V.useEffect(()=>{let ee;return m&&l&&(ee=window.setInterval(()=>r.autoSaveProject(),12e4)),()=>clearInterval(ee)},[m,l,r]),V.useEffect(()=>{const ee=Le=>{$e.getState().hasUnsavedChanges&&(Le.preventDefault(),Le.returnValue="You have unsaved changes that will be lost.")};return window.addEventListener("beforeunload",ee),()=>{window.removeEventListener("beforeunload",ee)}},[]);const E=r.levels[r.activeLevelIndex],_=ee=>Le=>{i(k=>{const R=k[ee],z=typeof Le=="function"?Le(R):Le;return{...k,[ee]:z}})},B=ee=>{g(ee)},q=()=>{const ee=prompt("Enter new layer name:",`Layer ${E.layers.length+1}`);ee&&v(ee)},ae=(ee,Le)=>{y(ee,Le)},K=ee=>{window.confirm("Are you sure you want to delete this layer? All objects on it will also be deleted.")&&p(ee)},fe=ee=>{I(!0,{position:ee})};return o.jsxs("div",{className:"relative h-screen w-screen overflow-hidden bg-slate-900",children:[o.jsx(Gp,{}),o.jsx("main",{className:"h-full w-full px-4 pt-20 pb-20",children:o.jsxs("div",{className:"flex h-full gap-4",children:[o.jsx("div",{className:"h-full w-2/3",id:"tutorial-target-canvas",children:o.jsx(Nu,{title:"2D Floor Plan",children:o.jsx(Nf,{ref:e,...r,currentTool:S,setActiveSketcherTool:T,editorMode:W,setEditorMode:G,onViewCommentThread:r.onViewCommentThread,addWall:r.addWall,updateWall:r.updateWall,addPlacement:r.addPlacement,addDimensionLine:r.addDimensionLine,addComment:r.addComment})})}),o.jsx("div",{className:"h-full w-1/3",id:"tutorial-target-3d",children:o.jsx(Nu,{title:"3D Visualization",children:o.jsx(jf,{ref:t,...r,onAddHotspot:fe,hotspots:(me=(se=r.currentProject)==null?void 0:se.holocron)==null?void 0:me.hotspots,constructionSequence:r.constructionSequence,activeTimelineWeek:r.activeTimelineWeek,isHolocronAuthoringMode:r.isHolocronAuthoringMode})})})]})}),o.jsx(L1,{activeTool:S,onToolChange:T,editorMode:W,onModeChange:G}),Object.values(n).map(ee=>ee.isVisible&&o.jsxs(V.Suspense,{fallback:o.jsx("div",{}),children:[ee.id==="phoenixEngine"&&o.jsx(Fn,{title:"Phoenix AI Engine",panelState:ee,setPanelState:_(ee.id),onFocus:()=>B(ee.id),children:o.jsx(tg,{...r})}),ee.id==="propertiesPanel"&&o.jsx(Fn,{title:"Properties",panelState:ee,setPanelState:_(ee.id),onFocus:()=>B(ee.id),children:o.jsx(sg,{...r})}),ee.id==="projectHub"&&o.jsx(Fn,{title:"Project Hub",panelState:ee,setPanelState:_(ee.id),onFocus:()=>B(ee.id),children:o.jsx(cg,{})}),ee.id==="layersPanel"&&E&&o.jsx(Fn,{title:"Layers",panelState:ee,setPanelState:_(ee.id),onFocus:()=>B(ee.id),children:o.jsx(ag,{layers:E.layers,activeLayerId:E.activeLayerId,setActiveLayerId:Le=>r.setSingleLevelProp("activeLayerId",Le),onAddLayer:q,onUpdateLayer:ae,onDeleteLayer:K})}),ee.id==="chatPanel"&&o.jsx(Fn,{title:"AI Chat & Collaboration",panelState:ee,setPanelState:_(ee.id),onFocus:()=>B(ee.id),children:o.jsx(Nv,{})}),ee.id==="analyticsPanel"&&o.jsx(Fn,{title:"Project Analytics",panelState:ee,setPanelState:_(ee.id),onFocus:()=>B(ee.id),children:o.jsx(jv,{})}),ee.id==="digitalTwinPanel"&&o.jsx(Fn,{title:"Digital Twin",panelState:ee,setPanelState:_(ee.id),onFocus:()=>B(ee.id),children:o.jsx(Av,{})}),ee.id==="integrationsPanel"&&o.jsx(Fn,{title:"Integrations",panelState:ee,setPanelState:_(ee.id),onFocus:()=>B(ee.id),children:o.jsx(Sv,{})}),ee.id==="mayaLayer"&&o.jsx(Fn,{title:"Maya Layer",panelState:ee,setPanelState:_(ee.id),onFocus:()=>B(ee.id),children:o.jsx(Lv,{})})]},ee.id)),o.jsx($p,{onPhoenixClick:()=>s("phoenixEngine"),onLayersClick:()=>s("layersPanel"),onSaveClick:()=>H(!0),onProjectHubClick:()=>s("projectHub"),onPropertiesClick:()=>s("propertiesPanel"),onShareClick:()=>Q(!0),cinematicTourReady:!!r.cinematicTourData,onPlayTour:()=>r.setIsCinematicTourPlaying(!0),canUndo:r.canUndo,canRedo:r.canRedo,onUndo:r.undo,onRedo:r.redo,onChatClick:()=>s("chatPanel")}),r.constructionSequence&&r.activeTimelineWeek!==null&&o.jsx(Pv,{sequence:r.constructionSequence,activeWeek:r.activeTimelineWeek,setActiveWeek:r.setActiveTimelineWeek}),r.isCinematicTourPlaying&&r.cinematicTourData&&o.jsx(V.Suspense,{fallback:null,children:o.jsx(kv,{tourData:r.cinematicTourData,currentScript:"...",onClose:()=>r.setIsCinematicTourPlaying(!1)})}),o.jsx(_v,{}),N>-1&&o.jsx(V.Suspense,{fallback:null,children:o.jsx(Iv,{})}),te&&o.jsx(Kp,{onClose:()=>H(!1),onSave:ce}),u&&l&&o.jsx(Jp,{onClose:()=>d(!1),sketcherRef:e,view3dRef:t,projectName:(l==null?void 0:l.name)||"Untitled"}),M&&l&&o.jsx(V.Suspense,{fallback:o.jsx(wu,{message:"Loading..."}),children:o.jsx(Yp,{isOpen:M,onClose:()=>Q(!1),projectId:l.id,initialCollaborators:r.collaborators,onCollaboratorsUpdate:r.setCollaborators})}),r.contextMenu&&o.jsx(Cv,{x:r.contextMenu.x,y:r.contextMenu.y,object:r.contextMenu.object}),b&&o.jsx(V.Suspense,{fallback:o.jsx(wu,{message:"Loading Editor..."}),children:o.jsx(Ev,{})})]})},Jv=Object.freeze(Object.defineProperty({__proto__:null,default:Ov},Symbol.toStringTag,{value:"Module"}));export{Jv as A,vt as _};
