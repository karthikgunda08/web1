import{u as w,r as N,j as e,L as $}from"./index-e439054e.js";const P=n=>String(n).replace(/[<>&'"]/g,c=>{switch(c){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;";default:return c}}),D=(n,c="root",d="")=>{let i="";const s=(t,o,r)=>{let l="";if(o==null)l+=`${r}<${t} />
`;else if(typeof o=="object")if(Array.isArray(o)){const a=t.endsWith("s")?t.slice(0,-1):"item";o.length===0?l+=`${r}<${t} />
`:(l+=`${r}<${t}>
`,o.forEach(h=>{l+=s(a,h,r+"  ")}),l+=`${r}</${t}>
`)}else{l+=`${r}<${t}>
`;for(const a in o)Object.prototype.hasOwnProperty.call(o,a)&&a!=="_id"&&a!=="__v"&&(l+=s(a,o[a],r+"  "));l+=`${r}</${t}>
`}else l+=`${r}<${t}>${P(String(o))}</${t}>
`;return l};return i+=`<?xml version="1.0" encoding="UTF-8"?>
`,i+=s(c,n,d),i},C=(n,c)=>{if(!n){alert("No data to export.");return}const d=D(n,"project"),i=new Blob([d],{type:"application/xml;charset=utf-8;"}),s=document.createElement("a");if(s.download!==void 0){const t=URL.createObjectURL(i);s.setAttribute("href",t),s.setAttribute("download",c),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)}},v=({onClose:n,sketcherRef:c,view3dRef:d,projectName:i})=>{const{exportCometPackage:s,currentProject:t,exportAsDxf:o}=w(),[r,l]=N.useState(!1),a=g=>{var f,u,j;const b=(x,m)=>{if(!x)return;const p=document.createElement("a");p.href=x,p.download=m,document.body.appendChild(p),p.click(),document.body.removeChild(p)};switch(g){case"2d_png":const x=(f=c.current)==null?void 0:f.exportAsPNG();x&&b(x,`${i}_2D_Plan.png`);break;case"3d_png":const m=(u=d.current)==null?void 0:u.exportAsPNG();m&&b(m,`${i}_3D_View.png`);break;case"3d_glb":(j=d.current)==null||j.exportAsGLB(i);break;case"xml":t&&C(t,`${i}_Data.xml`);break}n()},h=async()=>{l(!0),await s(c,d),l(!1),n()};return e.jsx("div",{className:"fixed inset-0 bg-slate-900/75 backdrop-blur-sm z-[200] flex items-center justify-center",onClick:n,children:e.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl shadow-2xl w-full max-w-md m-4 border border-slate-700",onClick:g=>g.stopPropagation(),children:[e.jsx("h2",{className:"text-lg font-bold text-sky-300 mb-4",children:"Export Project"}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Choose a format to export your project."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>a("2d_png"),className:"w-full p-4 bg-slate-700 hover:bg-slate-600 rounded-lg text-left transition-colors",children:[e.jsx("h3",{className:"font-semibold text-white",children:"2D Floor Plan (PNG)"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Export the current 2D canvas view as a PNG image."})]}),e.jsxs("button",{onClick:()=>a("3d_png"),className:"w-full p-4 bg-slate-700 hover:bg-slate-600 rounded-lg text-left transition-colors",children:[e.jsx("h3",{className:"font-semibold text-white",children:"3D View (PNG)"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Export the current 3D view as a high-resolution PNG image."})]}),e.jsxs("button",{onClick:()=>a("3d_glb"),className:"w-full p-4 bg-slate-700 hover:bg-slate-600 rounded-lg text-left transition-colors",children:[e.jsx("h3",{className:"font-semibold text-white",children:"3D Model (GLB)"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Export the entire 3D model for use in other 3D software."})]}),e.jsxs("button",{onClick:o,className:"w-full p-4 bg-slate-700 hover:bg-slate-600 rounded-lg text-left transition-colors",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Technical Drawing (DXF)"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Export the 2D plan to a DXF file for use in CAD software."})]}),e.jsxs("button",{onClick:()=>a("xml"),className:"w-full p-4 bg-slate-700 hover:bg-slate-600 rounded-lg text-left transition-colors",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Project Data (XML)"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Export all project data as an XML file for interoperability."})]}),e.jsxs("button",{onClick:h,disabled:r,className:"w-full p-4 bg-gradient-to-r from-purple-600 to-indigo-700 hover:from-purple-500 hover:to-indigo-600 rounded-lg text-left transition-colors border border-purple-500 disabled:opacity-50",children:[e.jsx("h3",{className:"font-semibold text-white flex items-center gap-2",children:"âœ¨ Comet Package (.pdf)"}),e.jsx("p",{className:"text-xs text-slate-300",children:"Bundle all project assets (drawings, renders, folio, BoQ) into a single document."}),r&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-purple-200",children:[e.jsx($,{size:"h-4 w-4"})," Packaging assets..."]})]})]}),e.jsx("div",{className:"mt-6 text-right",children:e.jsx("button",{onClick:n,className:"px-4 py-2 text-sm rounded-md bg-slate-600 hover:bg-slate-500 text-white",children:"Cancel"})})]})})};export{v as ExportModal,v as default};
